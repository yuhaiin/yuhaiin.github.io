import{j as l,r as h}from"./react-CMZbnqsw.js";import{u as E}from"./uplot-CR0P61mD.js";import{f as j}from"./index-DaPzCQBy.js";import"./tanstack-BCDAlJIz.js";import"./radix-ui-BDRn2sIN.js";import"./framer-motion-BPf2PwGE.js";import"./lucide-BV-5Qoh7.js";import"./protobuf-BZJZG19G.js";const W=({label:t,upload:b,download:c,left:g,top:p,visible:w})=>l.jsxs("div",{style:{position:"absolute",left:g,top:p,display:w?"block":"none",pointerEvents:"none",background:"rgba(0,0,0,1)",padding:8,borderRadius:4,color:"#fff",fontSize:12,minWidth:120,zIndex:10},children:[l.jsx("div",{style:{fontWeight:600,marginBottom:4,color:"#f1f5f9"},children:t}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:2},children:[l.jsx("div",{style:{width:8,height:8,background:"#10b981",borderRadius:"50%"}}),l.jsx("span",{style:{color:"#cbd5e1"},children:"Upload:"}),l.jsx("span",{style:{fontWeight:500},children:j(b??0,2," ")+"/S"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("div",{style:{width:8,height:8,background:"#3b82f6",borderRadius:"50%"}}),l.jsx("span",{style:{color:"#cbd5e1"},children:"Download:"}),l.jsx("span",{style:{fontWeight:500},children:j(c??0,2," ")+"/S"})]})]});function P(t){if(t<=0)return 1;const b=Math.floor(Math.log10(t)),c=Math.pow(10,b);return Math.ceil(t/c)*c}function D(t,b,c,g){const p=t.series[b],w=t.data[0],T=t.data[b],k="x",y=p.scale,i=new Path2D;let s=[];for(let e=c;e<=g;e++){const o=T[e];o!=null&&s.push([t.valToPos(w[e],k,!0),t.valToPos(o,y,!0)])}if(s.length<2)return null;const f=s.length,n=new Array(f).fill(0),a=new Array(f-1).fill(0);for(let e=0;e<f-1;e++){const o=s[e+1][0]-s[e][0],d=s[e+1][1]-s[e][1];a[e]=d/o}for(let e=0;e<f;e++)e===0?n[e]=a[0]:e===f-1?n[e]=a[f-2]:(n[e]=(a[e-1]+a[e])/2,a[e-1]*a[e]<=0&&(n[e]=0));for(let e=0;e<f-1;e++){const o=a[e];if(o===0){n[e]=0,n[e+1]=0;continue}const d=n[e]/o;Math.abs(d)>3&&(n[e]=3*o);const x=n[e+1]/o;Math.abs(x)>3&&(n[e+1]=3*o)}i.moveTo(s[0][0],s[0][1]);for(let e=0;e<f-1;e++){const o=s[e],d=s[e+1],x=d[0]-o[0];let z=o[0]+x/3,v=o[1]+n[e]*(x/3),R=d[0]-x/3,M=d[1]-n[e+1]*(x/3);const m=Math.min(o[1],d[1]),S=Math.max(o[1],d[1]);v=Math.max(m,Math.min(S,v)),M=Math.max(m,Math.min(S,M)),i.bezierCurveTo(z,v,R,M,d[0],d[1])}const u=new Path2D,r=t.valToPos(0,y,!0);return u.addPath(i),u.lineTo(s[s.length-1][0],r),u.lineTo(s[0][0],r),u.closePath(),{stroke:i,fill:u}}const Y=({data:t,minHeight:b})=>{const c=h.useRef(null),g=h.useRef(null),p=h.useRef(null),w=h.useRef(null),[T,k]=h.useState({visible:!1,left:0,top:0,label:"",upload:0,download:0}),y=h.useRef(t.labels);return h.useEffect(()=>{y.current=t.labels},[t.labels]),h.useLayoutEffect(()=>{if(!c.current||!g.current)return;let i=c.current.clientWidth,s=c.current.clientHeight;i===0&&(i=600),s===0&&(s=300);const f={width:i,height:s,mode:1,padding:[10,7,10,7],series:[{value:(r,e)=>t.labels[e]||""},{label:"Upload",stroke:"#10b981",fill:"rgba(16, 185, 129, 0.1)",width:2,points:{show:!1},value:(r,e)=>j(e??0,2," ")+"/S",paths:D},{label:"Download",stroke:"#3b82f6",fill:"rgba(59, 130, 246, 0.1)",width:2,points:{show:!1},value:(r,e)=>j(e??0,2," ")+"/S",paths:D}],axes:[{show:!1},{show:!0,stroke:"#475569",font:"10px sans-serif",grid:{show:!0,stroke:"rgba(255, 255, 255, 0.05)",width:1},ticks:{show:!0,stroke:"rgba(255, 255, 255, 0.05)"},values:(r,e)=>e.map(o=>j(Number(o),0," ")+"/S"),size:65,gap:0}],legend:{show:!1},cursor:{drag:{setScale:!1},points:{size:9,width:2,stroke:(r,e)=>r.series[e].stroke,fill:()=>"#1e293b"}},scales:{x:{time:!1},y:{auto:!1,range:[0,P(t.rawMax)]}},hooks:{setCursor:[r=>{const{idx:e,left:o=0,top:d=0}=r.cursor;if(e==null){k(S=>({...S,visible:!1}));return}const x=y.current[e]||"",z=r.data[1][e]??0,v=r.data[2][e]??0,R=r.bbox.left,M=r.bbox.top;let m=R+o+20;m>r.width-150&&(m=R+o-160),k({visible:!0,left:m,top:M+d,label:x,upload:z,download:v})}]}},a=[t.labels.map((r,e)=>e),t.upload,t.download],u=new E(f,a,g.current);return p.current=u,()=>{u.destroy(),p.current=null}},[]),h.useEffect(()=>{if(!p.current)return;const i=p.current,s=P(t.rawMax),n=[t.labels.map((a,u)=>u),t.upload,t.download];i.batch(()=>{i.setScale("y",{min:0,max:s}),i.setData(n)})},[t]),h.useEffect(()=>{if(!c.current||!p.current)return;const i=new ResizeObserver(s=>{if(p.current)for(let f of s){const{width:n,height:a}=f.contentRect;n>0&&a>0&&p.current.setSize({width:n,height:a})}});return i.observe(c.current),()=>i.disconnect()},[]),l.jsxs(l.Fragment,{children:[l.jsx(W,{...T}),l.jsxs("div",{ref:c,style:{position:"relative",width:"100%",height:"100%",minHeight:b,flex:"1 1 auto",display:"flex",flexDirection:"column",minWidth:0},children:[l.jsx("div",{ref:g,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden"}}),l.jsx("div",{ref:w,style:{position:"absolute",display:"none",top:0,left:0,zIndex:100,pointerEvents:"none",backgroundColor:"rgba(15, 23, 42, 0.9)",border:"0px solid rgba(255,255,255,0.1)",padding:"0px",borderRadius:"6px",boxShadow:"0 2px 4px -1px rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.06)",color:"white",fontSize:"6px",whiteSpace:"nowrap",transition:"opacity 0.1s ease"}})]})]})};export{Y as default};
