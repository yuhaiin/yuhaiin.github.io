import{j as r,r as h}from"./react-B6JJBjhf.js";import{u as D}from"./uplot-CR0P61mD.js";import{f as j}from"./index-BQHchvMm.js";import"./tanstack-CuRl75UC.js";import"./radix-ui-2JcFLlC3.js";import"./framer-motion-BehrPTVT.js";import"./lucide-CVrrkYdv.js";import"./protobuf-BZJZG19G.js";const E=({label:t,upload:p,download:i,left:x,top:u,visible:v})=>r.jsxs("div",{className:`absolute pointer-events-none bg-black p-2 rounded text-white text-xs min-w-[120px] z-10 ${v?"block":"hidden"}`,style:{left:x,top:u},children:[r.jsx("div",{className:"font-semibold mb-1 text-slate-100",children:t}),r.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[r.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full"}),r.jsx("span",{className:"text-slate-300",children:"Upload:"}),r.jsx("span",{className:"font-medium",children:j(p??0,2," ")+"/S"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),r.jsx("span",{className:"text-slate-300",children:"Download:"}),r.jsx("span",{className:"font-medium",children:j(i??0,2," ")+"/S"})]})]});function S(t){if(t<=0)return 1;const p=Math.floor(Math.log10(t)),i=Math.pow(10,p);return Math.ceil(t/i)*i}function z(t,p,i,x){const u=t.series[p],v=t.data[0],T=t.data[p],N="x",w=u.scale,b=new Path2D;let s=[];for(let e=i;e<=x;e++){const o=T[e];o!=null&&s.push([t.valToPos(v[e],N,!0),t.valToPos(o,w,!0)])}if(s.length<2)return null;const l=s.length,n=new Array(l).fill(0),c=new Array(l-1).fill(0);for(let e=0;e<l-1;e++){const o=s[e+1][0]-s[e][0],f=s[e+1][1]-s[e][1];c[e]=f/o}for(let e=0;e<l;e++)e===0?n[e]=c[0]:e===l-1?n[e]=c[l-2]:(n[e]=(c[e-1]+c[e])/2,c[e-1]*c[e]<=0&&(n[e]=0));for(let e=0;e<l-1;e++){const o=c[e];if(o===0){n[e]=0,n[e+1]=0;continue}const f=n[e]/o;Math.abs(f)>3&&(n[e]=3*o);const m=n[e+1]/o;Math.abs(m)>3&&(n[e+1]=3*o)}b.moveTo(s[0][0],s[0][1]);for(let e=0;e<l-1;e++){const o=s[e],f=s[e+1],m=f[0]-o[0];let P=o[0]+m/3,y=o[1]+n[e]*(m/3),k=f[0]-m/3,M=f[1]-n[e+1]*(m/3);const g=Math.min(o[1],f[1]),R=Math.max(o[1],f[1]);y=Math.max(g,Math.min(R,y)),M=Math.max(g,Math.min(R,M)),b.bezierCurveTo(P,y,k,M,f[0],f[1])}const d=new Path2D,a=t.valToPos(0,w,!0);return d.addPath(b),d.lineTo(s[s.length-1][0],a),d.lineTo(s[0][0],a),d.closePath(),{stroke:b,fill:d}}const F=({data:t,minHeight:p})=>{const i=h.useRef(null),x=h.useRef(null),u=h.useRef(null),v=h.useRef(null),[T,N]=h.useState({visible:!1,left:0,top:0,label:"",upload:0,download:0}),w=h.useMemo(()=>Array.from({length:t.labels.length},(s,l)=>l),[t.labels.length]),b=h.useRef(t.labels);return h.useEffect(()=>{b.current=t.labels},[t.labels]),h.useLayoutEffect(()=>{if(!i.current||!x.current)return;let s=i.current.clientWidth,l=i.current.clientHeight;s===0&&(s=600),l===0&&(l=300);const n={width:s,height:l,mode:1,padding:[10,7,10,7],series:[{value:(a,e)=>t.labels[e]||""},{label:"Upload",stroke:"#10b981",fill:"rgba(16, 185, 129, 0.1)",width:2,points:{show:!1},value:(a,e)=>j(e??0,2," ")+"/S",paths:z},{label:"Download",stroke:"#3b82f6",fill:"rgba(59, 130, 246, 0.1)",width:2,points:{show:!1},value:(a,e)=>j(e??0,2," ")+"/S",paths:z}],axes:[{show:!1},{show:!0,stroke:"#475569",font:"10px sans-serif",grid:{show:!0,stroke:"rgba(255, 255, 255, 0.05)",width:1},ticks:{show:!0,stroke:"rgba(255, 255, 255, 0.05)"},values:(a,e)=>e.map(o=>j(Number(o),0," ")+"/S"),size:65,gap:0}],legend:{show:!1},cursor:{drag:{setScale:!1},points:{size:9,width:2,stroke:(a,e)=>a.series[e].stroke,fill:()=>"#1e293b"}},scales:{x:{time:!1},y:{auto:!1,range:[0,S(t.rawMax)]}},hooks:{setCursor:[a=>{const{idx:e,left:o=0,top:f=0}=a.cursor;if(e==null){N(R=>({...R,visible:!1}));return}const m=b.current[e]||"",P=a.data[1][e]??0,y=a.data[2][e]??0,k=a.bbox.left,M=a.bbox.top;let g=k+o+20;g>a.width-150&&(g=k+o-160),N({visible:!0,left:g,top:M+f,label:m,upload:P,download:y})}]}},c=[w,t.upload,t.download],d=new D(n,c,x.current);return u.current=d,()=>{d.destroy(),u.current=null}},[]),h.useEffect(()=>{if(!u.current)return;const s=u.current,l=S(t.rawMax),n=[w,t.upload,t.download];s.batch(()=>{s.setScale("y",{min:0,max:l}),s.setData(n)})},[t,w]),h.useEffect(()=>{if(!i.current||!u.current)return;const s=new ResizeObserver(l=>{if(u.current)for(let n of l){const{width:c,height:d}=n.contentRect;c>0&&d>0&&u.current.setSize({width:c,height:d})}});return s.observe(i.current),()=>s.disconnect()},[]),r.jsxs(r.Fragment,{children:[r.jsx(E,{...T}),r.jsxs("div",{ref:i,className:"relative w-full h-full flex-auto flex flex-col min-w-0",style:{minHeight:p},children:[r.jsx("div",{ref:x,className:"absolute top-0 left-0 w-full h-full overflow-hidden"}),r.jsx("div",{ref:v,className:"absolute hidden top-0 left-0 z-[100] pointer-events-none bg-slate-900/90 border-0 p-0 rounded-md shadow-md text-white text-[6px] whitespace-nowrap transition-opacity duration-100"})]})]})};export{F as default};
