import{j as l,r as u}from"./react-CMZbnqsw.js";import{u as E}from"./uplot-CR0P61mD.js";import{f as j}from"./index-rydrX8tg.js";import"./tanstack-BCDAlJIz.js";import"./radix-ui-BDRn2sIN.js";import"./framer-motion-BPf2PwGE.js";import"./lucide-BV-5Qoh7.js";import"./protobuf-BZJZG19G.js";const W=({label:t,upload:p,download:a,left:x,top:d,visible:y})=>l.jsxs("div",{style:{position:"absolute",left:x,top:d,display:y?"block":"none",pointerEvents:"none",background:"rgba(0,0,0,1)",padding:8,borderRadius:4,color:"#fff",fontSize:12,minWidth:120,zIndex:10},children:[l.jsx("div",{style:{fontWeight:600,marginBottom:4,color:"#f1f5f9"},children:t}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:2},children:[l.jsx("div",{style:{width:8,height:8,background:"#10b981",borderRadius:"50%"}}),l.jsx("span",{style:{color:"#cbd5e1"},children:"Upload:"}),l.jsx("span",{style:{fontWeight:500},children:j(p??0,2," ")+"/S"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("div",{style:{width:8,height:8,background:"#3b82f6",borderRadius:"50%"}}),l.jsx("span",{style:{color:"#cbd5e1"},children:"Download:"}),l.jsx("span",{style:{fontWeight:500},children:j(a??0,2," ")+"/S"})]})]});function P(t){if(t<=0)return 1;const p=Math.floor(Math.log10(t)),a=Math.pow(10,p);return Math.ceil(t/a)*a}function D(t,p,a,x){const d=t.series[p],y=t.data[0],T=t.data[p],k="x",m=d.scale,g=new Path2D;let o=[];for(let e=a;e<=x;e++){const s=T[e];s!=null&&o.push([t.valToPos(y[e],k,!0),t.valToPos(s,m,!0)])}if(o.length<2)return null;const n=o.length,r=new Array(n).fill(0),c=new Array(n-1).fill(0);for(let e=0;e<n-1;e++){const s=o[e+1][0]-o[e][0],f=o[e+1][1]-o[e][1];c[e]=f/s}for(let e=0;e<n;e++)e===0?r[e]=c[0]:e===n-1?r[e]=c[n-2]:(r[e]=(c[e-1]+c[e])/2,c[e-1]*c[e]<=0&&(r[e]=0));for(let e=0;e<n-1;e++){const s=c[e];if(s===0){r[e]=0,r[e+1]=0;continue}const f=r[e]/s;Math.abs(f)>3&&(r[e]=3*s);const b=r[e+1]/s;Math.abs(b)>3&&(r[e+1]=3*s)}g.moveTo(o[0][0],o[0][1]);for(let e=0;e<n-1;e++){const s=o[e],f=o[e+1],b=f[0]-s[0];let z=s[0]+b/3,v=s[1]+r[e]*(b/3),R=f[0]-b/3,M=f[1]-r[e+1]*(b/3);const w=Math.min(s[1],f[1]),S=Math.max(s[1],f[1]);v=Math.max(w,Math.min(S,v)),M=Math.max(w,Math.min(S,M)),g.bezierCurveTo(z,v,R,M,f[0],f[1])}const h=new Path2D,i=t.valToPos(0,m,!0);return h.addPath(g),h.lineTo(o[o.length-1][0],i),h.lineTo(o[0][0],i),h.closePath(),{stroke:g,fill:h}}const Y=({data:t,minHeight:p})=>{const a=u.useRef(null),x=u.useRef(null),d=u.useRef(null),y=u.useRef(null),[T,k]=u.useState({visible:!1,left:0,top:0,label:"",upload:0,download:0}),m=u.useMemo(()=>Array.from({length:t.labels.length},(o,n)=>n),[t.labels.length]),g=u.useRef(t.labels);return u.useEffect(()=>{g.current=t.labels},[t.labels]),u.useLayoutEffect(()=>{if(!a.current||!x.current)return;let o=a.current.clientWidth,n=a.current.clientHeight;o===0&&(o=600),n===0&&(n=300);const r={width:o,height:n,mode:1,padding:[10,7,10,7],series:[{value:(i,e)=>t.labels[e]||""},{label:"Upload",stroke:"#10b981",fill:"rgba(16, 185, 129, 0.1)",width:2,points:{show:!1},value:(i,e)=>j(e??0,2," ")+"/S",paths:D},{label:"Download",stroke:"#3b82f6",fill:"rgba(59, 130, 246, 0.1)",width:2,points:{show:!1},value:(i,e)=>j(e??0,2," ")+"/S",paths:D}],axes:[{show:!1},{show:!0,stroke:"#475569",font:"10px sans-serif",grid:{show:!0,stroke:"rgba(255, 255, 255, 0.05)",width:1},ticks:{show:!0,stroke:"rgba(255, 255, 255, 0.05)"},values:(i,e)=>e.map(s=>j(Number(s),0," ")+"/S"),size:65,gap:0}],legend:{show:!1},cursor:{drag:{setScale:!1},points:{size:9,width:2,stroke:(i,e)=>i.series[e].stroke,fill:()=>"#1e293b"}},scales:{x:{time:!1},y:{auto:!1,range:[0,P(t.rawMax)]}},hooks:{setCursor:[i=>{const{idx:e,left:s=0,top:f=0}=i.cursor;if(e==null){k(S=>({...S,visible:!1}));return}const b=g.current[e]||"",z=i.data[1][e]??0,v=i.data[2][e]??0,R=i.bbox.left,M=i.bbox.top;let w=R+s+20;w>i.width-150&&(w=R+s-160),k({visible:!0,left:w,top:M+f,label:b,upload:z,download:v})}]}},c=[m,t.upload,t.download],h=new E(r,c,x.current);return d.current=h,()=>{h.destroy(),d.current=null}},[]),u.useEffect(()=>{if(!d.current)return;const o=d.current,n=P(t.rawMax),r=[m,t.upload,t.download];o.batch(()=>{o.setScale("y",{min:0,max:n}),o.setData(r)})},[t,m]),u.useEffect(()=>{if(!a.current||!d.current)return;const o=new ResizeObserver(n=>{if(d.current)for(let r of n){const{width:c,height:h}=r.contentRect;c>0&&h>0&&d.current.setSize({width:c,height:h})}});return o.observe(a.current),()=>o.disconnect()},[]),l.jsxs(l.Fragment,{children:[l.jsx(W,{...T}),l.jsxs("div",{ref:a,style:{position:"relative",width:"100%",height:"100%",minHeight:p,flex:"1 1 auto",display:"flex",flexDirection:"column",minWidth:0},children:[l.jsx("div",{ref:x,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden"}}),l.jsx("div",{ref:y,style:{position:"absolute",display:"none",top:0,left:0,zIndex:100,pointerEvents:"none",backgroundColor:"rgba(15, 23, 42, 0.9)",border:"0px solid rgba(255,255,255,0.1)",padding:"0px",borderRadius:"6px",boxShadow:"0 2px 4px -1px rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.06)",color:"white",fontSize:"6px",whiteSpace:"nowrap",transition:"opacity 0.1s ease"}})]})]})};export{Y as default};
