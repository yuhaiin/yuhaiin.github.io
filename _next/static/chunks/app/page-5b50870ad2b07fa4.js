(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{5717:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var n=s(29300),a=s.n(n),l=s(12115),i=s(97390),d=s(95155);let r=l.forwardRef((e,t)=>{let{bsPrefix:s,bg:n="primary",pill:l=!1,text:r,className:c,as:o="span",...h}=e,m=(0,i.oU)(s,"badge");return(0,d.jsx)(o,{ref:t,...h,className:a()(c,m,l&&"rounded-pill",r&&"text-".concat(r),n&&"bg-".concat(n))})});r.displayName="Badge";let c=r},26506:(e,t,s)=>{"use strict";s.d(t,{HU:()=>x,TH:()=>j,c5:()=>N,qM:()=>f,z3:()=>g});var n=s(95155),a=s(67167),l=s(12115),i=s(69056),d=s(5717),r=s(76355),c=s(19169),o=s(98508),h=s(70715),m=s(3384);let x=e=>{let{itemKey:t,itemValue:s,showModal:a}=e;return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(i.A.Item,{children:(0,n.jsxs)("div",{className:"d-sm-flex",children:[(0,n.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-capitalize",children:t}),(0,n.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:(0,n.jsx)(u,{itemKey:t,itemValue:s,showModal:a})})]})})})},u=e=>{let{itemKey:t,itemValue:s,showModal:a}=e;if("mode reason"===t){let e=JSON.parse(s);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,n.jsx)("div",{style:{flex:1,height:"1px",background:"black"}}),(0,n.jsx)("span",{children:(0,n.jsx)("b",{children:"Rule Name"})}),(0,n.jsx)("div",{style:{flex:1,height:"1px",background:"black"}})]}),(0,n.jsx)("div",{className:"mt-2 mb-2",children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(d.A,{bg:"success",children:"Hit"})," List Name"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d.A,{bg:"danger",children:"Miss"})," List Name"]})]})})]}),(0,n.jsx)("hr",{}),e.map((e,t)=>(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,n.jsx)("div",{style:{flex:1,height:"1px",background:"black"}}),(0,n.jsx)("span",{children:(0,n.jsx)("b",{children:e.rule_name})}),(0,n.jsx)("div",{style:{flex:1,height:"1px",background:"black"}})]}),(0,n.jsx)("div",{className:"mt-2 mb-2",children:e.history.map((e,t)=>(0,n.jsx)("div",{children:(0,n.jsxs)("div",{children:[e.matched?(0,n.jsx)(d.A,{bg:"success",children:"Hit"}):(0,n.jsx)(d.A,{bg:"danger",children:"Miss"})," ",e.list_name]})},"list-"+e.list_name+t))})]},"rule-"+e.rule_name+t))]})}return"hash"==t&&a?(0,n.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),a(s)},children:s}):(0,n.jsx)(n.Fragment,{children:s})},j=e=>{let{value:t,startContent:s,endContent:l,showModal:d}=e;return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(i.A,{variant:"flush",className:"w-100 p-2",children:[s,function(e){let t=(0,a.E4)(h.mR,e),s=(e,t)=>{if("enum"===e.fieldKind){let s=t.get(e);return e.enum.value[s].name}{let s=t.get(e);if(!s)return;return s.toString()}},l=e=>{let{f:t,ref:a}=e,l=s(t,a);if(l)return(0,n.jsx)(x,{itemKey:t.name.replaceAll("_"," "),itemValue:l,showModal:d})};return(0,n.jsx)(n.Fragment,{children:t.fields.map(e=>{if("message"===e.fieldKind){let s=t.get(e);return s.fields.map(e=>(0,n.jsx)(l,{f:e,ref:s},e.name))}return(0,n.jsx)(l,{f:e,ref:t},e.name)})})}(t),l]})})},p={B:"B",KB:"KB",MB:"MB",GB:"GB",TB:"TB",PB:"PB"},g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,{bytes:s,unit:n}=e>=0x4000000000000?{bytes:e/0x4000000000000,unit:p.PB}:e>=0x10000000000?{bytes:e/0x10000000000,unit:p.TB}:e>=0x40000000?{bytes:e/0x40000000,unit:p.GB}:e>=1048576?{bytes:e/1048576,unit:p.MB}:e>=1024?{bytes:e/1024,unit:p.KB}:{bytes:e,unit:p.B};return"".concat(s.toFixed(t)).concat(n)};class b{DownloadString(){let e=g(this.download),t=g(this.download_rate)+"/S";return"(".concat(e,"): ").concat(t)}UploadString(){let e=g(this.upload),t=g(this.upload_rate)+"/S";return"(".concat(e,"): ").concat(t)}constructor(e=0,t=0,s=0,n=0,a={}){this.download=e,this.download_rate=t,this.upload=s,this.upload_rate=n,this.counters=a,this.time=new Date}}let v=(e,t)=>{let s=(new Date().getTime()-t.time.getTime())/1e3,n=0,a=0;if((0!==t.download||0!==t.upload)&&0!==s){let l=Number(e.download),i=Number(e.upload);n=(l-t.download)/s,a=(i-t.upload)/s}return{download_rate:n,upload_rate:a}},f=()=>{let[e,t]=(0,l.useState)(new b(0,0,0,0,{}));return(0,c.Ay)((0,o.cY)(m.oQ.method.total),async()=>(0,o.kP)(m.oQ.method.total).then(async s=>{let{data:n,error:a}=s;if(a)throw a;if(n)try{let s=v(n,e),a=new b(Number(n.download),s.download_rate,Number(n.upload),s.upload_rate,n.counters);return t(a),a}catch(e){throw{msg:e.toString(),code:500}}}),{refreshInterval:2e3})},w=e=>{let{lastFlow:t,flow_error:s,end_content:a}=e;return(0,n.jsx)(r.A,{className:"mb-3",children:(0,n.jsxs)(i.A,{variant:"flush",children:[(0,n.jsx)(i.A.Item,{children:(0,n.jsxs)("div",{className:"d-sm-flex",children:[(0,n.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Download"}),(0,n.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-download",children:s?s.msg:t?t.DownloadString():"Loading..."})]})}),(0,n.jsx)(i.A.Item,{children:(0,n.jsxs)("div",{className:"d-sm-flex",children:[(0,n.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Upload"}),(0,n.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-upload",children:s?s.msg:t?t.UploadString():"Loading..."})]})}),a]})})},N=l.memo(e=>{let{onUpdate:t,end_content:s}=e,{data:a,error:i}=f();return(0,l.useEffect)(()=>{t&&a&&t(a.counters)},[t,a]),(0,n.jsx)(w,{lastFlow:a,flow_error:i,end_content:s})})},49490:(e,t,s)=>{Promise.resolve().then(s.bind(s,81133))},81133:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var n=s(95155),a=s(20960),l=s(12115),i=s(69056),d=s(98508),r=s(26506),c=s(87494),o=s(88580),h=s(8408);let m=function(){let[e,t]=(0,l.useState)({show:!1,point:(0,a.v)(h.Ac,{})}),{data:s,error:m,isLoading:x}=(0,d.mp)(o.rH.method.now);return(0,n.jsxs)("div",{children:[(0,n.jsx)(c.y,{show:e.show,hash:e.point.hash,point:e.point,editable:!1,onHide:()=>t({...e,show:!1})}),(0,n.jsx)(r.c5,{end_content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.A.Item,{children:(0,n.jsxs)("div",{className:"d-sm-flex",children:[(0,n.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"TCP"}),(0,n.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-download",children:x?"loading...":m?m.msg:(0,n.jsxs)("a",{href:"#",onClick:()=>{t({show:!0,point:s.tcp})},children:[s.tcp.group,"/",s.tcp.name]})})]})}),(0,n.jsx)(i.A.Item,{children:(0,n.jsxs)("div",{className:"d-sm-flex",children:[(0,n.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"UDP"}),(0,n.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-upload",children:x?"loading...":m?m.msg:(0,n.jsxs)("a",{href:"#",onClick:()=>{t({show:!0,point:s.udp})},children:[s.udp.group,"/",s.udp.name]})})]})})]})})]})};function x(){return(0,n.jsx)("div",{children:(0,n.jsx)(m,{})})}},99695:(e,t,s)=>{"use strict";s.d(t,{i:()=>l,w:()=>i});var n=s(9152),a=s(78133);let l=(0,n.w)("Ch9nb29nbGUvcHJvdG9idWYvdGltZXN0YW1wLnByb3RvEg9nb29nbGUucHJvdG9idWYiKwoJVGltZXN0YW1wEg8KB3NlY29uZHMYASABKAMSDQoFbmFub3MYAiABKAVChQEKE2NvbS5nb29nbGUucHJvdG9idWZCDlRpbWVzdGFtcFByb3RvUAFaMmdvb2dsZS5nb2xhbmcub3JnL3Byb3RvYnVmL3R5cGVzL2tub3duL3RpbWVzdGFtcHBi+AEBogIDR1BCqgIeR29vZ2xlLlByb3RvYnVmLldlbGxLbm93blR5cGVzYgZwcm90bzM"),i=(0,a.Z)(l,0)}},e=>{var t=t=>e(e.s=t);e.O(0,[3528,11,601,3779,5453,1085,6077,5225,9873,3959,5309,626,7494,3384,8441,1684,7358],()=>t(49490)),_N_E=e.O()}]);