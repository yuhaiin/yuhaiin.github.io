(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5619],{26506:(e,t,s)=>{"use strict";s.d(t,{TH:()=>j,c5:()=>w,gW:()=>h,z3:()=>y});var a=s(95155),l=s(12115),n=s(69056),i=s(5717),d=s(76355),o=s(19169),r=s(98508),c=s(87494),m=s(29940),u=s(70715),x=s(3384);let h=e=>{let{itemKey:t,itemValue:s}=e;return""==s?(0,a.jsx)(a.Fragment,{}):(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(n.A.Item,{children:(0,a.jsxs)("div",{className:"d-sm-flex",children:[(0,a.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-capitalize",children:t}),(0,a.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:s})]})})})},j=e=>{var t,s;let{value:d,startContent:o,endContent:r}=e,[x,j]=(0,l.useState)({show:!1,hash:""}),p=(0,l.useCallback)(e=>{j({show:!0,hash:e})},[j]),y=(0,l.useCallback)(()=>{j(e=>({...e,show:!1}))},[j]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.y,{show:x.show,hash:x.hash,editable:!1,onHide:y}),(0,a.jsxs)(n.A,{variant:"flush",className:"w-100 p-2",children:[o,(0,a.jsx)(h,{itemKey:"Id",itemValue:d.id.toString()}),(0,a.jsx)(h,{itemKey:"Addr",itemValue:d.addr}),(0,a.jsx)(h,{itemKey:"Type",itemValue:u.NW[null==(t=d.type)?void 0:t.connType]}),(0,a.jsx)(h,{itemKey:"UnderlyingType",itemValue:u.NW[null==(s=d.type)?void 0:s.underlyingType]}),(0,a.jsx)(h,{itemKey:"Inbound",itemValue:d.inboundName}),(0,a.jsx)(h,{itemKey:"InboundAddr",itemValue:d.inbound}),(0,a.jsx)(h,{itemKey:"Source",itemValue:d.source}),(0,a.jsx)(h,{itemKey:"Outbound",itemValue:d.outbound}),(0,a.jsx)(h,{itemKey:"LocalAddr",itemValue:d.localAddr}),(0,a.jsx)(h,{itemKey:"Destination",itemValue:d.destionation}),(0,a.jsx)(h,{itemKey:"FakeIP",itemValue:d.fakeIp}),(0,a.jsx)(h,{itemKey:"Hosts",itemValue:d.hosts}),(0,a.jsx)(h,{itemKey:"Domain",itemValue:d.domain}),(0,a.jsx)(h,{itemKey:"IP",itemValue:d.ip}),(0,a.jsx)(h,{itemKey:"Tag",itemValue:d.tag}),(d.nodeName||d.hash)&&(0,a.jsx)(n.A.Item,{children:(0,a.jsxs)("div",{className:"d-sm-flex",children:[(0,a.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-capitalize",children:"Point"}),(0,a.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:(0,a.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),p(d.hash)},children:d.nodeName?d.nodeName:d.hash})})]})}),(0,a.jsx)(h,{itemKey:"Protocol",itemValue:d.protocol}),(0,a.jsx)(h,{itemKey:"Process",itemValue:d.process}),(0,a.jsx)(h,{itemKey:"TlsServerName",itemValue:d.tlsServerName}),(0,a.jsx)(h,{itemKey:"HttpHost",itemValue:d.httpHost}),(0,a.jsx)(h,{itemKey:"Component",itemValue:d.component}),(0,a.jsx)(h,{itemKey:"Mode",itemValue:m.Mq[d.mode]}),(0,a.jsx)(h,{itemKey:"UdpMigrateId",itemValue:d.udpMigrateId?d.udpMigrateId.toString():""}),(0,a.jsx)(h,{itemKey:"Pid",itemValue:d.pid?d.pid.toString():""}),(0,a.jsx)(h,{itemKey:"Uid",itemValue:d.uid?d.uid.toString():""}),d.matchHistory&&d.matchHistory.length>0&&(0,a.jsx)(n.A.Item,{children:(0,a.jsxs)("div",{className:"d-sm-flex",children:[(0,a.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-capitalize",children:"MatchHistory"}),(0,a.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:d.matchHistory.map((e,t)=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,a.jsx)("div",{style:{flex:1,height:"1px",background:"black"}}),(0,a.jsx)("span",{children:(0,a.jsx)("b",{children:e.ruleName})}),(0,a.jsx)("div",{style:{flex:1,height:"1px",background:"black"}})]}),(0,a.jsx)("div",{className:"mt-2 mb-2",children:e.history&&e.history.map((e,t)=>(0,a.jsx)("div",{children:(0,a.jsxs)("div",{children:[e.matched?(0,a.jsx)(i.A,{bg:"success",children:"Hit"}):(0,a.jsx)(i.A,{bg:"danger",children:"Miss"})," ",e.listName]})},"list-"+e.listName+t))})]},"rule-"+e.ruleName+t))})]})}),r]})]})},p={B:"B",KB:"KB",MB:"MB",GB:"GB",TB:"TB",PB:"PB"},y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,{bytes:s,unit:a}=e>=0x4000000000000?{bytes:e/0x4000000000000,unit:p.PB}:e>=0x10000000000?{bytes:e/0x10000000000,unit:p.TB}:e>=0x40000000?{bytes:e/0x40000000,unit:p.GB}:e>=1048576?{bytes:e/1048576,unit:p.MB}:e>=1024?{bytes:e/1024,unit:p.KB}:{bytes:e,unit:p.B};return"".concat(s.toFixed(t)).concat(a)};class g{DownloadString(){let e=y(this.download),t=y(this.download_rate)+"/S";return"(".concat(e,"): ").concat(t)}UploadString(){let e=y(this.upload),t=y(this.upload_rate)+"/S";return"(".concat(e,"): ").concat(t)}constructor(e=0,t=0,s=0,a=0,l={}){this.download=e,this.download_rate=t,this.upload=s,this.upload_rate=a,this.counters=l,this.time=new Date}}let v=e=>{let{lastFlow:t,flow_error:s,end_content:l}=e;return(0,a.jsx)(d.A,{className:"mb-3",children:(0,a.jsxs)(n.A,{variant:"flush",children:[(0,a.jsx)(n.A.Item,{children:(0,a.jsxs)("div",{className:"d-sm-flex",children:[(0,a.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Download"}),(0,a.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-download",children:s?s.msg:t?t.DownloadString():"Loading..."})]})}),(0,a.jsx)(n.A.Item,{children:(0,a.jsxs)("div",{className:"d-sm-flex",children:[(0,a.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Upload"}),(0,a.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-upload",children:s?s.msg:t?t.UploadString():"Loading..."})]})}),l]})})},w=l.memo(e=>{let{onUpdate:t,end_content:s}=e,{data:n,error:i}=(()=>{let[e,t]=(0,l.useState)(new g(0,0,0,0,{}));return(0,o.Ay)((0,r.cY)(x.oQ.method.total),async()=>(0,r.kP)(x.oQ.method.total).then(async s=>{let{data:a,error:l}=s;if(l)throw l;if(a)try{let s=((e,t)=>{let s=(new Date().getTime()-t.time.getTime())/1e3;if((0!==t.download||0!==t.upload)&&0!==s){let a=Number(e.download),l=Number(e.upload);return{download_rate:a>t.download?(a-t.download)/s:0,upload_rate:l>t.upload?(l-t.upload)/s:0}}return{download_rate:0,upload_rate:0}})(a,e),l=new g(Number(a.download),s.download_rate,Number(a.upload),s.upload_rate,a.counters);return t(l),l}catch(e){throw{msg:e.toString(),code:500}}}),{refreshInterval:2e3})})();return(0,l.useEffect)(()=>{t&&n&&t(n.counters)},[t,n]),(0,a.jsx)(v,{lastFlow:n,flow_error:i,end_content:s})})},84771:(e,t,s)=>{Promise.resolve().then(s.bind(s,96576))},96576:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>k});var a=s(95155),l=s(74086),n=s(98508),i=s(66835),d=s(26506),o=s(70715),r=s(3384),c=s(20960),m=s(71464),u=s(12115),x=s(76355),h=s(69056),j=s(5717),p=s(12815),y=s(60902),g=s(91867),v=s(40840),w=s(29940);let N=(e,t)=>{let s;switch(s=void 0===t?{}:{...t},e.data.case){case"notifyNewConnections":e.data.value.connections.sort((e,t)=>e.id>t.id?1:-1).forEach(e=>{s[e.id.toString()]=e});break;case"notifyRemoveConnections":e.data.value.ids.forEach(e=>{delete s[e.toString()]})}return s},f=u.memo(e=>{let{conns:t,counters:s,conn_error:n,setInfo:i,sortFields:d,sortOrder:o}=e,r=(0,u.useMemo)(()=>Object.values(null!=t?t:{}).sort((e,t)=>{let a=1,l=-1;if("asc"===o&&(a=-1,l=1),d){var n,i,r,c,m,u,x,h;switch(d){case"download":return(null!=(r=null==(n=s[e.id.toString()])?void 0:n.download)?r:0)<(null!=(c=null==(i=s[t.id.toString()])?void 0:i.download)?c:0)?a:l;case"upload":return(null!=(x=null==(m=s[e.id.toString()])?void 0:m.upload)?x:0)<(null!=(h=null==(u=s[t.id.toString()])?void 0:u.upload)?h:0)?a:l;case"name":return e.addr<t.addr?a:l}}return e.id<t.id?a:l}),[t,d,s,o]);return void 0!==n?(0,a.jsx)(l.A,{code:n.code,children:n.msg}):void 0===t?(0,a.jsx)(l.A,{}):(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(x.A,{children:(0,a.jsx)(h.A,{variant:"flush",style:{borderBottom:"none"},children:r.map(e=>{var t,l,n,d;return(0,a.jsx)(b,{data:e,download:Number(null!=(n=null==(t=s[e.id.toString()])?void 0:t.download)?n:0),upload:Number(null!=(d=null==(l=s[e.id.toString()])?void 0:l.upload)?d:0),onClick:()=>i({info:e,show:!0})},e.id)})})})})}),b=u.memo(e=>{let{data:t,download:s,upload:l,onClick:n}=e;return(0,a.jsxs)(h.A.Item,{className:"d-flex justify-content-between align-items-start py-3 flex-wrap",style:{border:"0ch",borderBottom:"1px solid #dee2e6"},action:!0,onClick:n,children:[(0,a.jsxs)("div",{className:"text-break",children:[(0,a.jsx)("code",{children:t.id.toString()}),(0,a.jsx)("span",{className:"ms-2",children:t.addr})]}),(0,a.jsxs)("div",{className:"fs-9",children:[(0,a.jsx)(S,{download:s,upload:l}),(0,a.jsx)(()=>(0,a.jsx)(j.A,{bg:"primary",pill:!0,className:"ms-1 text-uppercase",children:w.Mq[t.mode]}),{}),(0,a.jsx)(()=>{var e,s;return(0,a.jsx)(j.A,{bg:"primary",pill:!0,className:"ms-1 text-uppercase",children:o.NW[null!=(s=null==(e=t.type)?void 0:e.connType)?s:0]})},{}),(0,a.jsx)(()=>t.tag?(0,a.jsx)(j.A,{bg:"primary",pill:!0,className:"ms-1 text-uppercase",children:t.tag}):(0,a.jsx)(a.Fragment,{}),{})]})]})}),S=u.memo(e=>{let{download:t,upload:s}=e;return(0,a.jsxs)(j.A,{bg:"primary",pill:!0,children:[(0,d.z3)(t)," / ",(0,d.z3)(s)]})}),A=u.memo(e=>{let{data:t,show:s,onClose:l}=e,o=(0,u.useContext)(i.u),[m,x]=(0,u.useState)(!1),j=(0,u.useCallback)(()=>{x(!0),(0,n.kP)(r.oQ.method.close_conn,(0,c.v)(r.SE,{ids:[t.id]})).then(async e=>{let{error:s}=e;s?(o.Error("code ".concat(t.id," failed, ").concat(s.code,"| ").concat(s.msg)),x(!1)):setTimeout(()=>{x(!1)},5e3)})},[x,t.id,o]);return(0,a.jsx)(p.A,{className:"w-75",show:s,onHide:l,placement:"end",scroll:!0,renderStaticNode:!0,children:(0,a.jsx)(p.A.Body,{children:(0,a.jsx)(d.TH,{value:t,endContent:(0,a.jsx)(h.A.Item,{children:(0,a.jsx)("div",{className:"d-flex",children:(0,a.jsxs)(y.A,{variant:"outline-danger",className:"flex-grow-1 notranslate",disabled:m,onClick:j,children:["Close",m&&(0,a.jsxs)(a.Fragment,{children:["\xa0",(0,a.jsx)(g.A,{size:"sm",animation:"border",variant:"danger"})]})]})})})})})})}),k=function(){let[e,t]=(0,u.useState)({}),[s,l]=(0,u.useState)({info:(0,c.v)(o.mR,{}),show:!1}),i=(0,u.useCallback)(()=>{l(e=>({...e,show:!1}))},[]),{data:x,error:h}=(0,v.A)((0,n.cY)(r.oQ.method.notify),(0,n.zZ)(r.oQ.method.notify,(0,c.v)(m.v,{}),N),{}),j=(0,u.useCallback)(e=>{t(e)},[]),[p,y]=(0,u.useState)(""),g=(0,u.useCallback)(e=>{y(e.target.value)},[y]),[w,b]=(0,u.useState)("desc"),S=(0,u.useCallback)(e=>{b(e.target.value)},[b]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.c5,{onUpdate:j}),(0,a.jsx)(A,{data:s.info,show:s.show,onClose:i}),(0,a.jsx)("div",{className:"d-flex",children:(0,a.jsxs)("div",{className:"d-flex align-items-center gap-2 mb-3 ms-auto flex-wrap",children:[(0,a.jsxs)("span",{className:"d-flex align-items-center gap-2",children:["Sort Order",(0,a.jsxs)("select",{className:"form-select",value:w,onChange:S,style:{width:150},children:[(0,a.jsx)("option",{value:"asc",children:"Asc"}),(0,a.jsx)("option",{value:"desc",children:"Desc"})]})]}),(0,a.jsxs)("span",{className:"d-flex align-items-center gap-2",children:["Sort By",(0,a.jsxs)("select",{className:"form-select",value:p,onChange:g,style:{width:150},children:[(0,a.jsx)("option",{value:"",children:"Id"}),(0,a.jsx)("option",{value:"name",children:"Name"}),(0,a.jsx)("option",{value:"download",children:"Download"}),(0,a.jsx)("option",{value:"upload",children:"Upload"})]})]})]})}),(0,a.jsx)(f,{conns:x,counters:e,setInfo:l,conn_error:h,sortFields:p,sortOrder:w})]})}}},e=>{e.O(0,[3528,11,3597,3779,1085,9349,7315,8684,4905,3959,6160,5309,626,7494,3384,8441,5964,7358],()=>e(e.s=84771)),_N_E=e.O()}]);