(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5619],{26506:(e,s,t)=>{"use strict";t.d(s,{HU:()=>m,TH:()=>j,c5:()=>N,qM:()=>w,z3:()=>g});var l=t(95155),a=t(67167),n=t(12115),r=t(69056),d=t(5717),i=t(76355),o=t(19169),c=t(98508),h=t(70715),u=t(3384);let m=e=>{let{itemKey:s,itemValue:t,showModal:a}=e;return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(r.A.Item,{children:(0,l.jsxs)("div",{className:"d-sm-flex",children:[(0,l.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-capitalize",children:s}),(0,l.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:(0,l.jsx)(x,{itemKey:s,itemValue:t,showModal:a})})]})})})},x=e=>{let{itemKey:s,itemValue:t,showModal:a}=e;if("mode reason"===s){let e=JSON.parse(t);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,l.jsx)("div",{style:{flex:1,height:"1px",background:"black"}}),(0,l.jsx)("span",{children:(0,l.jsx)("b",{children:"Rule Name"})}),(0,l.jsx)("div",{style:{flex:1,height:"1px",background:"black"}})]}),(0,l.jsx)("div",{className:"mt-2 mb-2",children:(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(d.A,{bg:"success",children:"Hit"})," List Name"]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(d.A,{bg:"danger",children:"Miss"})," List Name"]})]})})]}),(0,l.jsx)("hr",{}),e.map((e,s)=>(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,l.jsx)("div",{style:{flex:1,height:"1px",background:"black"}}),(0,l.jsx)("span",{children:(0,l.jsx)("b",{children:e.rule_name})}),(0,l.jsx)("div",{style:{flex:1,height:"1px",background:"black"}})]}),(0,l.jsx)("div",{className:"mt-2 mb-2",children:e.history.map((e,s)=>(0,l.jsx)("div",{children:(0,l.jsxs)("div",{children:[e.matched?(0,l.jsx)(d.A,{bg:"success",children:"Hit"}):(0,l.jsx)(d.A,{bg:"danger",children:"Miss"})," ",e.list_name]})},"list-"+e.list_name+s))})]},"rule-"+e.rule_name+s))]})}return"hash"==s&&a?(0,l.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),a(t)},children:t}):(0,l.jsx)(l.Fragment,{children:t})},j=e=>{let{value:s,startContent:t,endContent:n,showModal:d}=e;return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(r.A,{variant:"flush",className:"w-100 p-2",children:[t,function(e){let s=(0,a.E4)(h.mR,e),t=(e,s)=>{if("enum"===e.fieldKind){let t=s.get(e);return e.enum.value[t].name}{let t=s.get(e);if(!t)return;return t.toString()}},n=e=>{let{f:s,ref:a}=e,n=t(s,a);if(n)return(0,l.jsx)(m,{itemKey:s.name.replaceAll("_"," "),itemValue:n,showModal:d})};return(0,l.jsx)(l.Fragment,{children:s.fields.map(e=>{if("message"===e.fieldKind){let t=s.get(e);return t.fields.map(e=>(0,l.jsx)(n,{f:e,ref:t},e.name))}return(0,l.jsx)(n,{f:e,ref:s},e.name)})})}(s),n]})})},p={B:"B",KB:"KB",MB:"MB",GB:"GB",TB:"TB",PB:"PB"},g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,{bytes:t,unit:l}=e>=0x4000000000000?{bytes:e/0x4000000000000,unit:p.PB}:e>=0x10000000000?{bytes:e/0x10000000000,unit:p.TB}:e>=0x40000000?{bytes:e/0x40000000,unit:p.GB}:e>=1048576?{bytes:e/1048576,unit:p.MB}:e>=1024?{bytes:e/1024,unit:p.KB}:{bytes:e,unit:p.B};return"".concat(t.toFixed(s)).concat(l)};class v{DownloadString(){let e=g(this.download),s=g(this.download_rate)+"/S";return"(".concat(e,"): ").concat(s)}UploadString(){let e=g(this.upload),s=g(this.upload_rate)+"/S";return"(".concat(e,"): ").concat(s)}constructor(e=0,s=0,t=0,l=0,a={}){this.download=e,this.download_rate=s,this.upload=t,this.upload_rate=l,this.counters=a,this.time=new Date}}let f=(e,s)=>{let t=(new Date().getTime()-s.time.getTime())/1e3,l=0,a=0;if((0!==s.download||0!==s.upload)&&0!==t){let n=Number(e.download),r=Number(e.upload);l=(n-s.download)/t,a=(r-s.upload)/t}return{download_rate:l,upload_rate:a}},w=()=>{let[e,s]=(0,n.useState)(new v(0,0,0,0,{}));return(0,o.Ay)((0,c.cY)(u.oQ.method.total),async()=>(0,c.kP)(u.oQ.method.total).then(async t=>{let{data:l,error:a}=t;if(a)throw a;if(l)try{let t=f(l,e),a=new v(Number(l.download),t.download_rate,Number(l.upload),t.upload_rate,l.counters);return s(a),a}catch(e){throw{msg:e.toString(),code:500}}}),{refreshInterval:2e3})},b=e=>{let{lastFlow:s,flow_error:t,end_content:a}=e;return(0,l.jsx)(i.A,{className:"mb-3",children:(0,l.jsxs)(r.A,{variant:"flush",children:[(0,l.jsx)(r.A.Item,{children:(0,l.jsxs)("div",{className:"d-sm-flex",children:[(0,l.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Download"}),(0,l.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-download",children:t?t.msg:s?s.DownloadString():"Loading..."})]})}),(0,l.jsx)(r.A.Item,{children:(0,l.jsxs)("div",{className:"d-sm-flex",children:[(0,l.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Upload"}),(0,l.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-upload",children:t?t.msg:s?s.UploadString():"Loading..."})]})}),a]})})},N=n.memo(e=>{let{onUpdate:s,end_content:t}=e,{data:a,error:r}=w();return(0,n.useEffect)(()=>{s&&a&&s(a.counters)},[s,a]),(0,l.jsx)(b,{lastFlow:a,flow_error:r,end_content:t})})},84771:(e,s,t)=>{Promise.resolve().then(t.bind(t,96576))},96576:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>_});var l=t(95155),a=t(74086),n=t(98508),r=t(66835),d=t(26506),i=t(87494),o=t(70715),c=t(3384),h=t(20960),u=t(71464),m=t(12115),x=t(76355),j=t(69056),p=t(5717),g=t(12815),v=t(60902),f=t(91867),w=t(40840),b=t(29940);let N=(e,s)=>{let t;switch(t=void 0===s?{}:{...s},e.data.case){case"notifyNewConnections":e.data.value.connections.sort((e,s)=>e.id>s.id?1:-1).forEach(e=>{t[e.id.toString()]=e});break;case"notifyRemoveConnections":e.data.value.ids.forEach(e=>{delete t[e.toString()]})}return t},y=m.memo(e=>{let{conns:s,counters:t,conn_error:n,setInfo:r,sortFields:d,sortOrder:i}=e,o=(0,m.useMemo)(()=>Object.values(null!=s?s:{}).sort((e,s)=>{let l=1,a=-1;if("asc"===i&&(l=-1,a=1),d){var n,r,o,c,h,u,m,x;switch(d){case"download":return(null!=(o=null==(n=t[e.id.toString()])?void 0:n.download)?o:0)<(null!=(c=null==(r=t[s.id.toString()])?void 0:r.download)?c:0)?l:a;case"upload":return(null!=(m=null==(h=t[e.id.toString()])?void 0:h.upload)?m:0)<(null!=(x=null==(u=t[s.id.toString()])?void 0:u.upload)?x:0)?l:a;case"name":return e.addr<s.addr?l:a}}return e.id<s.id?l:a}),[s,d,t,i]);return void 0!==n?(0,l.jsx)(a.A,{code:n.code,children:n.msg}):void 0===s?(0,l.jsx)(a.A,{}):(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(x.A,{children:(0,l.jsx)(j.A,{variant:"flush",style:{borderBottom:"none"},children:o.map(e=>{var s,a,n,d;return(0,l.jsx)(S,{data:e,download:Number(null!=(n=null==(s=t[e.id.toString()])?void 0:s.download)?n:0),upload:Number(null!=(d=null==(a=t[e.id.toString()])?void 0:a.upload)?d:0),onClick:()=>r({info:e,show:!0})},e.id)})})})})}),S=m.memo(e=>{let{data:s,download:t,upload:a,onClick:n}=e;return(0,l.jsxs)(j.A.Item,{className:"d-flex justify-content-between align-items-start py-3 flex-wrap",style:{border:"0ch",borderBottom:"1px solid #dee2e6"},action:!0,onClick:n,children:[(0,l.jsxs)("div",{className:"text-break",children:[(0,l.jsx)("code",{children:s.id.toString()}),(0,l.jsx)("span",{className:"ms-2",children:s.addr})]}),(0,l.jsxs)("div",{className:"fs-9",children:[(0,l.jsx)(k,{download:t,upload:a}),(0,l.jsx)(()=>(0,l.jsx)(p.A,{bg:"primary",pill:!0,className:"ms-1 text-uppercase",children:b.Mq[s.mode]}),{}),(0,l.jsx)(()=>{var e,t;return(0,l.jsx)(p.A,{bg:"primary",pill:!0,className:"ms-1 text-uppercase",children:o.NW[null!=(t=null==(e=s.type)?void 0:e.connType)?t:0]})},{}),(0,l.jsx)(()=>s.tag?(0,l.jsx)(p.A,{bg:"primary",pill:!0,className:"ms-1 text-uppercase",children:s.tag}):(0,l.jsx)(l.Fragment,{}),{})]})]})}),k=m.memo(e=>{let{download:s,upload:t}=e;return(0,l.jsxs)(p.A,{bg:"primary",pill:!0,children:[(0,d.z3)(s)," / ",(0,d.z3)(t)]})}),A=m.memo(e=>{let{data:s,show:t,onClose:a,showModal:i}=e,o=(0,m.useContext)(r.u),[u,x]=(0,m.useState)(!1),p=(0,m.useCallback)(()=>{x(!0),(0,n.kP)(c.oQ.method.close_conn,(0,h.v)(c.SE,{ids:[s.id]})).then(async e=>{let{error:t}=e;t?(o.Error("code ".concat(s.id," failed, ").concat(t.code,"| ").concat(t.msg)),x(!1)):setTimeout(()=>{x(!1)},5e3)})},[x,s.id,o]);return(0,l.jsx)(g.A,{className:"w-75",show:t,onHide:a,placement:"end",scroll:!0,renderStaticNode:!0,children:(0,l.jsx)(g.A.Body,{children:(0,l.jsx)(d.TH,{value:s,showModal:i,endContent:(0,l.jsx)(j.A.Item,{children:(0,l.jsx)("div",{className:"d-flex",children:(0,l.jsxs)(v.A,{variant:"outline-danger",className:"flex-grow-1 notranslate",disabled:u,onClick:p,children:["Close",u&&(0,l.jsxs)(l.Fragment,{children:["\xa0",(0,l.jsx)(f.A,{size:"sm",animation:"border",variant:"danger"})]})]})})})})})})}),_=function(){let[e,s]=(0,m.useState)({show:!1,hash:""}),[t,a]=(0,m.useState)({}),[r,x]=(0,m.useState)({info:(0,h.v)(o.mR,{}),show:!1}),j=(0,m.useCallback)(()=>{x(e=>({...e,show:!1}))},[]),p=(0,m.useCallback)(e=>{s({show:!0,hash:e})},[]),g=(0,m.useCallback)(()=>{s(e=>({...e,show:!1}))},[]),{data:v,error:f}=(0,w.A)((0,n.cY)(c.oQ.method.notify),(0,n.zZ)(c.oQ.method.notify,(0,h.v)(u.v,{}),N),{}),b=(0,m.useCallback)(e=>{a(e)},[]),[S,k]=(0,m.useState)(""),_=(0,m.useCallback)(e=>{k(e.target.value)},[k]),[B,C]=(0,m.useState)("desc"),F=(0,m.useCallback)(e=>{C(e.target.value)},[C]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d.c5,{onUpdate:b}),(0,l.jsx)(i.y,{show:e.show,hash:e.hash,editable:!1,onHide:g}),(0,l.jsx)(A,{data:r.info,show:r.show,onClose:j,showModal:p}),(0,l.jsx)("div",{className:"d-flex",children:(0,l.jsxs)("div",{className:"d-flex align-items-center gap-2 mb-3 ms-auto flex-wrap",children:[(0,l.jsxs)("span",{className:"d-flex align-items-center gap-2",children:["Sort Order",(0,l.jsxs)("select",{className:"form-select",value:B,onChange:F,style:{width:150},children:[(0,l.jsx)("option",{value:"asc",children:"Asc"}),(0,l.jsx)("option",{value:"desc",children:"Desc"})]})]}),(0,l.jsxs)("span",{className:"d-flex align-items-center gap-2",children:["Sort By",(0,l.jsxs)("select",{className:"form-select",value:S,onChange:_,style:{width:150},children:[(0,l.jsx)("option",{value:"",children:"Id"}),(0,l.jsx)("option",{value:"name",children:"Name"}),(0,l.jsx)("option",{value:"download",children:"Download"}),(0,l.jsx)("option",{value:"upload",children:"Upload"})]})]})]})}),(0,l.jsx)(y,{conns:v,counters:t,setInfo:x,conn_error:f,sortFields:S,sortOrder:B})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[3528,11,601,3779,5453,1085,6077,5225,9873,3959,6160,5309,626,7494,3384,8441,1684,7358],()=>s(84771)),_N_E=e.O()}]);