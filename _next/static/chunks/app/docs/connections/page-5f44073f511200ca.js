(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[706],{8438:(a,d,l)=>{Promise.resolve().then(l.bind(l,2988))},2988:(a,d,l)=>{"use strict";l.r(d),l.d(d,{default:()=>Y});var e=l(5155),n=l(2115),o=l(2981),t=l(57),s=l(8900),c=l(1566),i=l(2963),u=l(4216),m=l(1149),r=l(9169),h=l(8927),b=l(148),p=l(6342),g=l(6903),v=l(7558),A=l(3577),R=l(4995),G=l(9297),x=l(698);let W=function(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!+a)return"0B";let l=Math.floor(Math.log(a)/Math.log(1024)),e=parseFloat((a/Math.pow(1024,l)).toFixed(0>d?0:d)),n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"][l];return isNaN(e)||void 0===n?"":"".concat(e).concat(n)},N=(a,d)=>{let l=(a.download-(d.download!==BigInt(0)?d.download:a.download))/BigInt(2),e=(a.upload-(d.upload!==BigInt(0)?d.upload:a.upload))/BigInt(2);return{download:"(".concat(W(Number(a.download)),"): ").concat(W(Number(l)),"/S"),upload:"(".concat(W(Number(a.upload)),"): ").concat(W(Number(e)),"/S")}},Z=n.memo(a=>(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(t.A.Item,{children:(0,e.jsxs)("div",{className:"d-sm-flex",children:[(0,e.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:a.itemKey}),(0,e.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:"Hash"!==a.itemKey?a.itemValue:(0,e.jsx)("a",{href:"#",onClick:d=>{d.preventDefault(),a.showModal(a.itemValue)},children:a.itemValue})})]})})})),y=n.memo(a=>{var d,l,o,m,r,v;let R=(0,n.useContext)(b.u),[G,x]=(0,n.useState)(!1);return(0,e.jsxs)(s.A.Item,{eventKey:a.data.id.toString(),children:[(0,e.jsx)(s.A.Header,{children:(0,e.jsxs)("div",{className:"d-line text-break",children:[(0,e.jsx)("code",{className:"ms-2",children:a.data.id.toString()}),(0,e.jsx)("span",{className:"ms-2",children:a.data.addr}),(0,e.jsx)(c.A,{className:"bg-light rounded-pill text-dark ms-1 text-uppercase",children:a.data.extra.MODE}),(0,e.jsx)(c.A,{className:"bg-light rounded-pill text-dark ms-1 text-uppercase",children:p.NW[null!==(m=null===(d=a.data.type)||void 0===d?void 0:d.connType)&&void 0!==m?m:0]}),void 0!==a.data.extra.Tag&&(0,e.jsx)(c.A,{className:"bg-light rounded-pill text-dark ms-1 text-uppercase",children:a.data.extra.Tag})]})}),(0,e.jsx)(s.A.Body,{children:(0,e.jsxs)(t.A,{variant:"flush",children:[(0,e.jsx)(Z,{itemKey:"Type",itemValue:p.NW[null!==(r=null===(l=a.data.type)||void 0===l?void 0:l.connType)&&void 0!==r?r:0],showModal:a.showModal}),(0,e.jsx)(Z,{itemKey:"Underlying",itemValue:p.NW[null!==(v=null===(o=a.data.type)||void 0===o?void 0:o.underlyingType)&&void 0!==v?v:0],showModal:a.showModal}),Object.entries(a.data.extra).sort((a,d)=>a<=d?-1:1).map(d=>{let[l,n]=d;return(0,e.jsx)(Z,{itemKey:l,itemValue:n,showModal:a.showModal},l)}),(0,e.jsx)(t.A.Item,{children:(0,e.jsx)("div",{className:"d-sm-flex",children:(0,e.jsxs)(i.A,{variant:"outline-danger",className:"flex-grow-1 notranslate",disabled:G,onClick:()=>{x(!0),(0,h.kP)(g.oQ.method.close_conn,"/conn","DELETE",(0,A.v)(g.SE,{ids:[a.data.id]})).then(async d=>{let{error:l}=d;l?(R.Error("code ".concat(a.data.id," failed, ").concat(l.code,"| ").concat(l.msg)),x(!1)):setTimeout(()=>{x(!1)},5e3)})},children:["Close",G&&(0,e.jsxs)(e.Fragment,{children:["\xa0",(0,e.jsx)(u.A,{size:"sm",animation:"border",variant:"danger"})]})]})})})]})})]},a.data.id)}),Y=function(){let[a,d]=(0,n.useState)({show:!1,hash:""}),[l,c]=(0,n.useState)({download:BigInt(0),upload:BigInt(0)}),{data:i,error:u}=(0,R.Ay)("/flow/total",async a=>(0,h.kP)(g.oQ.method.total,a).then(async a=>{let{data:d,error:e}=a;if(e)throw e;if(d){let a=N(d,{download:l.download,upload:l.upload});return c({download:d.download,upload:d.upload}),a}}),{refreshInterval:2e3}),{data:b,error:p}=(0,m.A)("/conn",(0,h.gR)((0,v.R)(G.v,(0,A.v)(G.v)),g.YA,(a,d)=>{switch(void 0===a&&(a=new Map),d.data.case){case"notifyNewConnections":d.data.value.connections.sort((a,d)=>a.id>d.id?1:-1).forEach(d=>{a.set(d.id,d)});break;case"notifyRemoveConnections":d.data.value.ids.forEach(d=>{a.delete(d)})}return a}));return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(x.y,{show:a.show,hash:a.hash,editable:!1,onHide:()=>d({...a,show:!1})}),(0,e.jsx)(o.A,{className:"mb-3",children:(0,e.jsxs)(t.A,{variant:"flush",children:[(0,e.jsx)(t.A.Item,{children:(0,e.jsxs)("div",{className:"d-sm-flex",children:[(0,e.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Download"}),(0,e.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-download",children:i?i.download:void 0!==u?u.msg:"Loading..."})]})}),(0,e.jsx)(t.A.Item,{children:(0,e.jsxs)("div",{className:"d-sm-flex",children:[(0,e.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Upload"}),(0,e.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-upload",children:i?i.upload:void 0!==u?u.msg:"Loading..."})]})})]})}),void 0!==p?(0,e.jsx)(r.A,{code:p.code,children:p.msg}):void 0===b?(0,e.jsx)(r.A,{}):(0,e.jsx)(s.A,{className:"mb-3",alwaysOpen:!0,id:"connections",children:[...b.values()].reverse().map(a=>(0,e.jsx)(y,{data:a,showModal:a=>d({show:!0,hash:a})},a.id))})]})}},6342:(a,d,l)=>{"use strict";l.d(d,{L9:()=>e,NW:()=>n});let e=(0,l(6788).w)("ChZzdGF0aXN0aWMvY29uZmlnLnByb3RvEhF5dWhhaWluLnN0YXRpc3RpYyKEAQoIbmV0X3R5cGUSNQoJY29ubl90eXBlGAEgASgOMhcueXVoYWlpbi5zdGF0aXN0aWMudHlwZVIJY29ubl90eXBlEkEKD3VuZGVybHlpbmdfdHlwZRgCIAEoDjIXLnl1aGFpaW4uc3RhdGlzdGljLnR5cGVSD3VuZGVybHlpbmdfdHlwZSK4AQoKY29ubmVjdGlvbhIMCgRhZGRyGAEgASgJEgoKAmlkGAIgASgEEikKBHR5cGUYAyABKAsyGy55dWhhaWluLnN0YXRpc3RpYy5uZXRfdHlwZRI3CgVleHRyYRgEIAMoCzIoLnl1aGFpaW4uc3RhdGlzdGljLmNvbm5lY3Rpb24uRXh0cmFFbnRyeRosCgpFeHRyYUVudHJ5EgsKA2tleRgBIAEoCRINCgV2YWx1ZRgCIAEoCToCOAEqjwEKBHR5cGUSCwoHdW5rbm93bhAAEgcKA3RjcBABEggKBHRjcDQQAhIICgR0Y3A2EAMSBwoDdWRwEAQSCAoEdWRwNBAFEggKBHVkcDYQBhIGCgJpcBAHEgcKA2lwNBAIEgcKA2lwNhAJEggKBHVuaXgQChIMCgh1bml4Z3JhbRALEg4KCnVuaXhwYWNrZXQQDEIzWjFnaXRodWIuY29tL0FzdXRvcnVmYS95dWhhaWluL3BrZy9wcm90b3Mvc3RhdGlzdGljYgZwcm90bzM");var n=function(a){return a[a.unknown=0]="unknown",a[a.tcp=1]="tcp",a[a.tcp4=2]="tcp4",a[a.tcp6=3]="tcp6",a[a.udp=4]="udp",a[a.udp4=5]="udp4",a[a.udp6=6]="udp6",a[a.ip=7]="ip",a[a.ip4=8]="ip4",a[a.ip6=9]="ip6",a[a.unix=10]="unix",a[a.unixgram=11]="unixgram",a[a.unixpacket=12]="unixpacket",a}({})},6903:(a,d,l)=>{"use strict";l.d(d,{SE:()=>m,YA:()=>u,oQ:()=>r});var e=l(6788),n=l(8123),o=l(4395),t=l(9297),s=l(9678),c=l(6342);let i=(0,e.w)("ChtzdGF0aXN0aWMvZ3JwYy9jb25maWcucHJvdG8SIHl1aGFpaW4ucHJvdG9zLnN0YXRpc3RpYy5zZXJ2aWNlIi4KCnRvdGFsX2Zsb3cSEAoIZG93bmxvYWQYASABKAQSDgoGdXBsb2FkGAIgASgEIpcCCgtub3RpZnlfZGF0YRJCCgp0b3RhbF9mbG93GAMgASgLMiwueXVoYWlpbi5wcm90b3Muc3RhdGlzdGljLnNlcnZpY2UudG90YWxfZmxvd0gAEloKFm5vdGlmeV9uZXdfY29ubmVjdGlvbnMYASABKAsyOC55dWhhaWluLnByb3Rvcy5zdGF0aXN0aWMuc2VydmljZS5ub3RpZnlfbmV3X2Nvbm5lY3Rpb25zSAASYAoZbm90aWZ5X3JlbW92ZV9jb25uZWN0aW9ucxgCIAEoCzI7Lnl1aGFpaW4ucHJvdG9zLnN0YXRpc3RpYy5zZXJ2aWNlLm5vdGlmeV9yZW1vdmVfY29ubmVjdGlvbnNIAEIGCgRkYXRhIkwKFm5vdGlmeV9uZXdfY29ubmVjdGlvbnMSMgoLY29ubmVjdGlvbnMYASADKAsyHS55dWhhaWluLnN0YXRpc3RpYy5jb25uZWN0aW9uIigKGW5vdGlmeV9yZW1vdmVfY29ubmVjdGlvbnMSCwoDaWRzGAEgAygEIp4BCg5mYWlsZWRfaGlzdG9yeRIQCghwcm90b2NvbBgBIAEoCRIMCgRob3N0GAIgASgJEg0KBWVycm9yGAMgASgJEg8KB3Byb2Nlc3MYBCABKAkSKAoEdGltZRgFIAEoCzIaLmdvb2dsZS5wcm90b2J1Zi5UaW1lc3RhbXASIgoMZmFpbGVkX2NvdW50GAYgASgEUgxmYWlsZWRfY291bnQijAEKE2ZhaWxlZF9oaXN0b3J5X2xpc3QSQQoHb2JqZWN0cxgBIAMoCzIwLnl1aGFpaW4ucHJvdG9zLnN0YXRpc3RpYy5zZXJ2aWNlLmZhaWxlZF9oaXN0b3J5EjIKFGR1bXBfcHJvY2Vzc19lbmFibGVkGAIgASgIUhRkdW1wX3Byb2Nlc3NfZW5hYmxlZDLOAwoLY29ubmVjdGlvbnMSWQoFY29ubnMSFi5nb29nbGUucHJvdG9idWYuRW1wdHkaOC55dWhhaWluLnByb3Rvcy5zdGF0aXN0aWMuc2VydmljZS5ub3RpZnlfbmV3X2Nvbm5lY3Rpb25zEmEKCmNsb3NlX2Nvbm4SOy55dWhhaWluLnByb3Rvcy5zdGF0aXN0aWMuc2VydmljZS5ub3RpZnlfcmVtb3ZlX2Nvbm5lY3Rpb25zGhYuZ29vZ2xlLnByb3RvYnVmLkVtcHR5Ek0KBXRvdGFsEhYuZ29vZ2xlLnByb3RvYnVmLkVtcHR5GiwueXVoYWlpbi5wcm90b3Muc3RhdGlzdGljLnNlcnZpY2UudG90YWxfZmxvdxJRCgZub3RpZnkSFi5nb29nbGUucHJvdG9idWYuRW1wdHkaLS55dWhhaWluLnByb3Rvcy5zdGF0aXN0aWMuc2VydmljZS5ub3RpZnlfZGF0YTABEl8KDmZhaWxlZF9oaXN0b3J5EhYuZ29vZ2xlLnByb3RvYnVmLkVtcHR5GjUueXVoYWlpbi5wcm90b3Muc3RhdGlzdGljLnNlcnZpY2UuZmFpbGVkX2hpc3RvcnlfbGlzdEI7WjlnaXRodWIuY29tL0FzdXRvcnVmYS95dWhhaWluL3BrZy9wcm90b3Mvc3RhdGlzdGljL3NlcnZpY2ViBnByb3RvMw",[t.t,c.L9,s.i]),u=(0,n.Z)(i,1),m=(0,n.Z)(i,3),r=(0,o.Z)(i,0)}},a=>{var d=d=>a(a.s=d);a.O(0,[295,995,515,920,637,354,340,734,723,424,306,145,698,441,517,358],()=>d(8438)),_N_E=a.O()}]);