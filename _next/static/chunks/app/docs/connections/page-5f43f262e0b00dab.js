(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8831],{9898:function(e,t,n){Promise.resolve().then(n.bind(n,4824))},798:function(e,t,n){"use strict";n.d(t,{$f:function(){return m},Mj:function(){return b},Ti:function(){return c},U9:function(){return p},XE:function(){return h},YO:function(){return d},Z5:function(){return r},dn:function(){return s},fG:function(){return a},gU:function(){return o},gW:function(){return g},q$:function(){return v},r:function(){return u},rQ:function(){return l}});var a="",l="https://clients3.google.com/generate_204",o="dns.nextdns.io:853",d=!0,c="http://ip.sb",r="stun.syncthing.net:3478",s="stun.nextcloud.com:443";let i=()=>{let e=localStorage.getItem("api_url");a=null!==e?e:"",e=localStorage.getItem("remote_bypass"),null!==(e=localStorage.getItem("latency_http_url"))&&(l=e),null!==(e=localStorage.getItem("latency_dns_url"))&&(o=e),null!==(e=localStorage.getItem("latency_ipv6"))&&(d="true"===e),null!==(e=localStorage.getItem("latency_ip_url"))&&(c=e),null!==(e=localStorage.getItem("latency_stun_url"))&&(r=e),null!==(e=localStorage.getItem("latency_stun_tcp_url"))&&(s=e)},u=e=>{x("api_url",e)},m=e=>{x("latency_dns_url",e)},h=e=>{x("latency_http_url",e)},g=e=>{x("latency_ipv6",e.toString())},p=e=>{x("latency_ip_url",e)},b=e=>{x("latency_stun_url",e)},v=e=>{x("latency_stun_tcp_url",e)},x=(e,t)=>{""===t?localStorage.removeItem(e):localStorage.setItem(e,t),i()};i()},6263:function(e,t,n){"use strict";var a=n(7437),l=n(279),o=n(914),d=n.n(o);t.Z=function(e){return(0,a.jsxs)("div",{className:"z-1090 d-flex flex-column justify-content-center align-items-center",style:{height:"100px"},children:[void 0!==e.children&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(d(),{className:"p2",statusCode:void 0!==e.code?e.code:500,title:e.children})}),(0,a.jsx)("div",{className:"p2",children:(0,a.jsx)(l.Z,{})})]})}},5594:function(e,t,n){"use strict";n.d(t,{D4:function(){return d},OV:function(){return c},Uo:function(){return r},o5:function(){return s}});var a=n(798),l=n(3334),o=n(4504);function d(e,t,n,d){return c=>d?(0,l.d)(e,d):fetch("".concat(a.fG).concat(c),{method:t,body:n}).then(async t=>{if(!t.ok)throw{code:t.status,msg:t.statusText,raw:t.text()};return(0,o.h4)(e,new Uint8Array(await t.arrayBuffer()))})}function c(e,t,n,l){return d=>fetch("".concat(a.fG).concat(d),{method:n,body:l}).then(async n=>{if(!n.ok)throw{code:n.status,msg:n.statusText,raw:n.text()};return t((0,o.h4)(e,new Uint8Array(await n.arrayBuffer())))})}let r=async(e,t)=>{let n=await fetch("".concat(a.fG).concat(e),{method:void 0!==t.method?t.method:"POST",body:t.body});return n.ok?void 0===t.process?{}:{data:t.process(n)}:{error:{code:n.status,msg:n.text()}}};function s(e,t,n){return(l,d)=>{let c,{next:r}=d,s=new URL(""!==a.fG?a.fG:window.location.toString());s.pathname=l,s.protocol="https:"===s.protocol?"wss:":"ws:";let i=!1,u=()=>{i||(console.log("connecting to: ".concat(s)),(c=new WebSocket(s)).binaryType="arraybuffer",c.addEventListener("open",t=>{console.log("connect to: ".concat(s,", event type: ").concat(t.type)),null==c||c.send(e)}),c.addEventListener("message",e=>{let a=(0,o.h4)(t,new Uint8Array(e.data));r(null,e=>n(e,a))}),c.addEventListener("error",e=>{let t="websocket have some error";r({msg:t,code:500}),console.log(t,e.type)}),c.addEventListener("close",e=>{console.log("websocket closed, code: "+e.code),r(null,void 0),i||(console.log("reconnect after 1 seconds"),setTimeout(u,1e3))}))};return u(),()=>{i=!0,void 0!==c&&(console.log("close: ".concat(l)),c.close(),c=void 0)}}}},4954:function(e,t,n){"use strict";n.d(t,{P:function(){return c},t:function(){return r}});var a=n(7437),l=n(2265),o=n(2230),d=n(6647);let c=(0,l.createContext)({Info:e=>{},Error:e=>{}}),r=e=>{let{children:t}=e,[n,r]=(0,l.useState)({value:{},index:0}),s=(e,t)=>r(n=>({value:{...n.value,[n.index]:{text:e,type:t}},index:n.index+1}));return(0,a.jsxs)(c.Provider,{value:{Info:e=>{console.log(e),s(e,"success")},Error:e=>{console.error(e),s(e,"danger")}},children:[(0,a.jsx)(o.Z,{className:"p-3",position:"top-center",containerPosition:"fixed",style:{zIndex:999999},children:Object.entries(n.value).map(e=>{let[t,l]=e;return(0,a.jsxs)(d.Z,{role:"alert","aria-live":"assertive",show:!0,bg:l.type,onClose:()=>{let e=n.value;delete e[t],r({...n,value:e}),console.log("close: "+t)},"aria-atomic":"true",delay:4e3,autohide:!0,animation:!0,children:[(0,a.jsxs)(d.Z.Header,{children:[(0,a.jsx)("strong",{className:"me-auto",children:"Notification"}),(0,a.jsx)("small",{className:"text-muted",children:"just now"})]}),(0,a.jsx)(d.Z.Body,{className:"text-center",children:l.text})]},"toast"+t)})}),t]})}},4824:function(e,t,n){"use strict";n.r(t);var a=n(7437),l=n(2265),o=n(9420),d=n(2510),c=n(8536),r=n(5767),s=n(4076),i=n(279),u=n(733),m=n(6263),h=n(5594),g=n(4954),p=n(8208),b=n(4266),v=n(9569),x=n(8560),f=n(5118),y=n(2854);let Z=(0,n(166).default)(()=>Promise.all([n.e(4122),n.e(611),n.e(6256),n.e(2722),n.e(2336),n.e(5e3),n.e(5438)]).then(n.bind(n,5e3)).then(e=>e.NodeModal),{loadableGenerated:{webpack:()=>[5e3]},ssr:!1}),w=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!+e)return"0B";let n=Math.floor(Math.log(e)/Math.log(1024)),a=parseFloat((e/Math.pow(1024,n)).toFixed(0>t?0:t)),l=["B","KB","MB","GB","TB","PB","EB","ZB","YB"][n];return isNaN(a)||void 0===l?"":"".concat(a).concat(l)},G=(e,t)=>{let n=(e.download-(t.download!==BigInt(0)?t.download:e.download))/BigInt(2),a=(e.upload-(t.upload!==BigInt(0)?t.upload:e.upload))/BigInt(2);return{download:"(".concat(w(Number(e.download)),"): ").concat(w(Number(n)),"/S"),upload:"(".concat(w(Number(e.upload)),"): ").concat(w(Number(a)),"/S")}},R=l.memo(e=>(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(d.Z.Item,{children:(0,a.jsxs)("div",{className:"d-sm-flex",children:[(0,a.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:e.itemKey}),(0,a.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:"Hash"!==e.itemKey?e.itemValue:(0,a.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),e.showModal(e.itemValue)},children:e.itemValue})})]})})})),j=l.memo(e=>{var t,n,o,u,m,f;let y=(0,l.useContext)(g.P),[Z,w]=(0,l.useState)(!1);return(0,a.jsxs)(c.Z.Item,{eventKey:e.data.id.toString(),children:[(0,a.jsx)(c.Z.Header,{children:(0,a.jsxs)("div",{className:"d-line text-break",children:[(0,a.jsx)("code",{className:"ms-2",children:e.data.id.toString()}),(0,a.jsx)("span",{className:"ms-2",children:e.data.addr}),(0,a.jsx)(r.Z,{className:"bg-light rounded-pill text-dark ms-1 text-uppercase",children:e.data.extra.MODE}),(0,a.jsx)(r.Z,{className:"bg-light rounded-pill text-dark ms-1 text-uppercase",children:p.dt[null!==(u=null===(t=e.data.type)||void 0===t?void 0:t.connType)&&void 0!==u?u:0]}),void 0!==e.data.extra.Tag&&(0,a.jsx)(r.Z,{className:"bg-light rounded-pill text-dark ms-1 text-uppercase",children:e.data.extra.Tag})]})}),(0,a.jsx)(c.Z.Body,{children:(0,a.jsxs)(d.Z,{variant:"flush",children:[(0,a.jsx)(R,{itemKey:"Type",itemValue:p.dt[null!==(m=null===(n=e.data.type)||void 0===n?void 0:n.connType)&&void 0!==m?m:0],showModal:e.showModal}),(0,a.jsx)(R,{itemKey:"Underlying",itemValue:p.dt[null!==(f=null===(o=e.data.type)||void 0===o?void 0:o.underlyingType)&&void 0!==f?f:0],showModal:e.showModal}),Object.entries(e.data.extra).sort((e,t)=>e<=t?-1:1).map(t=>{let[n,l]=t;return(0,a.jsx)(R,{itemKey:n,itemValue:l,showModal:e.showModal},n)}),(0,a.jsx)(d.Z.Item,{children:(0,a.jsx)("div",{className:"d-sm-flex",children:(0,a.jsxs)(s.Z,{variant:"outline-danger",className:"flex-grow-1 notranslate",disabled:Z,onClick:()=>{w(!0),(0,h.Uo)("/conn",{method:"DELETE",body:(0,v.O)(b.jz,(0,x.U)(b.jz,{ids:[e.data.id]}))}).then(async t=>{let{error:n}=t;n?(y.Error("code ".concat(e.data.id," failed, ").concat(n.code,"| ").concat(await n.msg)),w(!1)):setTimeout(()=>{w(!1)},5e3)})},children:["Close",Z&&(0,a.jsxs)(a.Fragment,{children:["\xa0",(0,a.jsx)(i.Z,{size:"sm",animation:"border",variant:"danger"})]})]})})})]})})]},e.data.id)});t.default=function(){let[e,t]=(0,l.useState)({show:!1,hash:""}),[n,r]=(0,l.useState)({download:BigInt(0),upload:BigInt(0)}),{data:s,error:i}=(0,f.ZP)("/flow/total",(0,h.OV)(b.Ei,e=>{let t=G(e,{download:n.download,upload:n.upload});return r({download:e.download,upload:e.upload}),t}),{refreshInterval:2e3}),{data:g,error:p}=(0,u.Z)("/conn",(0,h.o5)((0,v.O)(y.u,(0,x.U)(y.u)),b.TX,(e,t)=>{switch(void 0===e&&(e=new Map),t.data.case){case"notifyNewConnections":t.data.value.connections.sort((e,t)=>e.id>t.id?1:-1).forEach(t=>{e.set(t.id,t)});break;case"notifyRemoveConnections":t.data.value.ids.forEach(t=>{e.delete(t)})}return e}));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Z,{show:e.show,hash:e.hash,editable:!1,onHide:()=>t({hash:"",show:!1})}),(0,a.jsx)(o.Z,{className:"mb-3",children:(0,a.jsxs)(d.Z,{variant:"flush",children:[(0,a.jsx)(d.Z.Item,{children:(0,a.jsxs)("div",{className:"d-sm-flex",children:[(0,a.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Download"}),(0,a.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-download",children:s?s.download:void 0!==i?i.msg:"Loading..."})]})}),(0,a.jsx)(d.Z.Item,{children:(0,a.jsxs)("div",{className:"d-sm-flex",children:[(0,a.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Upload"}),(0,a.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-upload",children:s?s.upload:void 0!==i?i.msg:"Loading..."})]})})]})}),void 0!==p?(0,a.jsx)(m.Z,{code:p.code,children:p.msg}):void 0===g?(0,a.jsx)(m.Z,{}):(0,a.jsx)(c.Z,{className:"mb-3",alwaysOpen:!0,id:"connections",children:[...g.values()].reverse().map(e=>(0,a.jsx)(j,{data:e,showModal:e=>t({show:!0,hash:e})},e.id))})]})}},8208:function(e,t,n){"use strict";var a,l;n.d(t,{dt:function(){return a},rH:function(){return o}});let o=(0,n(7472).l)("ChZzdGF0aXN0aWMvY29uZmlnLnByb3RvEhF5dWhhaWluLnN0YXRpc3RpYyKEAQoIbmV0X3R5cGUSNQoJY29ubl90eXBlGAEgASgOMhcueXVoYWlpbi5zdGF0aXN0aWMudHlwZVIJY29ubl90eXBlEkEKD3VuZGVybHlpbmdfdHlwZRgCIAEoDjIXLnl1aGFpaW4uc3RhdGlzdGljLnR5cGVSD3VuZGVybHlpbmdfdHlwZSK4AQoKY29ubmVjdGlvbhIMCgRhZGRyGAEgASgJEgoKAmlkGAIgASgEEikKBHR5cGUYAyABKAsyGy55dWhhaWluLnN0YXRpc3RpYy5uZXRfdHlwZRI3CgVleHRyYRgEIAMoCzIoLnl1aGFpaW4uc3RhdGlzdGljLmNvbm5lY3Rpb24uRXh0cmFFbnRyeRosCgpFeHRyYUVudHJ5EgsKA2tleRgBIAEoCRINCgV2YWx1ZRgCIAEoCToCOAEqjwEKBHR5cGUSCwoHdW5rbm93bhAAEgcKA3RjcBABEggKBHRjcDQQAhIICgR0Y3A2EAMSBwoDdWRwEAQSCAoEdWRwNBAFEggKBHVkcDYQBhIGCgJpcBAHEgcKA2lwNBAIEgcKA2lwNhAJEggKBHVuaXgQChIMCgh1bml4Z3JhbRALEg4KCnVuaXhwYWNrZXQQDEIzWjFnaXRodWIuY29tL0FzdXRvcnVmYS95dWhhaWluL3BrZy9wcm90b3Mvc3RhdGlzdGljYgZwcm90bzM");(l=a||(a={}))[l.unknown=0]="unknown",l[l.tcp=1]="tcp",l[l.tcp4=2]="tcp4",l[l.tcp6=3]="tcp6",l[l.udp=4]="udp",l[l.udp4=5]="udp4",l[l.udp6=6]="udp6",l[l.ip=7]="ip",l[l.ip4=8]="ip4",l[l.ip6=9]="ip6",l[l.unix=10]="unix",l[l.unixgram=11]="unixgram",l[l.unixpacket=12]="unixpacket"},4266:function(e,t,n){"use strict";n.d(t,{Ei:function(){return s},TX:function(){return i},jz:function(){return u},xB:function(){return m}});var a=n(7472),l=n(5369),o=n(2854),d=n(1074),c=n(8208);let r=(0,a.l)("ChtzdGF0aXN0aWMvZ3JwYy9jb25maWcucHJvdG8SIHl1aGFpaW4ucHJvdG9zLnN0YXRpc3RpYy5zZXJ2aWNlIi4KCnRvdGFsX2Zsb3cSEAoIZG93bmxvYWQYASABKAQSDgoGdXBsb2FkGAIgASgEIpcCCgtub3RpZnlfZGF0YRJCCgp0b3RhbF9mbG93GAMgASgLMiwueXVoYWlpbi5wcm90b3Muc3RhdGlzdGljLnNlcnZpY2UudG90YWxfZmxvd0gAEloKFm5vdGlmeV9uZXdfY29ubmVjdGlvbnMYASABKAsyOC55dWhhaWluLnByb3Rvcy5zdGF0aXN0aWMuc2VydmljZS5ub3RpZnlfbmV3X2Nvbm5lY3Rpb25zSAASYAoZbm90aWZ5X3JlbW92ZV9jb25uZWN0aW9ucxgCIAEoCzI7Lnl1aGFpaW4ucHJvdG9zLnN0YXRpc3RpYy5zZXJ2aWNlLm5vdGlmeV9yZW1vdmVfY29ubmVjdGlvbnNIAEIGCgRkYXRhIkwKFm5vdGlmeV9uZXdfY29ubmVjdGlvbnMSMgoLY29ubmVjdGlvbnMYASADKAsyHS55dWhhaWluLnN0YXRpc3RpYy5jb25uZWN0aW9uIigKGW5vdGlmeV9yZW1vdmVfY29ubmVjdGlvbnMSCwoDaWRzGAEgAygEIp4BCg5mYWlsZWRfaGlzdG9yeRIQCghwcm90b2NvbBgBIAEoCRIMCgRob3N0GAIgASgJEg0KBWVycm9yGAMgASgJEg8KB3Byb2Nlc3MYBCABKAkSKAoEdGltZRgFIAEoCzIaLmdvb2dsZS5wcm90b2J1Zi5UaW1lc3RhbXASIgoMZmFpbGVkX2NvdW50GAYgASgEUgxmYWlsZWRfY291bnQijAEKE2ZhaWxlZF9oaXN0b3J5X2xpc3QSQQoHb2JqZWN0cxgBIAMoCzIwLnl1aGFpaW4ucHJvdG9zLnN0YXRpc3RpYy5zZXJ2aWNlLmZhaWxlZF9oaXN0b3J5EjIKFGR1bXBfcHJvY2Vzc19lbmFibGVkGAIgASgIUhRkdW1wX3Byb2Nlc3NfZW5hYmxlZDLOAwoLY29ubmVjdGlvbnMSWQoFY29ubnMSFi5nb29nbGUucHJvdG9idWYuRW1wdHkaOC55dWhhaWluLnByb3Rvcy5zdGF0aXN0aWMuc2VydmljZS5ub3RpZnlfbmV3X2Nvbm5lY3Rpb25zEmEKCmNsb3NlX2Nvbm4SOy55dWhhaWluLnByb3Rvcy5zdGF0aXN0aWMuc2VydmljZS5ub3RpZnlfcmVtb3ZlX2Nvbm5lY3Rpb25zGhYuZ29vZ2xlLnByb3RvYnVmLkVtcHR5Ek0KBXRvdGFsEhYuZ29vZ2xlLnByb3RvYnVmLkVtcHR5GiwueXVoYWlpbi5wcm90b3Muc3RhdGlzdGljLnNlcnZpY2UudG90YWxfZmxvdxJRCgZub3RpZnkSFi5nb29nbGUucHJvdG9idWYuRW1wdHkaLS55dWhhaWluLnByb3Rvcy5zdGF0aXN0aWMuc2VydmljZS5ub3RpZnlfZGF0YTABEl8KDmZhaWxlZF9oaXN0b3J5EhYuZ29vZ2xlLnByb3RvYnVmLkVtcHR5GjUueXVoYWlpbi5wcm90b3Muc3RhdGlzdGljLnNlcnZpY2UuZmFpbGVkX2hpc3RvcnlfbGlzdEI7WjlnaXRodWIuY29tL0FzdXRvcnVmYS95dWhhaWluL3BrZy9wcm90b3Mvc3RhdGlzdGljL3NlcnZpY2ViBnByb3RvMw",[o.r,c.rH,d.K]),s=(0,l.L)(r,0),i=(0,l.L)(r,1),u=(0,l.L)(r,3),m=(0,l.L)(r,5)}},function(e){e.O(0,[7439,5118,5982,1253,6537,8561,2971,2117,1744],function(){return e(e.s=9898)}),_N_E=e.O()}]);