(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4001],{17124:(e,t,s)=>{"use strict";function n(e){var t;return new Date(1e3*Number((t=e).seconds)+Math.round(t.nanos/1e6))}s.d(t,{FP:()=>n})},30504:(e,t,s)=>{"use strict";s.d(t,{A:()=>d});var n=s(85203),l=s.n(n),a=s(12115),i=s(83935),r=s(95155);let o=a.forwardRef((e,t)=>{let{bsPrefix:s,bg:n="primary",pill:a=!1,text:o,className:d,as:c="span",...u}=e,m=(0,i.oU)(s,"badge");return(0,r.jsx)(c,{ref:t,...u,className:l()(d,m,a&&"rounded-pill",o&&"text-".concat(o),n&&"bg-".concat(n))})});o.displayName="Badge";let d=o},41143:(e,t,s)=>{"use strict";s.d(t,{TH:()=>j,c5:()=>g,gW:()=>x,z3:()=>v});var n=s(95155),l=s(12115),a=s(18403),i=s(30504),r=s(85387),o=s(46512),d=s(46057),c=s(48603),u=s(59115),m=s(48948),h=s(99401);let x=e=>{let{itemKey:t,itemValue:s}=e;return""==s?(0,n.jsx)(n.Fragment,{}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(a.A.Item,{children:(0,n.jsxs)("div",{className:"d-sm-flex",children:[(0,n.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-capitalize",children:t}),(0,n.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:s})]})})})},j=e=>{var t,s;let{value:r,startContent:o,endContent:d}=e,[h,j]=(0,l.useState)({show:!1,hash:""}),p=(0,l.useCallback)(e=>{j({show:!0,hash:e})},[j]),v=(0,l.useCallback)(()=>{j(e=>({...e,show:!1}))},[j]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.y,{show:h.show,hash:h.hash,editable:!1,onHide:v}),(0,n.jsxs)(a.A,{variant:"flush",className:"w-100 p-2",children:[o,(0,n.jsx)(x,{itemKey:"Id",itemValue:r.id.toString()}),(0,n.jsx)(x,{itemKey:"Addr",itemValue:r.addr}),(0,n.jsx)(x,{itemKey:"Type",itemValue:m.NW[null==(t=r.type)?void 0:t.connType]}),(0,n.jsx)(x,{itemKey:"UnderlyingType",itemValue:m.NW[null==(s=r.type)?void 0:s.underlyingType]}),(0,n.jsx)(x,{itemKey:"Inbound",itemValue:r.inboundName}),(0,n.jsx)(x,{itemKey:"InboundAddr",itemValue:r.inbound}),(0,n.jsx)(x,{itemKey:"Source",itemValue:r.source}),(0,n.jsx)(x,{itemKey:"Outbound",itemValue:r.outbound}),(0,n.jsx)(x,{itemKey:"LocalAddr",itemValue:r.localAddr}),(0,n.jsx)(x,{itemKey:"Destination",itemValue:r.destionation}),(0,n.jsx)(x,{itemKey:"FakeIP",itemValue:r.fakeIp}),(0,n.jsx)(x,{itemKey:"Hosts",itemValue:r.hosts}),(0,n.jsx)(x,{itemKey:"Domain",itemValue:r.domain}),(0,n.jsx)(x,{itemKey:"IP",itemValue:r.ip}),(0,n.jsx)(x,{itemKey:"Tag",itemValue:r.tag}),(r.nodeName||r.hash)&&(0,n.jsx)(a.A.Item,{children:(0,n.jsxs)("div",{className:"d-sm-flex",children:[(0,n.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-capitalize",children:"Point"}),(0,n.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:(0,n.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),p(r.hash)},children:r.nodeName?r.nodeName:r.hash})})]})}),(0,n.jsx)(x,{itemKey:"Protocol",itemValue:r.protocol}),(0,n.jsx)(x,{itemKey:"Process",itemValue:r.process}),(0,n.jsx)(x,{itemKey:"TlsServerName",itemValue:r.tlsServerName}),(0,n.jsx)(x,{itemKey:"HttpHost",itemValue:r.httpHost}),(0,n.jsx)(x,{itemKey:"Component",itemValue:r.component}),(0,n.jsx)(x,{itemKey:"Mode",itemValue:u.Mq[r.mode]}),(0,n.jsx)(x,{itemKey:"UdpMigrateId",itemValue:r.udpMigrateId?r.udpMigrateId.toString():""}),(0,n.jsx)(x,{itemKey:"Pid",itemValue:r.pid?r.pid.toString():""}),(0,n.jsx)(x,{itemKey:"Uid",itemValue:r.uid?r.uid.toString():""}),r.matchHistory&&r.matchHistory.length>0&&(0,n.jsx)(a.A.Item,{children:(0,n.jsxs)("div",{className:"d-sm-flex",children:[(0,n.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-capitalize",children:"MatchHistory"}),(0,n.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:r.matchHistory.map((e,t)=>(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,n.jsx)("div",{style:{flex:1,height:"1px",background:"black"}}),(0,n.jsx)("span",{children:(0,n.jsx)("b",{children:e.ruleName})}),(0,n.jsx)("div",{style:{flex:1,height:"1px",background:"black"}})]}),(0,n.jsx)("div",{className:"mt-2 mb-2",children:e.history&&e.history.map((e,t)=>(0,n.jsx)("div",{children:(0,n.jsxs)("div",{children:[e.matched?(0,n.jsx)(i.A,{bg:"success",children:"Hit"}):(0,n.jsx)(i.A,{bg:"danger",children:"Miss"})," ",e.listName]})},"list-"+e.listName+t))})]},"rule-"+e.ruleName+t))})]})}),d]})]})},p={B:"B",KB:"KB",MB:"MB",GB:"GB",TB:"TB",PB:"PB"},v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,{bytes:s,unit:n}=e>=0x4000000000000?{bytes:e/0x4000000000000,unit:p.PB}:e>=0x10000000000?{bytes:e/0x10000000000,unit:p.TB}:e>=0x40000000?{bytes:e/0x40000000,unit:p.GB}:e>=1048576?{bytes:e/1048576,unit:p.MB}:e>=1024?{bytes:e/1024,unit:p.KB}:{bytes:e,unit:p.B};return"".concat(s.toFixed(t)).concat(n)};class b{DownloadString(){let e=v(this.download),t=v(this.download_rate)+"/S";return"(".concat(e,"): ").concat(t)}UploadString(){let e=v(this.upload),t=v(this.upload_rate)+"/S";return"(".concat(e,"): ").concat(t)}constructor(e=0,t=0,s=0,n=0,l={}){this.download=e,this.download_rate=t,this.upload=s,this.upload_rate=n,this.counters=l,this.time=new Date}}let y=e=>{let{lastFlow:t,flow_error:s,end_content:l}=e;return(0,n.jsx)(r.A,{className:"mb-3",children:(0,n.jsxs)(a.A,{variant:"flush",children:[(0,n.jsx)(a.A.Item,{children:(0,n.jsxs)("div",{className:"d-sm-flex",children:[(0,n.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Download"}),(0,n.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-download",children:s?s.msg:t?t.DownloadString():"Loading..."})]})}),(0,n.jsx)(a.A.Item,{children:(0,n.jsxs)("div",{className:"d-sm-flex",children:[(0,n.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Upload"}),(0,n.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-upload",children:s?s.msg:t?t.UploadString():"Loading..."})]})}),l]})})},g=l.memo(e=>{let{onUpdate:t,end_content:s}=e,{data:a,error:i}=(()=>{let[e,t]=(0,l.useState)(new b(0,0,0,0,{}));return(0,o.Ay)((0,d.cY)(h.oQ.method.total),async()=>(0,d.kP)(h.oQ.method.total).then(async s=>{let{data:n,error:l}=s;if(l)throw l;if(n)try{let s=((e,t)=>{let s=(new Date().getTime()-t.time.getTime())/1e3;if((0!==t.download||0!==t.upload)&&0!==s){let n=Number(e.download),l=Number(e.upload);return{download_rate:n>t.download?(n-t.download)/s:0,upload_rate:l>t.upload?(l-t.upload)/s:0}}return{download_rate:0,upload_rate:0}})(n,e),l=new b(Number(n.download),s.download_rate,Number(n.upload),s.upload_rate,n.counters);return t(l),l}catch(e){throw{msg:e.toString(),code:500}}}),{refreshInterval:2e3})})();return(0,l.useEffect)(()=>{t&&a&&t(a.counters)},[t,a]),(0,n.jsx)(y,{lastFlow:a,flow_error:i,end_content:s})})},46781:(e,t,s)=>{Promise.resolve().then(s.bind(s,87385))},80859:(e,t,s)=>{"use strict";s.d(t,{A:()=>d});var n=s(85203),l=s.n(n),a=s(12115),i=s(83935),r=s(95155);let o=a.forwardRef((e,t)=>{let{bsPrefix:s,className:n,striped:a,bordered:o,borderless:d,hover:c,size:u,variant:m,responsive:h,...x}=e,j=(0,i.oU)(s,"table"),p=l()(n,j,m&&"".concat(j,"-").concat(m),u&&"".concat(j,"-").concat(u),a&&"".concat(j,"-").concat("string"==typeof a?"striped-".concat(a):"striped"),o&&"".concat(j,"-bordered"),d&&"".concat(j,"-borderless"),c&&"".concat(j,"-hover")),v=(0,r.jsx)("table",{...x,className:p,ref:t});if(h){let e="".concat(j,"-responsive");return"string"==typeof h&&(e="".concat(e,"-").concat(h)),(0,r.jsx)("div",{className:e,children:v})}return v});o.displayName="Table";let d=o},84396:(e,t,s)=>{"use strict";s.d(t,{i:()=>a,w:()=>i});var n=s(21863),l=s(80276);let a=(0,n.w)("Ch9nb29nbGUvcHJvdG9idWYvdGltZXN0YW1wLnByb3RvEg9nb29nbGUucHJvdG9idWYiKwoJVGltZXN0YW1wEg8KB3NlY29uZHMYASABKAMSDQoFbmFub3MYAiABKAVChQEKE2NvbS5nb29nbGUucHJvdG9idWZCDlRpbWVzdGFtcFByb3RvUAFaMmdvb2dsZS5nb2xhbmcub3JnL3Byb3RvYnVmL3R5cGVzL2tub3duL3RpbWVzdGFtcHBi+AEBogIDR1BCqgIeR29vZ2xlLlByb3RvYnVmLldlbGxLbm93blR5cGVzYgZwcm90bzM"),i=(0,l.Z)(a,0)},86734:e=>{e.exports={clickable:"clickable_clickable__ytaUf"}},87385:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>A});var n=s(95155),l=s(47319),a=s(84396),i=s(17124),r=s(12115),o=s(87869),d=s(18403),c=s(65117),u=s(30641),m=s(63196),h=s(65442),x=s(80859),j=s(86734),p=s.n(j),v=s(50379),b=s(99305),y=s(46057),g=s(48948),N=s(99401),f=s(41143);let w=(0,l.v)(a.w,{seconds:BigInt(0),nanos:0}),A=function(){var e,t,s,a,j,A;let[k,K]=(0,r.useState)("Time"),[V,C]=(0,r.useState)(1),B=(0,r.useCallback)(function(e,t){return e>t?-1*V:+V},[V]),S=e=>(0,n.jsxs)("th",{className:p().clickable,onClick:()=>e===k?C(-V):K(e),children:[e,e===k?(0,n.jsx)("i",{className:-1===V?"bi bi-sort-up-alt":"bi bi-sort-down-alt"}):(0,n.jsx)(n.Fragment,{})]}),P=(0,r.useCallback)((e,t)=>{var s,n,l,a,r,o;return"Host"===k?B(null==(s=e.connection)?void 0:s.addr,null==(n=t.connection)?void 0:n.addr):"Proc"===k?B(null==(l=e.connection)?void 0:l.process,null==(a=t.connection)?void 0:a.process):"Count"===k?B(e.count,t.count):B((0,i.FP)(null!=(r=e.time)?r:w),(0,i.FP)(null!=(o=t.time)?o:w))},[k,B]),[F,I]=(0,r.useState)(""),[_,H]=(0,r.useState)(""),[M,T]=(0,r.useState)(g.NW.unknown),[L,W]=(0,r.useState)(1),[G,R]=(0,r.useState)({show:!1}),{data:E,error:U,isLoading:z,isValidating:D,mutate:Y}=(0,y.mp)(N.oQ.method.all_history),Z=(0,r.useMemo)(()=>{var e;return null==E||null==(e=E.objects)?void 0:e.filter(e=>{var t,s,n,l;return!!e.time&&(!M||(null==(s=e.connection)||null==(t=s.type)?void 0:t.connType)===M)&&(!F||(null==(n=e.connection.addr)?void 0:n.toLowerCase().includes(F))||(null==(l=e.connection.process)?void 0:l.toLowerCase().includes(F)))}).sort(P)},[E,F,M,P]);return U?(0,n.jsx)(v.A,{code:U.code,children:U.msg}):z||void 0===E?(0,n.jsx)(v.A,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.A,{centered:!0,show:G.show,onHide:()=>R(e=>({...e,show:!1})),children:(0,n.jsx)(o.A.Body,{children:(0,n.jsx)(f.TH,{value:null!=(a=null==(e=G.data)?void 0:e.connection)?a:(0,l.v)(g.mR,{}),startContent:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.gW,{itemKey:"Count",itemValue:null!=(j=null==(t=G.data)?void 0:t.count.toString())?j:"1"}),(0,n.jsx)(f.gW,{itemKey:"Time",itemValue:(0,i.FP)(null!=(A=null==(s=G.data)?void 0:s.time)?A:w).toLocaleString()})]}),endContent:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(d.A.Item,{className:"d-sm-flex justify-content-center",children:(0,n.jsx)(c.A,{variant:"outline-primary",className:"flex-grow-1",onClick:()=>R(e=>({...e,show:!1})),children:"Close"})})})})})}),(0,n.jsx)("div",{className:"d-flex",children:(0,n.jsxs)("div",{className:"d-flex align-items-center gap-2 mb-3 ms-auto flex-wrap",children:[(0,n.jsx)("span",{className:"d-flex align-items-center gap-2",children:(0,n.jsxs)(u.A,{children:[(0,n.jsx)(m.A.Control,{value:_,onChange:e=>H(e.target.value)}),(0,n.jsx)(c.A,{onClick:()=>{I(_.toLowerCase())},children:(0,n.jsx)("i",{className:"bi bi-funnel"})})]})}),(0,n.jsx)("span",{className:"d-flex align-items-center gap-2",children:(0,n.jsx)("select",{className:"form-select",value:M,onChange:e=>T(Number(e.target.value)),style:{width:130},children:g.m9.values.map(e=>(0,n.jsx)("option",{value:e.number,children:0===e.number?"all":e.name},e.number))})}),(0,n.jsxs)(c.A,{variant:"outline-primary",onClick:()=>Y(),disabled:D||z,children:[(0,n.jsx)("i",{className:"bi bi-arrow-clockwise"}),(D||z)&&(0,n.jsxs)(n.Fragment,{children:["\xa0",(0,n.jsx)(h.A,{size:"sm",animation:"border"})]})]})]})}),(0,n.jsx)(b.W,{currentPage:L,totalItems:Z.length,pageSize:30,onPageChange:e=>{W(e)}}),(0,n.jsxs)(x.A,{hover:!0,striped:!0,size:"sm",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Index"}),S("Time"),S("Host"),(0,n.jsx)("th",{children:"Mode"}),(0,n.jsx)("th",{children:"Net"}),S("Count"),E.dumpProcessEnabled&&S("Proc")]})}),(0,n.jsx)("tbody",{className:"text-break",children:Z.slice((L-1)*30,(L-1)*30+30).map((e,t)=>{var s,l,a,r,o,d;return(0,n.jsxs)("tr",{onClick:()=>R({show:!0,data:e}),children:[(0,n.jsx)("td",{children:t+(L-1)*30+1}),(0,n.jsx)("td",{children:(0,i.FP)(e.time).toLocaleString()}),(0,n.jsx)("td",{children:null==(s=e.connection)?void 0:s.addr}),(0,n.jsx)("td",{children:null==(l=e.connection)?void 0:l.mode}),(0,n.jsx)("td",{children:g.NW[null!=(d=null==(r=e.connection)||null==(a=r.type)?void 0:a.connType)?d:g.NW.unknown]}),(0,n.jsx)("td",{children:Number(e.count)}),E.dumpProcessEnabled&&(0,n.jsx)("td",{children:null==(o=e.connection)?void 0:o.process})]},"bh-"+t)})})]})]})}},90322:(e,t,s)=>{"use strict";s.d(t,{A:()=>v});var n=s(85203),l=s.n(n),a=s(12115),i=s(83935),r=s(50870),o=s(95155);let d=a.forwardRef((e,t)=>{let{active:s=!1,disabled:n=!1,className:a,style:i,activeLabel:d="(current)",children:c,linkStyle:u,linkClassName:m,as:h=r.A,...x}=e,j=s||n?"span":h;return(0,o.jsx)("li",{ref:t,style:i,className:l()(a,"page-item",{active:s,disabled:n}),children:(0,o.jsxs)(j,{className:l()("page-link",m),style:u,...x,children:[c,s&&d&&(0,o.jsx)("span",{className:"visually-hidden",children:d})]})})});function c(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=a.forwardRef((e,n)=>{let{children:l,...a}=e;return(0,o.jsxs)(d,{...a,ref:n,children:[(0,o.jsx)("span",{"aria-hidden":"true",children:l||t}),(0,o.jsx)("span",{className:"visually-hidden",children:s})]})});return n.displayName=e,n}d.displayName="PageItem";let u=c("First","\xab"),m=c("Prev","‹","Previous"),h=c("Ellipsis","…","More"),x=c("Next","›"),j=c("Last","\xbb"),p=a.forwardRef((e,t)=>{let{bsPrefix:s,className:n,size:a,...r}=e,d=(0,i.oU)(s,"pagination");return(0,o.jsx)("ul",{ref:t,...r,className:l()(n,d,a&&"".concat(d,"-").concat(a))})});p.displayName="Pagination";let v=Object.assign(p,{First:u,Prev:m,Ellipsis:h,Item:d,Next:x,Last:j})},99305:(e,t,s)=>{"use strict";s.d(t,{W:()=>a});var n=s(95155),l=s(90322);function a(e){let{currentPage:t,totalItems:s,pageSize:a,onPageChange:i}=e,r=Math.ceil(s/a),o=[];if(r<=7)for(let e=1;e<=r;e++)o.push(e);else if(t<=4){for(let e=1;e<=5;e++)o.push(e);o.push("ellipsis"),o.push(r)}else if(t>=r-2-1){o.push(1),o.push("ellipsis");for(let e=r-5+1;e<=r;e++)o.push(e)}else{o.push(1),o.push("ellipsis");for(let e=t-1;e<=t+1;e++)o.push(e);o.push("ellipsis"),o.push(r)}return(0,n.jsx)("div",{className:"text-center",children:(0,n.jsxs)(l.A,{className:"justify-content-center d-inline-flex",children:[(0,n.jsx)(l.A.Prev,{onClick:()=>i(t-1),disabled:1===t}),o.map((e,s)=>"ellipsis"===e?(0,n.jsx)(l.A.Ellipsis,{disabled:!0},"e"+s):(0,n.jsx)(l.A.Item,{active:e===t,onClick:()=>i(e),children:e},e)),(0,n.jsx)(l.A.Next,{onClick:()=>i(t+1),disabled:t===r})]})})}}},e=>{e.O(0,[2941,9354,9717,91,4298,857,8555,5078,8076,7679,5187,4539,6164,8603,9401,8441,1255,7358],()=>e(e.s=46781)),_N_E=e.O()}]);