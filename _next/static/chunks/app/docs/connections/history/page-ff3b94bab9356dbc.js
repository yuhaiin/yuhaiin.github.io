(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4001],{5717:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var s=n(29300),a=n.n(s),i=n(12115),l=n(97390),o=n(95155);let d=i.forwardRef((e,t)=>{let{bsPrefix:n,bg:s="primary",pill:i=!1,text:d,className:r,as:c="span",...m}=e,u=(0,l.oU)(n,"badge");return(0,o.jsx)(c,{ref:t,...m,className:a()(r,u,i&&"rounded-pill",d&&"text-".concat(d),s&&"bg-".concat(s))})});d.displayName="Badge";let r=d},26506:(e,t,n)=>{"use strict";n.d(t,{TH:()=>j,c5:()=>w,gW:()=>x,z3:()=>p});var s=n(95155),a=n(12115),i=n(69056),l=n(5717),o=n(76355),d=n(19169),r=n(98508),c=n(87494),m=n(29940),u=n(70715),h=n(3384);let x=e=>{let{itemKey:t,itemValue:n}=e;return""==n?(0,s.jsx)(s.Fragment,{}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(i.A.Item,{children:(0,s.jsxs)("div",{className:"d-sm-flex",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-capitalize",children:t}),(0,s.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:n})]})})})},j=e=>{var t,n;let{value:o,startContent:d,endContent:r}=e,[h,j]=(0,a.useState)({show:!1,hash:""}),b=(0,a.useCallback)(e=>{j({show:!0,hash:e})},[j]),p=(0,a.useCallback)(()=>{j(e=>({...e,show:!1}))},[j]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.y,{show:h.show,hash:h.hash,editable:!1,onHide:p}),(0,s.jsxs)(i.A,{variant:"flush",className:"w-100 p-2",children:[d,(0,s.jsx)(x,{itemKey:"Id",itemValue:o.id.toString()}),(0,s.jsx)(x,{itemKey:"Addr",itemValue:o.addr}),(0,s.jsx)(x,{itemKey:"Type",itemValue:u.NW[null==(t=o.type)?void 0:t.connType]}),(0,s.jsx)(x,{itemKey:"UnderlyingType",itemValue:u.NW[null==(n=o.type)?void 0:n.underlyingType]}),(0,s.jsx)(x,{itemKey:"Inbound",itemValue:o.inboundName}),(0,s.jsx)(x,{itemKey:"InboundAddr",itemValue:o.inbound}),(0,s.jsx)(x,{itemKey:"Source",itemValue:o.source}),(0,s.jsx)(x,{itemKey:"Outbound",itemValue:o.outbound}),(0,s.jsx)(x,{itemKey:"LocalAddr",itemValue:o.localAddr}),(0,s.jsx)(x,{itemKey:"Destination",itemValue:o.destionation}),(0,s.jsx)(x,{itemKey:"FakeIP",itemValue:o.fakeIp}),(0,s.jsx)(x,{itemKey:"Hosts",itemValue:o.hosts}),(0,s.jsx)(x,{itemKey:"Domain",itemValue:o.domain}),(0,s.jsx)(x,{itemKey:"IP",itemValue:o.ip}),(0,s.jsx)(x,{itemKey:"Tag",itemValue:o.tag}),(0,s.jsx)(i.A.Item,{children:(0,s.jsxs)("div",{className:"d-sm-flex",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-capitalize",children:"Point"}),(0,s.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:(0,s.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),b(o.hash)},children:o.nodeName?o.nodeName:o.hash})})]})}),(0,s.jsx)(x,{itemKey:"Protocol",itemValue:o.protocol}),(0,s.jsx)(x,{itemKey:"Process",itemValue:o.process}),(0,s.jsx)(x,{itemKey:"TlsServerName",itemValue:o.tlsServerName}),(0,s.jsx)(x,{itemKey:"HttpHost",itemValue:o.httpHost}),(0,s.jsx)(x,{itemKey:"Component",itemValue:o.component}),(0,s.jsx)(x,{itemKey:"Mode",itemValue:m.Mq[o.mode]}),(0,s.jsx)(x,{itemKey:"UdpMigrateId",itemValue:o.udpMigrateId?o.udpMigrateId.toString():""}),(0,s.jsx)(x,{itemKey:"Pid",itemValue:o.pid?o.pid.toString():""}),(0,s.jsx)(x,{itemKey:"Uid",itemValue:o.uid?o.uid.toString():""}),o.matchHistory&&o.matchHistory.length>0&&(0,s.jsx)(i.A.Item,{children:(0,s.jsxs)("div",{className:"d-sm-flex",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-capitalize",children:"MatchHistory"}),(0,s.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:o.matchHistory.map((e,t)=>(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,s.jsx)("div",{style:{flex:1,height:"1px",background:"black"}}),(0,s.jsx)("span",{children:(0,s.jsx)("b",{children:e.ruleName})}),(0,s.jsx)("div",{style:{flex:1,height:"1px",background:"black"}})]}),(0,s.jsx)("div",{className:"mt-2 mb-2",children:e.history&&e.history.map((e,t)=>(0,s.jsx)("div",{children:(0,s.jsxs)("div",{children:[e.matched?(0,s.jsx)(l.A,{bg:"success",children:"Hit"}):(0,s.jsx)(l.A,{bg:"danger",children:"Miss"})," ",e.listName]})},"list-"+e.listName+t))})]},"rule-"+e.ruleName+t))})]})}),r]})]})},b={B:"B",KB:"KB",MB:"MB",GB:"GB",TB:"TB",PB:"PB"},p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,{bytes:n,unit:s}=e>=0x4000000000000?{bytes:e/0x4000000000000,unit:b.PB}:e>=0x10000000000?{bytes:e/0x10000000000,unit:b.TB}:e>=0x40000000?{bytes:e/0x40000000,unit:b.GB}:e>=1048576?{bytes:e/1048576,unit:b.MB}:e>=1024?{bytes:e/1024,unit:b.KB}:{bytes:e,unit:b.B};return"".concat(n.toFixed(t)).concat(s)};class y{DownloadString(){let e=p(this.download),t=p(this.download_rate)+"/S";return"(".concat(e,"): ").concat(t)}UploadString(){let e=p(this.upload),t=p(this.upload_rate)+"/S";return"(".concat(e,"): ").concat(t)}constructor(e=0,t=0,n=0,s=0,a={}){this.download=e,this.download_rate=t,this.upload=n,this.upload_rate=s,this.counters=a,this.time=new Date}}let v=(e,t)=>{let n=(new Date().getTime()-t.time.getTime())/1e3,s=0,a=0;if((0!==t.download||0!==t.upload)&&0!==n){let i=Number(e.download),l=Number(e.upload);s=(i-t.download)/n,a=(l-t.upload)/n}return{download_rate:s,upload_rate:a}},g=()=>{let[e,t]=(0,a.useState)(new y(0,0,0,0,{}));return(0,d.Ay)((0,r.cY)(h.oQ.method.total),async()=>(0,r.kP)(h.oQ.method.total).then(async n=>{let{data:s,error:a}=n;if(a)throw a;if(s)try{let n=v(s,e),a=new y(Number(s.download),n.download_rate,Number(s.upload),n.upload_rate,s.counters);return t(a),a}catch(e){throw{msg:e.toString(),code:500}}}),{refreshInterval:2e3})},N=e=>{let{lastFlow:t,flow_error:n,end_content:a}=e;return(0,s.jsx)(o.A,{className:"mb-3",children:(0,s.jsxs)(i.A,{variant:"flush",children:[(0,s.jsx)(i.A.Item,{children:(0,s.jsxs)("div",{className:"d-sm-flex",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Download"}),(0,s.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-download",children:n?n.msg:t?t.DownloadString():"Loading..."})]})}),(0,s.jsx)(i.A.Item,{children:(0,s.jsxs)("div",{className:"d-sm-flex",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Upload"}),(0,s.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-upload",children:n?n.msg:t?t.UploadString():"Loading..."})]})}),a]})})},w=a.memo(e=>{let{onUpdate:t,end_content:n}=e,{data:i,error:l}=g();return(0,a.useEffect)(()=>{t&&i&&t(i.counters)},[t,i]),(0,s.jsx)(N,{lastFlow:i,flow_error:l,end_content:n})})},46781:(e,t,n)=>{Promise.resolve().then(n.bind(n,99544))},50700:e=>{e.exports={clickable:"clickable_clickable__ytaUf"}},60926:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var s=n(29300),a=n.n(s),i=n(12115),l=n(97390),o=n(95155);let d=i.forwardRef((e,t)=>{let{bsPrefix:n,className:s,striped:i,bordered:d,borderless:r,hover:c,size:m,variant:u,responsive:h,...x}=e,j=(0,l.oU)(n,"table"),b=a()(s,j,u&&"".concat(j,"-").concat(u),m&&"".concat(j,"-").concat(m),i&&"".concat(j,"-").concat("string"==typeof i?"striped-".concat(i):"striped"),d&&"".concat(j,"-bordered"),r&&"".concat(j,"-borderless"),c&&"".concat(j,"-hover")),p=(0,o.jsx)("table",{...x,className:b,ref:t});if(h){let e="".concat(j,"-responsive");return"string"==typeof h&&(e="".concat(e,"-").concat(h)),(0,o.jsx)("div",{className:e,children:p})}return p});d.displayName="Table";let r=d},77849:(e,t,n)=>{"use strict";function s(e){var t;return new Date(1e3*Number((t=e).seconds)+Math.ceil(t.nanos/1e6))}n.d(t,{FP:()=>s})},99544:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>N});var s=n(95155),a=n(20960),i=n(99695),l=n(77849),o=n(12115),d=n(28468),r=n(69056),c=n(60902),m=n(91867),u=n(60926),h=n(50700),x=n.n(h),j=n(74086),b=n(98508),p=n(70715),y=n(3384),v=n(26506);let g=(0,a.v)(i.w,{seconds:BigInt(0),nanos:0}),N=function(){var e,t,n,i,h,N,w;let[f,A]=(0,o.useState)("Time"),[K,V]=(0,o.useState)(1),B=e=>e===f?V(-K):A(e),k=e=>e===f?(0,s.jsx)("i",{className:-1===K?"bi bi-sort-up-alt":"bi bi-sort-down-alt"}):(0,s.jsx)(s.Fragment,{});function S(e,t){return e>t?-1*K:+K}let F=e=>(0,s.jsxs)("th",{className:x().clickable,onClick:()=>B(e),children:[e,k(e)]}),[C,H]=(0,o.useState)({show:!1}),{data:P,error:_,isLoading:I,isValidating:T,mutate:M}=(0,b.mp)(y.oQ.method.all_history);return _?(0,s.jsx)(j.A,{code:_.code,children:_.msg}):I||void 0===P?(0,s.jsx)(j.A,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.A,{centered:!0,show:C.show,onHide:()=>H(e=>({...e,show:!1})),children:(0,s.jsx)(d.A.Body,{children:(0,s.jsx)(v.TH,{value:null!=(h=null==(e=C.data)?void 0:e.connection)?h:(0,a.v)(p.mR,{}),startContent:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.gW,{itemKey:"Count",itemValue:null!=(N=null==(t=C.data)?void 0:t.count.toString())?N:"1"}),(0,s.jsx)(v.gW,{itemKey:"Time",itemValue:(0,l.FP)(null!=(w=null==(n=C.data)?void 0:n.time)?w:g).toLocaleString()})]}),endContent:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(r.A.Item,{className:"d-sm-flex justify-content-center",children:(0,s.jsx)(c.A,{variant:"outline-primary",className:"flex-grow-1",onClick:()=>H(e=>({...e,show:!1})),children:"Close"})})})})})}),(0,s.jsxs)(c.A,{variant:"outline-primary",className:"mb-3",onClick:()=>M(),disabled:T||I,children:["Refresh ",(T||I)&&(0,s.jsxs)(s.Fragment,{children:["\xa0",(0,s.jsx)(m.A,{size:"sm",animation:"border"})]})]}),(0,s.jsxs)(u.A,{hover:!0,striped:!0,size:"sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[F("Time"),F("Host"),(0,s.jsx)("th",{children:"Mode"}),(0,s.jsx)("th",{children:"Net"}),F("Count"),P.dumpProcessEnabled&&F("Proc")]})}),(0,s.jsx)("tbody",{className:"text-break",children:null==P||null==(i=P.objects)?void 0:i.filter(e=>e.time).sort((e,t)=>{var n,s,a,i,o,d;return"Host"===f?S(null==(n=e.connection)?void 0:n.addr,null==(s=t.connection)?void 0:s.addr):"Proc"===f?S(null==(a=e.connection)?void 0:a.process,null==(i=t.connection)?void 0:i.process):"Count"===f?S(e.count,t.count):S((0,l.FP)(null!=(o=e.time)?o:g),(0,l.FP)(null!=(d=t.time)?d:g))}).map((e,t)=>{var n,a,i,o,d,r;return(0,s.jsxs)("tr",{onClick:()=>H({show:!0,data:e}),children:[(0,s.jsx)("td",{children:(0,l.FP)(e.time).toLocaleString()}),(0,s.jsx)("td",{children:null==(n=e.connection)?void 0:n.addr}),(0,s.jsx)("td",{children:null==(a=e.connection)?void 0:a.mode}),(0,s.jsx)("td",{children:p.NW[null!=(r=null==(o=e.connection)||null==(i=o.type)?void 0:i.connType)?r:p.NW.unknown]}),(0,s.jsx)("td",{children:Number(e.count)}),P.dumpProcessEnabled&&(0,s.jsx)("td",{children:null==(d=e.connection)?void 0:d.process})]},"bh-"+t)})})]})]})}},99695:(e,t,n)=>{"use strict";n.d(t,{i:()=>i,w:()=>l});var s=n(9152),a=n(78133);let i=(0,s.w)("Ch9nb29nbGUvcHJvdG9idWYvdGltZXN0YW1wLnByb3RvEg9nb29nbGUucHJvdG9idWYiKwoJVGltZXN0YW1wEg8KB3NlY29uZHMYASABKAMSDQoFbmFub3MYAiABKAVChQEKE2NvbS5nb29nbGUucHJvdG9idWZCDlRpbWVzdGFtcFByb3RvUAFaMmdvb2dsZS5nb2xhbmcub3JnL3Byb3RvYnVmL3R5cGVzL2tub3duL3RpbWVzdGFtcHBi+AEBogIDR1BCqgIeR29vZ2xlLlByb3RvYnVmLldlbGxLbm93blR5cGVzYgZwcm90bzM"),l=(0,a.Z)(i,0)}},e=>{var t=t=>e(e.s=t);e.O(0,[9607,3528,11,3597,3779,1085,9349,7315,8684,4905,3959,5309,626,7494,3384,8441,1684,7358],()=>t(46781)),_N_E=e.O()}]);