(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8706],{3779:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>M});var n=a(5155),r=a(960),s=a(1464),l=a(2115),o=a(6355),d=a(9056),i=a(5677),c=a(5717),u=a(902),m=a(1867),h=a(9169),x=a(7948),f=a(8974);let p=new WeakMap,v=(0,f.Ht)(h.Ay,e=>(t,a,n)=>{let[r,s]=(0,x.s)(t),l=r?"$sub$"+r:void 0,o=e(l,null,n),{cache:d}=n;p.has(d)||p.set(d,[new Map,new Map]);let[i,c]=p.get(d);return(0,x.u)(()=>{if(!l)return;let[,e]=(0,x.z)(d,l),t=i.get(l)||0;if(i.set(l,t+1),!t){let t=a(s,{next:(t,a)=>{null!=t?e({error:t}):(e({error:void 0}),o.mutate(a,!1))}});if("function"!=typeof t)throw Error("The `subscribe` function must return a function to unsubscribe.");c.set(l,t)}return()=>{let e=i.get(l)-1;if(i.set(l,e),!e){let e=c.get(l);null==e||e()}}},[l]),{get data(){return o.data},get error(){return o.error}}});var j=a(4086),y=a(8508),g=a(6835),w=a(235),N=a(9940),b=a(715),A=a(3384),B=a(6506);let C={B:"B",KB:"KB",MB:"MB",GB:"GB",TB:"TB",PB:"PB"},_=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,{bytes:a,unit:n}=e>=0x4000000000000?{bytes:e/0x4000000000000,unit:C.PB}:e>=0x10000000000?{bytes:e/0x10000000000,unit:C.TB}:e>=0x40000000?{bytes:e/0x40000000,unit:C.GB}:e>=1048576?{bytes:e/1048576,unit:C.MB}:e>=1024?{bytes:e/1024,unit:C.KB}:{bytes:e,unit:C.B};return"".concat(a.toFixed(t)).concat(n)},k=(e,t)=>{let a=(new Date().getTime()-t.time.getTime())/1e3;if(0===t.download&&0===t.upload||0===a)return{download_rate:"Loading...",upload_rate:"Loading..."};let n=Number(e.download),r=Number(e.upload);return{download_rate:"(".concat(_(n),"): ").concat(_((n-t.download)/a),"/S"),upload_rate:"(".concat(_(r),"): ").concat(_((r-t.upload)/a),"/S")}},E=e=>{var t,a;let{data:s,counter:o,showModal:h}=e,x=(0,l.useContext)(g.u),[f,p]=(0,l.useState)(!1);return(0,n.jsxs)(i.A.Item,{eventKey:s.id.toString(),children:[(0,n.jsx)(i.A.Header,{children:(0,n.jsxs)("div",{className:"d-line text-break",children:[(0,n.jsx)("code",{className:"ms-2",children:s.id.toString()}),(0,n.jsx)("span",{className:"ms-2",children:s.addr}),(0,n.jsxs)(c.A,{className:"bg-light rounded-pill text-dark ms-1",children:[_(Number(o&&o.download?o.download:0))," / ",_(Number(o&&o.upload?o.upload:0))]}),(0,n.jsx)(c.A,{className:"bg-light rounded-pill text-dark ms-1 text-uppercase",children:N.Mq[s.mode]}),(0,n.jsx)(c.A,{className:"bg-light rounded-pill text-dark ms-1 text-uppercase",children:b.NW[null!=(a=null==(t=s.type)?void 0:t.connType)?a:0]}),s.tag&&(0,n.jsx)(c.A,{className:"bg-light rounded-pill text-dark ms-1 text-uppercase",children:s.tag})]})}),(0,n.jsx)(i.A.Body,{children:(0,n.jsx)(B.T,{value:s,showModal:h,endContent:(0,n.jsx)(d.A.Item,{children:(0,n.jsx)("div",{className:"d-sm-flex",children:(0,n.jsxs)(u.A,{variant:"outline-danger",className:"flex-grow-1 notranslate",disabled:f,onClick:()=>{p(!0),(0,y.kP)(A.oQ.method.close_conn,(0,r.v)(A.SE,{ids:[s.id]})).then(async e=>{let{error:t}=e;t?(x.Error("code ".concat(s.id," failed, ").concat(t.code,"| ").concat(t.msg)),p(!1)):setTimeout(()=>{p(!1)},5e3)})},children:["Close",f&&(0,n.jsxs)(n.Fragment,{children:["\xa0",(0,n.jsx)(m.A,{size:"sm",animation:"border",variant:"danger"})]})]})})})})})]},s.id)},M=function(){let[e,t]=(0,l.useState)({show:!1,hash:""}),[a,c]=(0,l.useState)({download:0,upload:0,counters:{},time:new Date,download_rate:"Loading...",upload_rate:"Loading..."}),{error:u}=(0,h.Ay)("/flow/total",async()=>(0,y.kP)(A.oQ.method.total).then(async e=>{let{data:t,error:n}=e;if(n)throw n;if(t)try{let e=k(t,a);return c(a=>({...a,download:Number(t.download),upload:Number(t.upload),counters:t.counters,time:new Date,download_rate:e.download_rate,upload_rate:e.upload_rate})),e}catch(e){throw{msg:e.toString(),code:500}}}),{refreshInterval:2e3}),{data:m,error:x}=v((0,y.cY)(A.oQ.method.notify),(0,y.zZ)(A.oQ.method.notify,(0,r.v)(s.v,{}),(e,t)=>{switch(void 0===t&&(t=new Map),e.data.case){case"notifyNewConnections":e.data.value.connections.sort((e,t)=>e.id>t.id?1:-1).forEach(e=>{t.set(e.id,e)});break;case"notifyRemoveConnections":e.data.value.ids.forEach(e=>{t.delete(e)})}return t}),{});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(w.y,{show:e.show,hash:e.hash,editable:!1,onHide:()=>t({...e,show:!1})}),(0,n.jsx)(o.A,{className:"mb-3",children:(0,n.jsxs)(d.A,{variant:"flush",children:[(0,n.jsx)(d.A.Item,{children:(0,n.jsxs)("div",{className:"d-sm-flex",children:[(0,n.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Download"}),(0,n.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-download",children:u?u.msg:a.download_rate})]})}),(0,n.jsx)(d.A.Item,{children:(0,n.jsxs)("div",{className:"d-sm-flex",children:[(0,n.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Upload"}),(0,n.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-upload",children:u?u.msg:a.upload_rate})]})})]})}),void 0!==x?(0,n.jsx)(j.A,{code:x.code,children:x.msg}):void 0===m?(0,n.jsx)(j.A,{}):(0,n.jsx)(i.A,{className:"mb-3",alwaysOpen:!0,id:"connections",children:[...m.values()].reverse().map(e=>(0,n.jsx)(E,{data:e,counter:a.counters[e.id.toString()],showModal:e=>t({show:!0,hash:e})},e.id))})]})}},5677:(e,t,a)=>{"use strict";a.d(t,{A:()=>y});var n=a(9300),r=a.n(n),s=a(2115),l=a(1497),o=a(7390),d=a(8873);function i(e,t){return Array.isArray(e)?e.includes(t):e===t}let c=s.createContext({});c.displayName="AccordionContext";var u=a(5155);let m=s.forwardRef((e,t)=>{let{as:a="div",bsPrefix:n,className:l,children:m,eventKey:h,...x}=e,{activeEventKey:f}=(0,s.useContext)(c);return n=(0,o.oU)(n,"accordion-collapse"),(0,u.jsx)(d.A,{ref:t,in:i(f,h),...x,className:r()(l,n),children:(0,u.jsx)(a,{children:s.Children.only(m)})})});m.displayName="AccordionCollapse";let h=s.createContext({eventKey:""});h.displayName="AccordionItemContext";let x=s.forwardRef((e,t)=>{let{as:a="div",bsPrefix:n,className:l,onEnter:d,onEntering:i,onEntered:c,onExit:x,onExiting:f,onExited:p,...v}=e;n=(0,o.oU)(n,"accordion-body");let{eventKey:j}=(0,s.useContext)(h);return(0,u.jsx)(m,{eventKey:j,onEnter:d,onEntering:i,onEntered:c,onExit:x,onExiting:f,onExited:p,children:(0,u.jsx)(a,{ref:t,...v,className:r()(l,n)})})});x.displayName="AccordionBody";let f=s.forwardRef((e,t)=>{let{as:a="button",bsPrefix:n,className:l,onClick:d,...m}=e;n=(0,o.oU)(n,"accordion-button");let{eventKey:x}=(0,s.useContext)(h),f=function(e,t){let{activeEventKey:a,onSelect:n,alwaysOpen:r}=(0,s.useContext)(c);return s=>{let l=e===a?null:e;r&&(l=Array.isArray(a)?a.includes(e)?a.filter(t=>t!==e):[...a,e]:[e]),null==n||n(l,s),null==t||t(s)}}(x,d),{activeEventKey:p}=(0,s.useContext)(c);return"button"===a&&(m.type="button"),(0,u.jsx)(a,{ref:t,onClick:f,...m,"aria-expanded":Array.isArray(p)?p.includes(x):x===p,className:r()(l,n,!i(p,x)&&"collapsed")})});f.displayName="AccordionButton";let p=s.forwardRef((e,t)=>{let{as:a="h2","aria-controls":n,bsPrefix:s,className:l,children:d,onClick:i,...c}=e;return s=(0,o.oU)(s,"accordion-header"),(0,u.jsx)(a,{ref:t,...c,className:r()(l,s),children:(0,u.jsx)(f,{onClick:i,"aria-controls":n,children:d})})});p.displayName="AccordionHeader";let v=s.forwardRef((e,t)=>{let{as:a="div",bsPrefix:n,className:l,eventKey:d,...i}=e;n=(0,o.oU)(n,"accordion-item");let c=(0,s.useMemo)(()=>({eventKey:d}),[d]);return(0,u.jsx)(h.Provider,{value:c,children:(0,u.jsx)(a,{ref:t,...i,className:r()(l,n)})})});v.displayName="AccordionItem";let j=s.forwardRef((e,t)=>{let{as:a="div",activeKey:n,bsPrefix:d,className:i,onSelect:m,flush:h,alwaysOpen:x,...f}=(0,l.Zw)(e,{activeKey:"onSelect"}),p=(0,o.oU)(d,"accordion"),v=(0,s.useMemo)(()=>({activeEventKey:n,onSelect:m,alwaysOpen:x}),[n,m,x]);return(0,u.jsx)(c.Provider,{value:v,children:(0,u.jsx)(a,{ref:t,...f,className:r()(i,p,h&&"".concat(p,"-flush"))})})});j.displayName="Accordion";let y=Object.assign(j,{Button:f,Collapse:m,Item:v,Header:p,Body:x})},5717:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var n=a(9300),r=a.n(n),s=a(2115),l=a(7390),o=a(5155);let d=s.forwardRef((e,t)=>{let{bsPrefix:a,bg:n="primary",pill:s=!1,text:d,className:i,as:c="span",...u}=e,m=(0,l.oU)(a,"badge");return(0,o.jsx)(c,{ref:t,...u,className:r()(i,m,s&&"rounded-pill",d&&"text-".concat(d),n&&"bg-".concat(n))})});d.displayName="Badge";let i=d},6506:(e,t,a)=>{"use strict";a.d(t,{H:()=>o,T:()=>d});var n=a(5155),r=a(7167),s=a(9056),l=a(715);let o=e=>(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(s.A.Item,{children:(0,n.jsxs)("div",{className:"d-sm-flex",children:[(0,n.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-capitalize",children:e.itemKey}),(0,n.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:"hash"===e.itemKey&&e.showModal?(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),e.showModal&&e.showModal(e.itemValue)},children:e.itemValue}):e.itemValue})]})})}),d=e=>{let{value:t,endContent:a,showModal:d}=e;return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(s.A,{variant:"flush",children:[function(e){let t=(0,r.E4)(l.mR,e),a=(e,t)=>{if("enum"===e.fieldKind){let a=t.get(e);return e.enum.value[a].name}{let a=t.get(e);if(!a)return;return a.toString()}},s=e=>{let{f:t,ref:r}=e,s=a(t,r);if(s)return(0,n.jsx)(o,{itemKey:t.name.replaceAll("_"," "),itemValue:s,showModal:d})};return(0,n.jsx)(n.Fragment,{children:t.fields.map(e=>{if("message"===e.fieldKind){let a=t.get(e);return a.fields.map(e=>(0,n.jsx)(s,{f:e,ref:a},e.name))}return(0,n.jsx)(s,{f:e,ref:t},e.name)})})}(t),a]})})}},8438:(e,t,a)=>{Promise.resolve().then(a.bind(a,3779))}},e=>{var t=t=>e(e.s=t);e.O(0,[9279,9322,601,3779,5453,2362,2765,5402,8684,8681,9631,626,8580,7605,235,3384,8441,1684,7358],()=>t(8438)),_N_E=e.O()}]);