(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[129],{7637:function(e,t,n){Promise.resolve().then(n.bind(n,8323))},798:function(e,t,n){"use strict";n.d(t,{$f:function(){return m},Mj:function(){return y},Ti:function(){return c},U9:function(){return g},XE:function(){return h},YO:function(){return l},Z5:function(){return s},dn:function(){return i},fG:function(){return o},gU:function(){return a},gW:function(){return f},q$:function(){return x},r:function(){return d},rQ:function(){return r}});var o="",r="https://clients3.google.com/generate_204",a="dns.nextdns.io:853",l=!0,c="http://ip.sb",s="stun.syncthing.net:3478",i="stun.nextcloud.com:443";let u=()=>{let e=localStorage.getItem("api_url");o=null!==e?e:"",e=localStorage.getItem("remote_bypass"),null!==(e=localStorage.getItem("latency_http_url"))&&(r=e),null!==(e=localStorage.getItem("latency_dns_url"))&&(a=e),null!==(e=localStorage.getItem("latency_ipv6"))&&(l="true"===e),null!==(e=localStorage.getItem("latency_ip_url"))&&(c=e),null!==(e=localStorage.getItem("latency_stun_url"))&&(s=e),null!==(e=localStorage.getItem("latency_stun_tcp_url"))&&(i=e)},d=e=>{p("api_url",e)},m=e=>{p("latency_dns_url",e)},h=e=>{p("latency_http_url",e)},f=e=>{p("latency_ipv6",e.toString())},g=e=>{p("latency_ip_url",e)},y=e=>{p("latency_stun_url",e)},x=e=>{p("latency_stun_tcp_url",e)},p=(e,t)=>{""===t?localStorage.removeItem(e):localStorage.setItem(e,t),u()};u()},5594:function(e,t,n){"use strict";n.d(t,{D4:function(){return l},OV:function(){return c},Uo:function(){return s},o5:function(){return i}});var o=n(798),r=n(3334),a=n(4504);function l(e,t,n,l){return c=>l?(0,r.d)(e,l):fetch("".concat(o.fG).concat(c),{method:t,body:n}).then(async t=>{if(!t.ok)throw{code:t.status,msg:t.statusText,raw:t.text()};return(0,a.h4)(e,new Uint8Array(await t.arrayBuffer()))})}function c(e,t,n,r){return l=>fetch("".concat(o.fG).concat(l),{method:n,body:r}).then(async n=>{if(!n.ok)throw{code:n.status,msg:n.statusText,raw:n.text()};return t((0,a.h4)(e,new Uint8Array(await n.arrayBuffer())))})}let s=async(e,t)=>{let n=await fetch("".concat(o.fG).concat(e),{method:void 0!==t.method?t.method:"POST",body:t.body});return n.ok?void 0===t.process?{}:{data:t.process(n)}:{error:{code:n.status,msg:n.text()}}};function i(e,t,n){return(r,l)=>{let c,{next:s}=l,i=new URL(""!==o.fG?o.fG:window.location.toString());i.pathname=r,i.protocol="https:"===i.protocol?"wss:":"ws:";let u=!1,d=()=>{u||(console.log("connecting to: ".concat(i)),(c=new WebSocket(i)).binaryType="arraybuffer",c.addEventListener("open",t=>{console.log("connect to: ".concat(i,", event type: ").concat(t.type)),null==c||c.send(e)}),c.addEventListener("message",e=>{let o=(0,a.h4)(t,new Uint8Array(e.data));s(null,e=>n(e,o))}),c.addEventListener("error",e=>{let t="websocket have some error";s({msg:t,code:500}),console.log(t,e.type)}),c.addEventListener("close",e=>{console.log("websocket closed, code: "+e.code),s(null,void 0),u||(console.log("reconnect after 1 seconds"),setTimeout(d,1e3))}))};return d(),()=>{u=!0,void 0!==c&&(console.log("close: ".concat(r)),c.close(),c=void 0)}}}},4954:function(e,t,n){"use strict";n.d(t,{P:function(){return c},t:function(){return s}});var o=n(7437),r=n(2265),a=n(2230),l=n(6647);let c=(0,r.createContext)({Info:e=>{},Error:e=>{}}),s=e=>{let{children:t}=e,[n,s]=(0,r.useState)({value:{},index:0}),i=(e,t)=>s(n=>({value:{...n.value,[n.index]:{text:e,type:t}},index:n.index+1}));return(0,o.jsxs)(c.Provider,{value:{Info:e=>{console.log(e),i(e,"success")},Error:e=>{console.error(e),i(e,"danger")}},children:[(0,o.jsx)(a.Z,{className:"p-3",position:"top-center",containerPosition:"fixed",style:{zIndex:999999},children:Object.entries(n.value).map(e=>{let[t,r]=e;return(0,o.jsxs)(l.Z,{role:"alert","aria-live":"assertive",show:!0,bg:r.type,onClose:()=>{let e=n.value;delete e[t],s({...n,value:e}),console.log("close: "+t)},"aria-atomic":"true",delay:4e3,autohide:!0,animation:!0,children:[(0,o.jsxs)(l.Z.Header,{children:[(0,o.jsx)("strong",{className:"me-auto",children:"Notification"}),(0,o.jsx)("small",{className:"text-muted",children:"just now"})]}),(0,o.jsx)(l.Z.Body,{className:"text-center",children:r.text})]},"toast"+t)})}),t]})}},8323:function(e,t,n){"use strict";n.r(t);var o=n(7437),r=n(2265),a=n(4402),l=n(4670),c=n(9420),s=n(2115),i=n(4076),u=n(279),d=n(6926),m=n(4122),h=n(4444),f=n(1593),g=n(6263),y=n(4954),x=n(5118),p=n(5594),v=n(914),j=n.n(v),_=n(9536),w=n(9862),b=n(8560),Z=n(9569);t.default=function(){let[e,t]=(0,r.useState)({}),[n,v]=(0,r.useState)((0,b.U)(_.Me,{name:"",url:"",type:_.dt.reserve})),{data:k,error:N,isLoading:U,mutate:S}=(0,x.ZP)("/sublist",(0,p.D4)(w.q_)),E=(0,r.useContext)(y.P);if(void 0!==N)return(0,o.jsx)(j(),{statusCode:N.code,title:N.msg});if(U||void 0===k)return(0,o.jsx)(g.Z,{});let I=n=>{t({...e,[n]:!0}),(0,p.Uo)("/sub",{method:"PATCH",body:(0,Z.O)(w.F8,(0,b.U)(w.F8,{names:[n]}))}).then(async o=>{let{error:r}=o;void 0!==r?E.Error("Update failed ".concat(r.code,"| ").concat(await r.msg)):E.Info("Update successfully"),t({...e,[n]:!1})})},C=e=>{(0,p.Uo)("/sub",{method:"DELETE",body:(0,Z.O)(w.F8,(0,b.U)(w.F8,{names:[e]}))}).then(async t=>{let{error:n}=t;void 0!==n?E.Error("delete ".concat(e," failed, ").concat(n.code,"| ").concat(await n.msg)):S()})};return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(a.Z,{className:"row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4",children:[k.links&&Object.entries(k.links).sort((e,t)=>e<=t?-1:1).map(t=>{let[n,r]=t;return(0,o.jsx)(l.Z,{className:"mb-3",children:(0,o.jsxs)(c.Z,{className:"h-100",children:[(0,o.jsx)(c.Z.Header,{children:r.name}),(0,o.jsx)(c.Z.Body,{children:r.url}),(0,o.jsxs)(s.Z,{as:c.Z.Footer,className:"d-flex",children:[(0,o.jsxs)(i.Z,{variant:"outline-primary",onClick:()=>I(r.name),disabled:e[r.name],className:"w-100",children:[e[r.name]&&(0,o.jsx)(u.Z,{size:"sm",animation:"border",variant:"primary"}),"Update"]}),(0,o.jsxs)(d.Z,{onSelect:e=>{"ok"===e&&C(r.name)},as:s.Z,variant:"outline-danger",title:"Remove",className:"w-100",children:[(0,o.jsx)(m.Z.Item,{eventKey:"ok",children:"OK"}),(0,o.jsx)(m.Z.Item,{eventKey:"cancel",children:"Cancel"})]})]})]})},n)}),(0,o.jsx)(l.Z,{className:"mb-3",children:(0,o.jsxs)(c.Z,{className:"h-100",children:[(0,o.jsx)(c.Z.Header,{children:"Add"}),(0,o.jsxs)(c.Z.Body,{children:[(0,o.jsx)(h.Z,{label:"Name",className:"mb-3",children:(0,o.jsx)(f.Z.Control,{placeholder:"group1",value:n.name,onChange:e=>v((0,b.U)(_.Me,{...n,name:e.target.value}))})}),(0,o.jsx)(h.Z,{label:"Link",className:"mb-3",children:(0,o.jsx)(f.Z.Control,{placeholder:"https://www.example.com",value:n.url,onChange:e=>v((0,b.U)(_.Me,{...n,url:e.target.value}))})})]}),(0,o.jsx)(s.Z,{as:c.Z.Footer,children:(0,o.jsx)(i.Z,{variant:"outline-primary",onClick:async()=>{""!==n.name&&""!==n.url&&(0,p.Uo)("/sub",{body:(0,Z.O)(w.o8,(0,b.U)(w.o8,{links:[n]}))}).then(async e=>{let{error:t}=e;void 0!==t?E.Error("save link ".concat(n.url," failed, ").concat(t.code,"| ").concat(await t.msg)):S()})},children:"ADD"})})]})})]})})}}},function(e){e.O(0,[439,118,982,773,122,225,152,971,117,744],function(){return e(e.s=7637)}),_N_E=e.O()}]);