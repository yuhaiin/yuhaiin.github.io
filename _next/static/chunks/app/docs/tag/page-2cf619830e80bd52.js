(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[966],{6356:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var a=r(2265),n=r(1823),o=r(8203);function l(){var e=(0,n.Z)(),t=(0,a.useRef)();return(0,o.Z)(function(){return clearTimeout(t.current)}),(0,a.useMemo)(function(){var r=function(){return clearTimeout(t.current)};return{set:function(a,n){void 0===n&&(n=0),e()&&(r(),n<=2147483647?t.current=setTimeout(a,n):function e(t,r,a){var n=a-Date.now();t.current=n<=2147483647?setTimeout(r,n):setTimeout(function(){return e(t,r,a)},2147483647)}(t,a,Date.now()+n))},clear:r}},[])}},9003:function(e,t,r){Promise.resolve().then(r.bind(r,382))},6347:function(e,t,r){"use strict";r.d(t,{P:function(){return i},t:function(){return s}});var a=r(7437),n=r(2265),o=r(8215),l=r(9023);let i=(0,n.createContext)({Info:e=>{},Error:e=>{}}),s=e=>{let{children:t}=e,[r,s]=(0,n.useState)({value:{},index:0}),u=(e,t)=>{s(r=>(r.value[r.index]={text:e,type:t},r.index++,{...r}))};return(0,a.jsxs)(i.Provider,{value:{Info:e=>{console.log(e),u(e,"success")},Error:e=>{console.error(e),u(e,"danger")}},children:[(0,a.jsx)(l.Z,{className:"p-3",position:"top-center",containerPosition:"fixed",style:{zIndex:1},children:Object.entries(r.value).map(e=>{let[t,n]=e;return(0,a.jsxs)(o.Z,{role:"alert","aria-live":"assertive",show:!0,bg:n.type,onClose:()=>{let e=r.value;delete e[t],s({...r,value:e}),console.log("close: "+t)},"aria-atomic":"true",delay:4e3,autohide:!0,animation:!0,children:[(0,a.jsxs)(o.Z.Header,{children:[(0,a.jsx)("strong",{className:"me-auto",children:"Notification"}),(0,a.jsx)("small",{className:"text-muted",children:"just now"})]}),(0,a.jsx)(o.Z.Body,{className:"text-center",children:n.text})]},"toast"+t)})}),t]})}},6168:function(e,t,r){"use strict";var a=r(7437),n=r(4297),o=r(1701),l=r(733),i=r(4337),s=r(713),u=r(6934),c=r(1308),d=r(1375),v=r.n(d);t.Z=function(e){let{data:t,error:r,isLoading:d,mutate:h}=(0,s.ZP)(""!==e.hash?"/node?hash=".concat(e.hash):null,u.Q3);return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(o.Z,{show:e.show,"aria-labelledby":"contained-modal-title-vcenter",size:"xl",onHide:()=>{e.onHide()},centered:!0,children:[(0,a.jsx)(o.Z.Header,{closeButton:!0,children:(0,a.jsx)(o.Z.Title,{id:"contained-modal-title-vcenter",children:e.hash})}),(0,a.jsx)(o.Z.Body,{children:void 0!==r?(0,a.jsx)(v(),{statusCode:r.code,title:r.msg}):d?(0,a.jsx)(c.Z,{}):(0,a.jsx)(l.Z.Control,{as:"textarea",value:t,style:{height:"65vh",fontFamily:"monospace"},readOnly:!e.editable,onChange:e=>h(e.target.value,!1)})}),(0,a.jsxs)(o.Z.Footer,{children:[(0,a.jsx)(n.Z,{variant:"secondary",onClick:()=>{e.onHide()},children:"Close"}),(0,a.jsx)(()=>void 0!==e.editable&&e.editable?(0,a.jsx)(n.Z,{variant:"primary",active:!d&&void 0===r,onClick:async()=>{let r=await fetch(i.f+"/node",{method:"POST",headers:{"content-type":"application/json;charset=UTF-8"},body:t});r.ok?(console.log("save successful"),void 0!==e.onSave&&e.onSave(),e.onHide()):console.log(await r.text())},children:"Save"}):(0,a.jsx)(a.Fragment,{}),{})]})]})})}},382:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return D}});var a=r(7437),n=r(2265),o=r(6879),l=r(4297),i=r(3518),s=r(51),u=r(733),c=r(3508),d=r(5503),v=r(4337),h=r(1308),f=r(780),m=r(8324),p=r(4481),x=r.n(p),g=r(7337);r(8724);function k(){return{nodesV2:{}}}let y={encode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x().Writer.create();return Object.entries(e.nodesV2).forEach(e=>{let[r,a]=e;b.encode({key:r,value:a},t.uint32(26).fork()).ldelim()}),t},decode(e,t){let r=e instanceof x().Reader?e:x().Reader.create(e),a=void 0===t?r.len:r.pos+t,n=k();for(;r.pos<a;){let e=r.uint32();switch(e>>>3){case 3:if(26!==e)break;let t=b.decode(r,r.uint32());void 0!==t.value&&(n.nodesV2[t.key]=t.value);continue}if((7&e)==4||0===e)break;r.skipType(7&e)}return n},fromJSON:e=>({nodesV2:E(e.node_hash_map)?Object.entries(e.node_hash_map).reduce((e,t)=>{let[r,a]=t;return e[r]=String(a),e},{}):{}}),toJSON(e){let t={};if(e.nodesV2){let r=Object.entries(e.nodesV2);r.length>0&&(t.node_hash_map={},r.forEach(e=>{let[r,a]=e;t.node_hash_map[r]=a}))}return t},create:e=>y.fromPartial(null!=e?e:{}),fromPartial(e){var t;let r=k();return r.nodesV2=Object.entries(null!==(t=e.nodesV2)&&void 0!==t?t:{}).reduce((e,t)=>{let[r,a]=t;return void 0!==a&&(e[r]=String(a)),e},{}),r}};function j(){return{key:"",value:""}}let b={encode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x().Writer.create();return""!==e.key&&t.uint32(10).string(e.key),""!==e.value&&t.uint32(18).string(e.value),t},decode(e,t){let r=e instanceof x().Reader?e:x().Reader.create(e),a=void 0===t?r.len:r.pos+t,n=j();for(;r.pos<a;){let e=r.uint32();switch(e>>>3){case 1:if(10!==e)break;n.key=r.string();continue;case 2:if(18!==e)break;n.value=r.string();continue}if((7&e)==4||0===e)break;r.skipType(7&e)}return n},fromJSON:e=>({key:T(e.key)?String(e.key):"",value:T(e.value)?String(e.value):""}),toJSON(e){let t={};return""!==e.key&&(t.key=e.key),""!==e.value&&(t.value=e.value),t},create:e=>b.fromPartial(null!=e?e:{}),fromPartial(e){var t,r;let a=j();return a.key=null!==(t=e.key)&&void 0!==t?t:"",a.value=null!==(r=e.value)&&void 0!==r?r:"",a}};function N(){return{groupsV2:{},nodes:{},tags:{}}}let O={encode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x().Writer.create();return Object.entries(e.groupsV2).forEach(e=>{let[r,a]=e;S.encode({key:r,value:a},t.uint32(18).fork()).ldelim()}),Object.entries(e.nodes).forEach(e=>{let[r,a]=e;w.encode({key:r,value:a},t.uint32(26).fork()).ldelim()}),Object.entries(e.tags).forEach(e=>{let[r,a]=e;P.encode({key:r,value:a},t.uint32(34).fork()).ldelim()}),t},decode(e,t){let r=e instanceof x().Reader?e:x().Reader.create(e),a=void 0===t?r.len:r.pos+t,n=N();for(;r.pos<a;){let e=r.uint32();switch(e>>>3){case 2:if(18!==e)break;let t=S.decode(r,r.uint32());void 0!==t.value&&(n.groupsV2[t.key]=t.value);continue;case 3:if(26!==e)break;let a=w.decode(r,r.uint32());void 0!==a.value&&(n.nodes[a.key]=a.value);continue;case 4:if(34!==e)break;let o=P.decode(r,r.uint32());void 0!==o.value&&(n.tags[o.key]=o.value);continue}if((7&e)==4||0===e)break;r.skipType(7&e)}return n},fromJSON:e=>({groupsV2:E(e.group_nodes_map)?Object.entries(e.group_nodes_map).reduce((e,t)=>{let[r,a]=t;return e[r]=y.fromJSON(a),e},{}):{},nodes:E(e.nodes)?Object.entries(e.nodes).reduce((e,t)=>{let[r,a]=t;return e[r]=g.xm.fromJSON(a),e},{}):{},tags:E(e.tags)?Object.entries(e.tags).reduce((e,t)=>{let[r,a]=t;return e[r]=m.pJ.fromJSON(a),e},{}):{}}),toJSON(e){let t={};if(e.groupsV2){let r=Object.entries(e.groupsV2);r.length>0&&(t.group_nodes_map={},r.forEach(e=>{let[r,a]=e;t.group_nodes_map[r]=y.toJSON(a)}))}if(e.nodes){let r=Object.entries(e.nodes);r.length>0&&(t.nodes={},r.forEach(e=>{let[r,a]=e;t.nodes[r]=g.xm.toJSON(a)}))}if(e.tags){let r=Object.entries(e.tags);r.length>0&&(t.tags={},r.forEach(e=>{let[r,a]=e;t.tags[r]=m.pJ.toJSON(a)}))}return t},create:e=>O.fromPartial(null!=e?e:{}),fromPartial(e){var t,r,a;let n=N();return n.groupsV2=Object.entries(null!==(t=e.groupsV2)&&void 0!==t?t:{}).reduce((e,t)=>{let[r,a]=t;return void 0!==a&&(e[r]=y.fromPartial(a)),e},{}),n.nodes=Object.entries(null!==(r=e.nodes)&&void 0!==r?r:{}).reduce((e,t)=>{let[r,a]=t;return void 0!==a&&(e[r]=g.xm.fromPartial(a)),e},{}),n.tags=Object.entries(null!==(a=e.tags)&&void 0!==a?a:{}).reduce((e,t)=>{let[r,a]=t;return void 0!==a&&(e[r]=m.pJ.fromPartial(a)),e},{}),n}};function Z(){return{key:"",value:void 0}}let S={encode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x().Writer.create();return""!==e.key&&t.uint32(10).string(e.key),void 0!==e.value&&y.encode(e.value,t.uint32(18).fork()).ldelim(),t},decode(e,t){let r=e instanceof x().Reader?e:x().Reader.create(e),a=void 0===t?r.len:r.pos+t,n=Z();for(;r.pos<a;){let e=r.uint32();switch(e>>>3){case 1:if(10!==e)break;n.key=r.string();continue;case 2:if(18!==e)break;n.value=y.decode(r,r.uint32());continue}if((7&e)==4||0===e)break;r.skipType(7&e)}return n},fromJSON:e=>({key:T(e.key)?String(e.key):"",value:T(e.value)?y.fromJSON(e.value):void 0}),toJSON(e){let t={};return""!==e.key&&(t.key=e.key),void 0!==e.value&&(t.value=y.toJSON(e.value)),t},create:e=>S.fromPartial(null!=e?e:{}),fromPartial(e){var t;let r=Z();return r.key=null!==(t=e.key)&&void 0!==t?t:"",r.value=void 0!==e.value&&null!==e.value?y.fromPartial(e.value):void 0,r}};function C(){return{key:"",value:void 0}}let w={encode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x().Writer.create();return""!==e.key&&t.uint32(10).string(e.key),void 0!==e.value&&g.xm.encode(e.value,t.uint32(18).fork()).ldelim(),t},decode(e,t){let r=e instanceof x().Reader?e:x().Reader.create(e),a=void 0===t?r.len:r.pos+t,n=C();for(;r.pos<a;){let e=r.uint32();switch(e>>>3){case 1:if(10!==e)break;n.key=r.string();continue;case 2:if(18!==e)break;n.value=g.xm.decode(r,r.uint32());continue}if((7&e)==4||0===e)break;r.skipType(7&e)}return n},fromJSON:e=>({key:T(e.key)?String(e.key):"",value:T(e.value)?g.xm.fromJSON(e.value):void 0}),toJSON(e){let t={};return""!==e.key&&(t.key=e.key),void 0!==e.value&&(t.value=g.xm.toJSON(e.value)),t},create:e=>w.fromPartial(null!=e?e:{}),fromPartial(e){var t;let r=C();return r.key=null!==(t=e.key)&&void 0!==t?t:"",r.value=void 0!==e.value&&null!==e.value?g.xm.fromPartial(e.value):void 0,r}};function J(){return{key:"",value:void 0}}let P={encode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x().Writer.create();return""!==e.key&&t.uint32(10).string(e.key),void 0!==e.value&&m.pJ.encode(e.value,t.uint32(18).fork()).ldelim(),t},decode(e,t){let r=e instanceof x().Reader?e:x().Reader.create(e),a=void 0===t?r.len:r.pos+t,n=J();for(;r.pos<a;){let e=r.uint32();switch(e>>>3){case 1:if(10!==e)break;n.key=r.string();continue;case 2:if(18!==e)break;n.value=m.pJ.decode(r,r.uint32());continue}if((7&e)==4||0===e)break;r.skipType(7&e)}return n},fromJSON:e=>({key:T(e.key)?String(e.key):"",value:T(e.value)?m.pJ.fromJSON(e.value):void 0}),toJSON(e){let t={};return""!==e.key&&(t.key=e.key),void 0!==e.value&&(t.value=m.pJ.toJSON(e.value)),t},create:e=>P.fromPartial(null!=e?e:{}),fromPartial(e){var t;let r=J();return r.key=null!==(t=e.key)&&void 0!==t?t:"",r.value=void 0!==e.value&&null!==e.value?m.pJ.fromPartial(e.value):void 0,r}};function E(e){return"object"==typeof e&&null!==e}function T(e){return null!=e}var V=r(713),_=r(6934),R=r(1375),F=r.n(R),H=r(6168),I=r(6347),D=function(){let e=(0,n.useContext)(I.P),[t,r]=(0,n.useState)(""),[p,x]=(0,n.useState)({tag:"",hash:"",type:m.fY.node}),{data:g,error:k,isLoading:y,mutate:j}=(0,V.ZP)("/taglist",(0,_.hW)(O)),[b,N]=(0,n.useState)({hash:""});if(void 0!==k)return(0,a.jsx)(F(),{statusCode:k.code,title:k.msg});if(y||void 0==g)return(0,a.jsx)(h.Z,{});let Z=(t,r)=>(0,a.jsx)(d.Z.Item,{style:{border:"0ch",borderBottom:"1px solid #dee2e6"},children:(0,a.jsxs)("div",{className:"d-flex flex-wrap",children:[(0,a.jsx)("a",{className:"text-decoration-none",href:"#empty",onClick:e=>{e.preventDefault(),x(e=>({...e,tag:t}))},children:t}),(0,a.jsx)(o.Z,{className:"rounded-pill bg-light text-dark text-truncate ms-1",children:0===r.hash.length||""===r.hash[0]?(0,a.jsxs)(a.Fragment,{children:["Fallback ",(0,a.jsx)("i",{className:"bi bi-heart-arrow"})," Global"]}):r.type===m.fY.mirror?(0,a.jsxs)(a.Fragment,{children:["Mirror ",(0,a.jsx)("i",{className:"bi bi-arrow-right"})," ",r.hash]}):(0,a.jsxs)(a.Fragment,{children:["Target ",(0,a.jsx)("i",{className:"bi bi-arrow-right"}),(0,a.jsx)("a",{className:"text-truncate",href:"#",onClick:e=>{e.preventDefault(),N({hash:r.hash[0]})},children:r.hash})]})}),(0,a.jsxs)("a",{className:"text-decoration-none ms-auto text-truncate",href:"#empty",onClick:async r=>{r.preventDefault();let a=await fetch(v.f+"/tag?tag="+t,{method:"DELETE"});a.ok?(e.Info("delete tag ".concat(t," success")),await j()):e.Error(await a.text())},children:[(0,a.jsx)("i",{className:"bi-trash"}),"DELETE"]})]})},t);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(H.Z,{show:""!==b.hash,hash:b.hash,onHide:()=>N({hash:""})}),(0,a.jsx)(i.Z,{className:"mb-3",children:(0,a.jsx)(d.Z,{variant:"flush",children:Object.entries(g.tags).sort((e,t)=>e<=t?-1:1).map(e=>{let[t,r]=e;return Z(t,r)})})}),(0,a.jsx)(i.Z,{className:"mb-3",children:(0,a.jsxs)(i.Z.Body,{children:[(0,a.jsxs)(c.Z,{className:"mb-3",children:[(0,a.jsx)(u.Z.Check,{inline:!0,type:"radio",onChange:()=>{x(e=>({...e,type:m.fY.node,hash:""}))},checked:p.type===m.fY.node,label:"Node"}),(0,a.jsx)(u.Z.Check,{inline:!0,type:"radio",onChange:()=>{x(e=>({...e,type:m.fY.mirror,hash:""}))},checked:p.type===m.fY.mirror,label:"Mirror"})]}),(0,a.jsx)(s.Z,{label:"Tag",className:"mb-2",children:(0,a.jsx)(u.Z.Control,{placeholder:"Tag","aria-label":"Tag","aria-describedby":"basic-addon1",value:p.tag,onChange:e=>{x(t=>({...t,tag:e.target.value}))}})}),p.type===m.fY.node?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.Z,{label:"Group",className:"mb-2",children:(0,a.jsxs)(u.Z.Select,{defaultValue:"",onChange:e=>r(e.target.value),children:[(0,a.jsx)("option",{children:"Choose..."}),Object.keys(g.groupsV2).sort((e,t)=>e<=t?-1:1).map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})}),(0,a.jsx)(s.Z,{label:"Node",className:"mb-2",children:(0,a.jsxs)(u.Z.Select,{defaultValue:"",onChange:e=>{x(t=>({...t,hash:e.target.value}))},children:[(0,a.jsx)("option",{value:"",children:"Choose..."}),Object.entries(void 0!==g.groupsV2[t]?g.groupsV2[t].nodesV2:{}).sort((e,t)=>e<=t?-1:1).map(e=>{let[t,r]=e;return(0,a.jsx)("option",{value:r,children:t},t)})]})})]}):(0,a.jsx)(s.Z,{label:"Mirror",className:"mb-2",children:(0,a.jsxs)(u.Z.Select,{defaultValue:"",onChange:e=>{x(t=>({...t,hash:e.target.value}))},children:[(0,a.jsx)("option",{value:"",children:"Choose..."}),Object.keys(g.tags).sort((e,t)=>e<=t?-1:1).map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})}),(0,a.jsx)(l.Z,{variant:"outline-primary",onClick:async()=>{if(""===p.tag||""===p.hash)return;let t=await fetch(v.f+"/tag",{method:"POST",body:f.hr.encode(p).finish()});t.ok?(e.Info("Set tag ".concat(p.tag," to ").concat(p.hash," successful")),await j()):e.Error(await t.text())},children:"Save"})]})})]})}},3508:function(e,t,r){"use strict";var a=r(4440),n=r.n(a),o=r(2265),l=r(499),i=r(6376),s=r(9062),u=r(7447),c=r(7437);let d=(0,l.Z)("input-group-text",{Component:"span"}),v=o.forwardRef((e,t)=>{let{bsPrefix:r,size:a,hasValidation:l,className:s,as:d="div",...v}=e;r=(0,i.vE)(r,"input-group");let h=(0,o.useMemo)(()=>({}),[]);return(0,c.jsx)(u.Z.Provider,{value:h,children:(0,c.jsx)(d,{ref:t,...v,className:n()(s,r,a&&"".concat(r,"-").concat(a),l&&"has-validation")})})});v.displayName="InputGroup",t.Z=Object.assign(v,{Text:d,Radio:e=>(0,c.jsx)(d,{children:(0,c.jsx)(s.Z,{type:"radio",...e})}),Checkbox:e=>(0,c.jsx)(d,{children:(0,c.jsx)(s.Z,{type:"checkbox",...e})})})},7447:function(e,t,r){"use strict";var a=r(2265);let n=a.createContext(null);n.displayName="InputGroupContext",t.Z=n},8215:function(e,t,r){"use strict";r.d(t,{Z:function(){return k}});var a=r(2265),n=r(4440),o=r.n(n),l=r(6356),i=r(7496),s=r(985),u=r(7437);let c={[i.d0]:"showing",[i.Ix]:"showing show"},d=a.forwardRef((e,t)=>(0,u.jsx)(s.Z,{...e,ref:t,transitionClasses:c}));d.displayName="ToastFade";var v=r(5113),h=r(6376),f=r(6713);let m=a.createContext({onClose(){}}),p=a.forwardRef((e,t)=>{let{bsPrefix:r,closeLabel:n="Close",closeVariant:l,closeButton:i=!0,className:s,children:c,...d}=e;r=(0,h.vE)(r,"toast-header");let p=(0,a.useContext)(m),x=(0,v.Z)(e=>{null==p||null==p.onClose||p.onClose(e)});return(0,u.jsxs)("div",{ref:t,...d,className:o()(r,s),children:[c,i&&(0,u.jsx)(f.Z,{"aria-label":n,variant:l,onClick:x,"data-dismiss":"toast"})]})});p.displayName="ToastHeader";var x=(0,r(499).Z)("toast-body");let g=a.forwardRef((e,t)=>{let{bsPrefix:r,className:n,transition:i=d,show:s=!0,animation:c=!0,delay:v=5e3,autohide:f=!1,onClose:p,bg:x,...g}=e;r=(0,h.vE)(r,"toast");let k=(0,a.useRef)(v),y=(0,a.useRef)(p);(0,a.useEffect)(()=>{k.current=v,y.current=p},[v,p]);let j=(0,l.Z)(),b=!!(f&&s),N=(0,a.useCallback)(()=>{b&&(null==y.current||y.current())},[b]);(0,a.useEffect)(()=>{j.set(N,k.current)},[j,N]);let O=(0,a.useMemo)(()=>({onClose:p}),[p]),Z=!!(i&&c),S=(0,u.jsx)("div",{...g,ref:t,className:o()(r,n,x&&"bg-".concat(x),!Z&&(s?"show":"hide")),role:"alert","aria-live":"assertive","aria-atomic":"true"});return(0,u.jsx)(m.Provider,{value:O,children:Z&&i?(0,u.jsx)(i,{in:s,unmountOnExit:!0,children:S}):S})});g.displayName="Toast";var k=Object.assign(g,{Body:x,Header:p})},9023:function(e,t,r){"use strict";var a=r(4440),n=r.n(a),o=r(2265),l=r(6376),i=r(7437);let s={"top-start":"top-0 start-0","top-center":"top-0 start-50 translate-middle-x","top-end":"top-0 end-0","middle-start":"top-50 start-0 translate-middle-y","middle-center":"top-50 start-50 translate-middle","middle-end":"top-50 end-0 translate-middle-y","bottom-start":"bottom-0 start-0","bottom-center":"bottom-0 start-50 translate-middle-x","bottom-end":"bottom-0 end-0"},u=o.forwardRef((e,t)=>{let{bsPrefix:r,position:a,containerPosition:o,className:u,as:c="div",...d}=e;return r=(0,l.vE)(r,"toast-container"),(0,i.jsx)(c,{ref:t,...d,className:n()(r,a&&s[a],o&&"position-".concat(o),u)})});u.displayName="ToastContainer",t.Z=u}},function(e){e.O(0,[701,331,521,8,481,508,946,954,971,596,744],function(){return e(e.s=9003)}),_N_E=e.O()}]);