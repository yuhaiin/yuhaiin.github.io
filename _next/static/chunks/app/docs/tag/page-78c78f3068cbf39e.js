(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[163],{7809:(e,t,a)=>{Promise.resolve().then(a.bind(a,3129))},3129:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>I});var n=a(5155),r=a(3577),s=a(1936),l=a(5554),o=a.n(l),i=a(2115),d=a(57),c=a(1566),h=a(2963),u=a(2981),g=a(0),v=a(3614),m=a(8627),f=a(2926),x=a(6180),b=a(4995),p=a(9169),j=a(8927),A=a(148),y=a(4778),C=a(9969),w=a(1649);let N=e=>(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(g.A,{show:e.show,onHide:()=>{e.onHide()},children:[(0,n.jsx)(g.A.Header,{closeButton:!0,children:e.tag.tag}),(0,n.jsxs)(g.A.Body,{children:[(0,n.jsxs)(v.A,{className:"mb-3 d-flex",children:[(0,n.jsx)(m.A,{id:"toggle-node",type:"radio",variant:"outline-primary",value:w.mm.node,onChange:()=>{e.tag.type=w.mm.node,e.onChangeTag(e.tag)},checked:e.tag.type===w.mm.node,children:"Node"}),(0,n.jsx)(m.A,{id:"toggle-mirror",type:"radio",variant:"outline-primary",value:w.mm.mirror,onChange:()=>{e.tag.type=w.mm.mirror,e.onChangeTag(e.tag)},checked:e.tag.type===w.mm.mirror,children:"Mirror"})]}),e.new&&(0,n.jsx)(f.A,{label:"Tag",className:"mb-2",children:(0,n.jsx)(x.A.Control,{placeholder:"Tag","aria-label":"Tag","aria-describedby":"basic-addon1",value:e.tag.tag,onChange:t=>{e.tag.tag=t.target.value,e.onChangeTag(e.tag)}})}),e.tag.type==w.mm.mirror?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(O,{data:e.data,value:e.tag.hash,onChangeMirror:t=>{e.tag.hash=t,e.onChangeTag(e.tag)}})}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(E,{data:e.nodes,hash:e.tag.hash,onChangeNode:t=>{e.tag.hash=t,e.onChangeTag(e.tag)}})})]}),(0,n.jsxs)(g.A.Footer,{children:[(0,n.jsx)(h.A,{variant:"outline-secondary",onClick:()=>{e.onHide()},children:"Close"}),(0,n.jsx)(h.A,{variant:"outline-primary",onClick:()=>{e.onSave()},children:"Save"})]})]})}),k=(e,t)=>{if(void 0===t||""===e)return"";for(let a in t.groups)for(let n in t.groups[a].nodesV2)if(t.groups[a].nodesV2[n]===e)return a;return""},E=e=>{var t,a;let[r,s]=(0,i.useState)({data:k(e.hash,e.data)});return(0,i.useEffect)(()=>{s({data:k(e.hash,e.data)})},[e.hash,e.data]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.A,{label:"Group",className:"mb-2",children:(0,n.jsxs)(x.A.Select,{defaultValue:r.data,onChange:e=>s({data:e.target.value}),children:[(0,n.jsx)("option",{children:"Choose..."}),Object.keys(e.data?e.data.groups:{}).sort((e,t)=>e<=t?-1:1).map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})}),(0,n.jsx)(f.A,{label:"Node",className:"mb-2",children:(0,n.jsxs)(x.A.Select,{defaultValue:e.hash,onChange:t=>{e.onChangeNode(t.target.value)},children:[(0,n.jsx)("option",{value:"",children:"Choose..."}),Object.entries(e.data&&null!==(a=null===(t=e.data.groups[r.data])||void 0===t?void 0:t.nodesV2)&&void 0!==a?a:{}).sort((e,t)=>e<=t?-1:1).map(e=>{let[t,a]=e;return(0,n.jsx)("option",{value:a,children:t},t)})]})})]})},O=e=>(0,n.jsx)(f.A,{label:"Mirror",className:"mb-2",children:(0,n.jsxs)(x.A.Select,{defaultValue:e.value,onChange:t=>{e.onChangeMirror(t.target.value)},children:[(0,n.jsx)("option",{value:"",children:"Choose..."}),Object.keys(e.data.tags).sort((e,t)=>e<=t?-1:1).map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})}),I=function(){let e=(0,i.useContext)(A.u),{data:t,error:a,isLoading:l,mutate:g}=(0,b.Ay)("/tags",(0,j.AD)(C.Tc.method.list)),{data:v}=(0,b.Ay)("/nodes",(0,j.AD)(C.rH.method.list)),[m,f]=(0,i.useState)({hash:"",show:!1}),[x,k]=(0,i.useState)({show:!1,tag:(0,r.v)(C.hf,{tag:"",hash:"",type:w.mm.node}),new:!0});if(void 0!==a)return(0,n.jsx)(o(),{statusCode:a.code,title:a.msg});if(l||void 0==t)return(0,n.jsx)(p.A,{});let E=t=>(0,n.jsxs)(d.A.Item,{className:"align-items-center d-flex justify-content-between",style:{border:"0ch",borderBottom:"1px solid #dee2e6"},action:!0,onClick:e=>{k({show:!0,tag:(0,r.v)(C.hf,{tag:t.k,hash:t.v.hash[0],type:t.v.type}),new:!1})},children:[(0,n.jsxs)("div",{children:[t.k,(0,n.jsx)(c.A,{className:"rounded-pill bg-light text-dark ms-1",children:0===t.v.hash.length||""===t.v.hash[0]?(0,n.jsxs)(n.Fragment,{children:["Fallback ",(0,n.jsx)("i",{className:"bi bi-heart-arrow"})," Global"]}):t.v.type===w.mm.mirror?(0,n.jsxs)(n.Fragment,{children:["Mirror ",(0,n.jsx)("i",{className:"bi bi-arrow-right"})," ",t.v.hash]}):(0,n.jsxs)(n.Fragment,{children:["Target ",(0,n.jsx)("i",{className:"bi bi-arrow-right"}),(0,n.jsx)("a",{className:"text-truncate",href:"#",onClick:e=>{e.preventDefault(),e.stopPropagation(),f({hash:t.v.hash[0],show:!0})},children:t.v.hash})]})})]}),(0,n.jsx)(h.A,{variant:"outline-danger",as:"span",size:"sm",onClick:a=>{a.stopPropagation(),(0,j.kP)(C.Tc.method.remove,"/tag","DELETE",(0,r.v)(s.g8,{value:t.k})).then(async a=>{let{error:n}=a;void 0!==n?e.Error("delete tag ".concat(t.k," failed, ").concat(n.code,"| ").concat(n.msg)):(e.Info("delete tag ".concat(t.k," success")),await g())})},children:(0,n.jsx)("i",{className:"bi-trash"})})]},t.k);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.y,{show:m.show,hash:m.hash,onHide:()=>f({...m,show:!1})}),(0,n.jsx)(N,{show:x.show,nodes:v,data:t,tag:x.tag,onChangeTag:e=>k({...x,tag:e}),new:x.new,onHide:()=>k({...x,show:!1}),onSave:()=>{""!==x.tag.tag&&""!==x.tag.hash&&(0,j.kP)(C.Tc.method.save,"/tag","POST",x.tag).then(async t=>{let{error:a}=t;void 0!==a?e.Error("save tag ".concat(x.tag.tag," failed, ").concat(a.code,"| ").concat(a.msg)):(e.Info("Set tag ".concat(x.tag.tag," to ").concat(x.tag.hash," successful")),await g()),k({...x,show:!1})})}}),(0,n.jsx)(u.A,{className:"mb-3",children:(0,n.jsxs)(d.A,{variant:"flush",children:[Object.entries(t.tags).sort((e,t)=>e<=t?-1:1).map(e=>{let[t,a]=e;return(0,n.jsx)(E,{k:t,v:(0,r.v)(w.xN,a)},t)}),(0,n.jsx)(d.A.Item,{className:"d-sm-flex",children:(0,n.jsxs)(h.A,{variant:"outline-success",className:"flex-grow-1",onClick:()=>k({show:!0,tag:(0,r.v)(C.hf,{tag:"new tag",hash:"",type:w.mm.node}),new:!0}),children:[(0,n.jsx)("i",{className:"bi bi-plus-lg"}),"New"]})})]})})]})}},9814:(e,t,a)=>{"use strict";a.d(t,{A:()=>x});var n=a(2819),r=a(2115),s=a(5418),l=a(1194),o=a(2257),i=a(7644),d=a(8419),c=a(4672),h=a(3973),u=a(5155);let g=["as","onSelect","activeKey","role","onKeyDown"],v=()=>{},m=(0,c.sE)("event-key"),f=r.forwardRef((e,t)=>{let a,h,{as:f="div",onSelect:x,activeKey:b,role:p,onKeyDown:j}=e,A=function(e,t){if(null==e)return{};var a={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;a[n]=e[n]}return a}(e,g),y=(0,s.A)(),C=(0,r.useRef)(!1),w=(0,r.useContext)(i.A),N=(0,r.useContext)(d.A);N&&(p=p||"tablist",b=N.activeKey,a=N.getControlledId,h=N.getControllerId);let k=(0,r.useRef)(null),E=e=>{let t=k.current;if(!t)return null;let a=(0,n.A)(t,`[${m}]:not([aria-disabled=true])`),r=t.querySelector("[aria-selected=true]");if(!r||r!==document.activeElement)return null;let s=a.indexOf(r);if(-1===s)return null;let l=s+e;return l>=a.length&&(l=0),l<0&&(l=a.length-1),a[l]},O=(e,t)=>{null!=e&&(null==x||x(e,t),null==w||w(e,t))};(0,r.useEffect)(()=>{if(k.current&&C.current){let e=k.current.querySelector(`[${m}][aria-selected=true]`);null==e||e.focus()}C.current=!1});let I=(0,l.A)(t,k);return(0,u.jsx)(i.A.Provider,{value:O,children:(0,u.jsx)(o.A.Provider,{value:{role:p,activeKey:(0,i.u)(b),getControlledId:a||v,getControllerId:h||v},children:(0,u.jsx)(f,Object.assign({},A,{onKeyDown:e=>{let t;if(null==j||j(e),N){switch(e.key){case"ArrowLeft":case"ArrowUp":t=E(-1);break;case"ArrowRight":case"ArrowDown":t=E(1);break;default:return}t&&(e.preventDefault(),O(t.dataset[(0,c.y)("EventKey")]||null,e),C.current=!0,y())}},ref:I,role:p}))})})});f.displayName="Nav";let x=Object.assign(f,{Item:h.A})},3973:(e,t,a)=>{"use strict";a.d(t,{A:()=>v,M:()=>u});var n=a(2115),r=a(8447),s=a(2257),l=a(7644),o=a(2773),i=a(4672),d=a(8419),c=a(5155);let h=["as","active","eventKey"];function u({key:e,onClick:t,active:a,id:o,role:c,disabled:h}){let u=(0,n.useContext)(l.A),g=(0,n.useContext)(s.A),v=(0,n.useContext)(d.A),m=a,f={role:c};if(g){c||"tablist"!==g.role||(f.role="tab");let t=g.getControllerId(null!=e?e:null),n=g.getControlledId(null!=e?e:null);f[(0,i.sE)("event-key")]=e,f.id=t||o,((m=null==a&&null!=e?g.activeKey===e:a)||!(null!=v&&v.unmountOnExit)&&!(null!=v&&v.mountOnEnter))&&(f["aria-controls"]=n)}return"tab"===f.role&&(f["aria-selected"]=m,m||(f.tabIndex=-1),h&&(f.tabIndex=-1,f["aria-disabled"]=!0)),f.onClick=(0,r.A)(a=>{h||(null==t||t(a),null!=e&&u&&!a.isPropagationStopped()&&u(e,a))}),[f,{isActive:m}]}let g=n.forwardRef((e,t)=>{let{as:a=o.Ay,active:n,eventKey:r}=e,s=function(e,t){if(null==e)return{};var a={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;a[n]=e[n]}return a}(e,h),[d,g]=u(Object.assign({key:(0,l.u)(r,s.href),active:n},s));return d[(0,i.sE)("active")]=g.isActive,(0,c.jsx)(a,Object.assign({},s,d,{ref:t}))});g.displayName="NavItem";let v=g},8419:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});let n=a(2115).createContext(null)},1566:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var n=a(4617),r=a.n(n),s=a(2115),l=a(1653),o=a(5155);let i=s.forwardRef((e,t)=>{let{bsPrefix:a,bg:n="primary",pill:s=!1,text:i,className:d,as:c="span",...h}=e,u=(0,l.oU)(a,"badge");return(0,o.jsx)(c,{ref:t,...h,className:r()(d,u,s&&"rounded-pill",i&&"text-".concat(i),n&&"bg-".concat(n))})});i.displayName="Badge";let d=i},8143:(e,t,a)=>{"use strict";a.d(t,{A:()=>v});var n=a(2115),r=a(1996),s=a.n(r),l=a(9637),o=a(5570),i=a(3381);let d=s().oneOf(["start","end"]),c=s().oneOfType([d,s().shape({sm:d}),s().shape({md:d}),s().shape({lg:d}),s().shape({xl:d}),s().shape({xxl:d}),s().object]);var h=a(5155);let u={id:s().string,href:s().string,onClick:s().func,title:s().node.isRequired,disabled:s().bool,align:c,menuRole:s().string,renderMenuOnMount:s().bool,rootCloseEvent:s().string,menuVariant:s().oneOf(["dark"]),flip:s().bool,bsPrefix:s().string,variant:s().string,size:s().string},g=n.forwardRef((e,t)=>{let{title:a,children:n,bsPrefix:r,rootCloseEvent:s,variant:d,size:c,menuRole:u,renderMenuOnMount:g,disabled:v,href:m,id:f,menuVariant:x,flip:b,...p}=e;return(0,h.jsxs)(l.A,{ref:t,...p,children:[(0,h.jsx)(o.A,{id:f,href:m,size:c,variant:d,disabled:v,childBsPrefix:r,children:a}),(0,h.jsx)(i.A,{role:u,renderOnMount:g,rootCloseEvent:s,variant:x,flip:b,children:n})]})});g.displayName="DropdownButton",g.propTypes=u;let v=g},57:(e,t,a)=>{"use strict";a.d(t,{A:()=>m});var n=a(4617),r=a.n(n),s=a(2115);a(1809);var l=a(6647),o=a(9814),i=a(1653),d=a(3853),c=a(3973),h=a(7644),u=a(5155);let g=s.forwardRef((e,t)=>{let{bsPrefix:a,active:n,disabled:s,eventKey:l,className:o,variant:g,action:v,as:m,...f}=e;a=(0,i.oU)(a,"list-group-item");let[x,b]=(0,c.M)({key:(0,h.u)(l,f.href),active:n,...f}),p=(0,d.A)(e=>{if(s){e.preventDefault(),e.stopPropagation();return}x.onClick(e)});s&&void 0===f.tabIndex&&(f.tabIndex=-1,f["aria-disabled"]=!0);let j=m||(v?f.href?"a":"button":"div");return(0,u.jsx)(j,{ref:t,...f,...x,onClick:p,className:r()(o,a,b.isActive&&"active",s&&"disabled",g&&"".concat(a,"-").concat(g),v&&"".concat(a,"-action"))})});g.displayName="ListGroupItem";let v=s.forwardRef((e,t)=>{let a;let{className:n,bsPrefix:s,variant:d,horizontal:c,numbered:h,as:g="div",...v}=(0,l.Zw)(e,{activeKey:"onSelect"}),m=(0,i.oU)(s,"list-group");return c&&(a=!0===c?"horizontal":"horizontal-".concat(c)),(0,u.jsx)(o.A,{ref:t,...v,as:g,className:r()(n,m,d&&"".concat(m,"-").concat(d),a&&"".concat(m,"-").concat(a),h&&"".concat(m,"-numbered"))})});v.displayName="ListGroup";let m=Object.assign(v,{Item:g})},8627:(e,t,a)=>{"use strict";a.d(t,{A:()=>h});var n=a(4617),r=a.n(n),s=a(2115),l=a(1653),o=a(2963),i=a(5155);let d=()=>void 0,c=s.forwardRef((e,t)=>{let{bsPrefix:a,name:n,className:s,checked:c,type:h,onChange:u,value:g,disabled:v,id:m,inputRef:f,...x}=e;return a=(0,l.oU)(a,"btn-check"),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",{className:a,name:n,type:h,value:g,ref:f,autoComplete:"off",checked:!!c,disabled:!!v,onChange:u||d,id:m}),(0,i.jsx)(o.A,{...x,ref:t,className:r()(s,v&&"disabled"),type:void 0,role:void 0,as:"label",htmlFor:m})]})});c.displayName="ToggleButton";let h=c},3620:(e,t,a)=>{"use strict";a.d(t,{U:()=>n});let n=(0,a(6788).w)("Ch5nb29nbGUvcHJvdG9idWYvZHVyYXRpb24ucHJvdG8SD2dvb2dsZS5wcm90b2J1ZiIqCghEdXJhdGlvbhIPCgdzZWNvbmRzGAEgASgDEg0KBW5hbm9zGAIgASgFQoMBChNjb20uZ29vZ2xlLnByb3RvYnVmQg1EdXJhdGlvblByb3RvUAFaMWdvb2dsZS5nb2xhbmcub3JnL3Byb3RvYnVmL3R5cGVzL2tub3duL2R1cmF0aW9ucGL4AQGiAgNHUEKqAh5Hb29nbGUuUHJvdG9idWYuV2VsbEtub3duVHlwZXNiBnByb3RvMw")}},e=>{var t=t=>e(e.s=t);e.O(0,[295,375,515,920,637,340,57,214,922,969,778,441,517,358],()=>t(7809)),_N_E=e.O()}]);