(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9966],{5294:(e,a,t)=>{Promise.resolve().then(t.bind(t,1813))},1159:(e,a,t)=>{"use strict";t.d(a,{P:()=>l,t:()=>i});var s=t(7437),n=t(2265),o=t(8620),r=t(1529);let l=(0,n.createContext)({Info:e=>{},Error:e=>{}}),i=e=>{let{children:a}=e,[t,i]=(0,n.useState)({value:{},index:0}),d=(e,a)=>i(t=>({value:{...t.value,[t.index]:{text:e,type:a}},index:t.index+1}));return(0,s.jsxs)(l.Provider,{value:{Info:e=>{console.log(e),d(e,"success")},Error:e=>{console.error(e),d(e,"danger")}},children:[(0,s.jsx)(o.Z,{className:"p-3",position:"top-center",containerPosition:"fixed",style:{zIndex:999999},children:Object.entries(t.value).map(e=>{let[a,n]=e;return(0,s.jsxs)(r.Z,{role:"alert","aria-live":"assertive",show:!0,bg:n.type,onClose:()=>{let e=t.value;delete e[a],i({...t,value:e}),console.log("close: "+a)},"aria-atomic":"true",delay:4e3,autohide:!0,animation:!0,children:[(0,s.jsxs)(r.Z.Header,{children:[(0,s.jsx)("strong",{className:"me-auto",children:"Notification"}),(0,s.jsx)("small",{className:"text-muted",children:"just now"})]}),(0,s.jsx)(r.Z.Body,{className:"text-center",children:n.text})]},"toast"+a)})}),a]})}},1813:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>F});var s=t(7437),n=t(2265),o=t(4694),r=t(2098),l=t(2808),i=t(7185),d=t(8136),h=t(3181),c=t(844),g=t(5374),u=t(7420),x=t(716),m=t(1617),j=t(879),v=t(6264),p=t.n(v),b=t(1159),f=t(3056),w=t(5077),C=t(256),y=t(8537),N=t(6878),Z=t(3168);let k=(0,t(7818).default)(()=>Promise.all([t.e(5554),t.e(6361),t.e(4882),t.e(4956),t.e(7833),t.e(1105)]).then(t.bind(t,7833)).then(e=>e.NodeModal),{loadableGenerated:{webpack:()=>[7833]},ssr:!1}),S=e=>(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(d.Z,{show:e.show,onHide:()=>{e.onHide()},children:[(0,s.jsx)(d.Z.Header,{closeButton:!0,children:e.tag.tag}),(0,s.jsxs)(d.Z.Body,{children:[(0,s.jsxs)(h.Z,{className:"mb-3 d-flex",children:[(0,s.jsx)(c.Z,{id:"toggle-node",type:"radio",variant:"outline-primary",value:w.fY.node,onChange:()=>{e.tag.type=w.fY.node,e.onChangeTag(e.tag)},checked:e.tag.type===w.fY.node,children:"Node"}),(0,s.jsx)(c.Z,{id:"toggle-mirror",type:"radio",variant:"outline-primary",value:w.fY.mirror,onChange:()=>{e.tag.type=w.fY.mirror,e.onChangeTag(e.tag)},checked:e.tag.type===w.fY.mirror,children:"Mirror"})]}),e.new&&(0,s.jsx)(g.Z,{label:"Tag",className:"mb-2",children:(0,s.jsx)(u.Z.Control,{placeholder:"Tag","aria-label":"Tag","aria-describedby":"basic-addon1",value:e.tag.tag,onChange:a=>{e.tag.tag=a.target.value,e.onChangeTag(e.tag)}})}),e.tag.type==w.fY.mirror?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(E,{data:e.data,value:e.tag.hash,onChangeMirror:a=>{e.tag.hash=a,e.onChangeTag(e.tag)}})}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(T,{data:e.data,hash:e.tag.hash,onChangeNode:a=>{e.tag.hash=a,e.onChangeTag(e.tag)}})})]}),(0,s.jsxs)(d.Z.Footer,{children:[(0,s.jsx)(l.Z,{variant:"outline-secondary",onClick:()=>{e.onHide()},children:"Close"}),(0,s.jsx)(l.Z,{variant:"outline-primary",onClick:()=>{e.onSave()},children:"Save"})]})]})}),T=e=>{var a,t,o,r;let[l,i]=(0,n.useState)({data:null!==(o=null===(a=e.data.nodes[e.hash])||void 0===a?void 0:a.group)&&void 0!==o?o:""});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.Z,{label:"Group",className:"mb-2",children:(0,s.jsxs)(u.Z.Select,{defaultValue:l.data,onChange:e=>i({data:e.target.value}),children:[(0,s.jsx)("option",{children:"Choose..."}),Object.keys(e.data.groupsV2).sort((e,a)=>e<=a?-1:1).map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})}),(0,s.jsx)(g.Z,{label:"Node",className:"mb-2",children:(0,s.jsxs)(u.Z.Select,{defaultValue:e.hash,onChange:a=>{e.onChangeNode(a.target.value)},children:[(0,s.jsx)("option",{value:"",children:"Choose..."}),Object.entries(null!==(r=null===(t=e.data.groupsV2[l.data])||void 0===t?void 0:t.nodesV2)&&void 0!==r?r:{}).sort((e,a)=>e<=a?-1:1).map(e=>{let[a,t]=e;return(0,s.jsx)("option",{value:t,children:a},a)})]})})]})},E=e=>(0,s.jsx)(g.Z,{label:"Mirror",className:"mb-2",children:(0,s.jsxs)(u.Z.Select,{defaultValue:e.value,onChange:a=>{e.onChangeMirror(a.target.value)},children:[(0,s.jsx)("option",{value:"",children:"Choose..."}),Object.keys(e.data.tags).sort((e,a)=>e<=a?-1:1).map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})}),F=function(){let e=(0,n.useContext)(b.P),{data:a,error:t,isLoading:d,mutate:h}=(0,m.ZP)("/nodes",(0,j.D4)(C.Jq)),[c,g]=(0,n.useState)({hash:"",show:!1}),[u,v]=(0,n.useState)({show:!1,tag:(0,y.U)(f.A9,{tag:"",hash:"",type:w.fY.node}),new:!0});if(void 0!==t)return(0,s.jsx)(p(),{statusCode:t.code,title:t.msg});if(d||void 0==a)return(0,s.jsx)(x.Z,{});let T=a=>(0,s.jsxs)(o.Z.Item,{className:"align-items-center d-flex justify-content-between",style:{border:"0ch",borderBottom:"1px solid #dee2e6"},action:!0,onClick:e=>{v({show:!0,tag:(0,y.U)(f.A9,{tag:a.k,hash:a.v.hash[0],type:a.v.type}),new:!1})},children:[(0,s.jsxs)("div",{children:[a.k,(0,s.jsx)(r.Z,{className:"rounded-pill bg-light text-dark ms-1",children:0===a.v.hash.length||""===a.v.hash[0]?(0,s.jsxs)(s.Fragment,{children:["Fallback ",(0,s.jsx)("i",{className:"bi bi-heart-arrow"})," Global"]}):a.v.type===w.fY.mirror?(0,s.jsxs)(s.Fragment,{children:["Mirror ",(0,s.jsx)("i",{className:"bi bi-arrow-right"})," ",a.v.hash]}):(0,s.jsxs)(s.Fragment,{children:["Target ",(0,s.jsx)("i",{className:"bi bi-arrow-right"}),(0,s.jsx)("a",{className:"text-truncate",href:"#",onClick:e=>{e.preventDefault(),e.stopPropagation(),g({hash:a.v.hash[0],show:!0})},children:a.v.hash})]})})]}),(0,s.jsx)(l.Z,{variant:"outline-danger",as:"span",size:"sm",onClick:t=>{t.stopPropagation(),(0,j.Uo)("/tag",{method:"DELETE",body:(0,N.O)(Z.mV,(0,y.U)(Z.mV,{value:a.k}))}).then(async t=>{let{error:s}=t;void 0!==s?e.Error("delete tag ".concat(a.k," failed, ").concat(s.code,"| ").concat(await s.msg)):(e.Info("delete tag ".concat(a.k," success")),await h())})},children:(0,s.jsx)("i",{className:"bi-trash"})})]},a.k);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(k,{show:c.show,hash:c.hash,onHide:()=>g({...c,hash:"",show:!1})}),(0,s.jsx)(S,{show:u.show,data:a,tag:u.tag,onChangeTag:e=>v({...u,tag:e}),new:u.new,onHide:()=>v({...u,show:!1}),onSave:()=>{""!==u.tag.tag&&""!==u.tag.hash&&(0,j.Uo)("/tag",{body:(0,N.O)(f.A9,u.tag)}).then(async a=>{let{error:t}=a;void 0!==t?e.Error("save tag ".concat(u.tag.tag," failed, ").concat(t.code,"| ").concat(await t.msg)):(e.Info("Set tag ".concat(u.tag.tag," to ").concat(u.tag.hash," successful")),await h()),v({...u,show:!1})})}}),(0,s.jsx)(i.Z,{className:"mb-3",children:(0,s.jsxs)(o.Z,{variant:"flush",children:[Object.entries(a.tags).sort((e,a)=>e<=a?-1:1).map(e=>{let[a,t]=e;return(0,s.jsx)(T,{k:a,v:(0,y.U)(w.td,t)},a)}),(0,s.jsx)(o.Z.Item,{className:"d-sm-flex",children:(0,s.jsxs)(l.Z,{variant:"outline-success",className:"flex-grow-1",onClick:()=>v({show:!0,tag:(0,y.U)(f.A9,{tag:"new tag",hash:"",type:w.fY.node}),new:!0}),children:[(0,s.jsx)("i",{className:"bi bi-plus-lg"}),"New"]})})]})})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[8817,1617,548,9768,6389,6166,246,2202,6784,7130,6215,1744],()=>a(5294)),_N_E=e.O()}]);