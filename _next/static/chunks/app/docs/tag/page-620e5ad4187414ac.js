(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[966],{5120:function(e,a,t){Promise.resolve().then(t.bind(t,4997))},4997:function(e,a,t){"use strict";t.r(a);var s=t(7437),n=t(2265),r=t(6879),l=t(4297),o=t(3518),c=t(51),i=t(733),h=t(3508),d=t(5503),u=t(1308),x=t(780),m=t(8324),j=t(9445),p=t(713),g=t(6934),b=t(1375),f=t.n(b),v=t(6168),Z=t(6347),y=t(7684);a.default=function(){let e=(0,n.useContext)(Z.P),[a,t]=(0,n.useState)(""),[b,C]=(0,n.useState)({tag:"",hash:"",type:m.fY.node}),{data:N,error:k,isLoading:w,mutate:E}=(0,p.ZP)("/nodes",(0,g.hW)(j.BP)),[S,O]=(0,n.useState)({hash:""});if(void 0!==k)return(0,s.jsx)(f(),{statusCode:k.code,title:k.msg});if(w||void 0==N)return(0,s.jsx)(u.Z,{});let T=(a,t)=>(0,s.jsx)(d.Z.Item,{style:{border:"0ch",borderBottom:"1px solid #dee2e6"},children:(0,s.jsxs)("div",{className:"d-flex flex-wrap",children:[(0,s.jsx)("a",{className:"text-decoration-none",href:"#empty",onClick:e=>{e.preventDefault(),C(e=>({...e,tag:a}))},children:a}),(0,s.jsx)(r.Z,{className:"rounded-pill bg-light text-dark text-truncate ms-1",children:0===t.hash.length||""===t.hash[0]?(0,s.jsxs)(s.Fragment,{children:["Fallback ",(0,s.jsx)("i",{className:"bi bi-heart-arrow"})," Global"]}):t.type===m.fY.mirror?(0,s.jsxs)(s.Fragment,{children:["Mirror ",(0,s.jsx)("i",{className:"bi bi-arrow-right"})," ",t.hash]}):(0,s.jsxs)(s.Fragment,{children:["Target ",(0,s.jsx)("i",{className:"bi bi-arrow-right"}),(0,s.jsx)("a",{className:"text-truncate",href:"#",onClick:e=>{e.preventDefault(),O({hash:t.hash[0]})},children:t.hash})]})}),(0,s.jsxs)("a",{className:"text-decoration-none ms-auto text-truncate",href:"#empty",onClick:t=>{t.preventDefault(),(0,g.Uo)("/tag",{method:"DELETE",body:y.Gm.encode({value:a}).finish()}).then(async t=>{let{error:s}=t;void 0!==s?e.Error("delete tag ".concat(a," failed, ").concat(s.code,"| ").concat(await s.msg)):(e.Info("delete tag ".concat(a," success")),await E())})},children:[(0,s.jsx)("i",{className:"bi-trash"}),"DELETE"]})]})},a);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.Z,{show:""!==S.hash,hash:S.hash,onHide:()=>O({hash:""})}),(0,s.jsx)(o.Z,{className:"mb-3",children:(0,s.jsx)(d.Z,{variant:"flush",children:Object.entries(N.tags).sort((e,a)=>e<=a?-1:1).map(e=>{let[a,t]=e;return T(a,t)})})}),(0,s.jsx)(o.Z,{className:"mb-3",children:(0,s.jsxs)(o.Z.Body,{children:[(0,s.jsxs)(h.Z,{className:"mb-3",children:[(0,s.jsx)(i.Z.Check,{inline:!0,type:"radio",onChange:()=>{C(e=>({...e,type:m.fY.node,hash:""}))},checked:b.type===m.fY.node,label:"Node"}),(0,s.jsx)(i.Z.Check,{inline:!0,type:"radio",onChange:()=>{C(e=>({...e,type:m.fY.mirror,hash:""}))},checked:b.type===m.fY.mirror,label:"Mirror"})]}),(0,s.jsx)(c.Z,{label:"Tag",className:"mb-2",children:(0,s.jsx)(i.Z.Control,{placeholder:"Tag","aria-label":"Tag","aria-describedby":"basic-addon1",value:b.tag,onChange:e=>{C(a=>({...a,tag:e.target.value}))}})}),b.type===m.fY.node?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Z,{label:"Group",className:"mb-2",children:(0,s.jsxs)(i.Z.Select,{defaultValue:"",onChange:e=>t(e.target.value),children:[(0,s.jsx)("option",{children:"Choose..."}),Object.keys(N.groupsV2).sort((e,a)=>e<=a?-1:1).map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})}),(0,s.jsx)(c.Z,{label:"Node",className:"mb-2",children:(0,s.jsxs)(i.Z.Select,{defaultValue:"",onChange:e=>{C(a=>({...a,hash:e.target.value}))},children:[(0,s.jsx)("option",{value:"",children:"Choose..."}),Object.entries(void 0!==N.groupsV2[a]?N.groupsV2[a].nodesV2:{}).sort((e,a)=>e<=a?-1:1).map(e=>{let[a,t]=e;return(0,s.jsx)("option",{value:t,children:a},a)})]})})]}):(0,s.jsx)(c.Z,{label:"Mirror",className:"mb-2",children:(0,s.jsxs)(i.Z.Select,{defaultValue:"",onChange:e=>{C(a=>({...a,hash:e.target.value}))},children:[(0,s.jsx)("option",{value:"",children:"Choose..."}),Object.keys(N.tags).sort((e,a)=>e<=a?-1:1).map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})}),(0,s.jsx)(l.Z,{variant:"outline-primary",onClick:()=>{""!==b.tag&&""!==b.hash&&(0,g.Uo)("/tag",{body:x.hr.encode(b).finish()}).then(async a=>{let{error:t}=a;void 0!==t?e.Error("save tag ".concat(b.tag," failed, ").concat(t.code,"| ").concat(await t.msg)):(e.Info("Set tag ".concat(b.tag," to ").concat(b.hash," successful")),await E())})},children:"Save"})]})})]})}},3508:function(e,a,t){"use strict";var s=t(4440),n=t.n(s),r=t(2265),l=t(499),o=t(6376),c=t(9062),i=t(7447),h=t(7437);let d=(0,l.Z)("input-group-text",{Component:"span"}),u=r.forwardRef((e,a)=>{let{bsPrefix:t,size:s,hasValidation:l,className:c,as:d="div",...u}=e;t=(0,o.vE)(t,"input-group");let x=(0,r.useMemo)(()=>({}),[]);return(0,h.jsx)(i.Z.Provider,{value:x,children:(0,h.jsx)(d,{ref:a,...u,className:n()(c,t,s&&"".concat(t,"-").concat(s),l&&"has-validation")})})});u.displayName="InputGroup",a.Z=Object.assign(u,{Text:d,Radio:e=>(0,h.jsx)(d,{children:(0,h.jsx)(c.Z,{type:"radio",...e})}),Checkbox:e=>(0,h.jsx)(d,{children:(0,h.jsx)(c.Z,{type:"checkbox",...e})})})},7447:function(e,a,t){"use strict";var s=t(2265);let n=s.createContext(null);n.displayName="InputGroupContext",a.Z=n}},function(e){e.O(0,[359,441,331,895,8,508,946,874,236,168,445,971,596,744],function(){return e(e.s=5120)}),_N_E=e.O()}]);