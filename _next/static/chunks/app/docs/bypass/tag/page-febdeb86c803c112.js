(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1026],{1262:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let n=a(12115),r=n.useLayoutEffect,s=n.useEffect;function o(e){let{headManager:t,reduceComponentsToState:a}=e;function o(){if(t&&t.mountedInstances){let r=n.Children.toArray(Array.from(t.mountedInstances).filter(Boolean));t.updateHead(a(r,e))}}return r(()=>{var a;return null==t||null==(a=t.mountedInstances)||a.add(e.children),()=>{var a;null==t||null==(a=t.mountedInstances)||a.delete(e.children)}}),r(()=>(t&&(t._pendingUpdate=o),()=>{t&&(t._pendingUpdate=o)})),s(()=>(t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null),()=>{t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null)})),null}},19438:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>P});var n=a(95155),r=a(47319),s=a(95302),o=a(56696),l=a.n(o),i=a(12115),d=a(79039),c=a(40574),h=a(36947),u=a(41531),g=a(63678),p=a(65022),m=a(45811),f=a(40705),x=a(22452),j=a(22523),y=a(50379),b=a(46057),v=a(30281),w=a(94226),C=a(48603),A=a(55174),_=a(16907);let k=e=>(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(g.A,{show:e.show,onHide:()=>{e.onHide()},centered:!0,children:[(0,n.jsx)(g.A.Header,{closeButton:!0,children:e.tag.tag}),(0,n.jsxs)(g.A.Body,{children:[(0,n.jsxs)(p.A,{className:"mb-3 d-flex",children:[(0,n.jsx)(m.A,{id:"toggle-node",type:"radio",variant:"outline-primary",value:_.mm.node,onChange:()=>{e.tag.type=_.mm.node,e.onChangeTag(e.tag)},checked:e.tag.type===_.mm.node,children:"Node"}),(0,n.jsx)(m.A,{id:"toggle-mirror",type:"radio",variant:"outline-primary",value:_.mm.mirror,onChange:()=>{e.tag.type=_.mm.mirror,e.onChangeTag(e.tag)},checked:e.tag.type===_.mm.mirror,children:"Mirror"})]}),e.new&&(0,n.jsx)(f.A,{label:"Tag",className:"mb-2",children:(0,n.jsx)(x.A.Control,{placeholder:"Tag","aria-label":"Tag","aria-describedby":"basic-addon1",value:e.tag.tag,onChange:t=>{e.tag.tag=t.target.value,e.onChangeTag(e.tag)}})}),e.tag.type==_.mm.mirror?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(S,{data:e.data,value:e.tag.hash,onChangeMirror:t=>{e.tag.hash=t,e.onChangeTag(e.tag)}})}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(O,{data:e.nodes,hash:e.tag.hash,onChangeNode:t=>{e.tag.hash=t,e.onChangeTag(e.tag)}})})]}),(0,n.jsxs)(g.A.Footer,{children:[(0,n.jsx)(h.A,{variant:"outline-secondary",onClick:()=>{e.onHide()},children:"Close"}),(0,n.jsx)(h.A,{variant:"outline-primary",onClick:()=>{e.onSave()},children:"Save"})]})]})}),N=(e,t)=>{if(void 0===t||""===e)return"";for(let a in t.groups)for(let n in t.groups[a].nodesV2)if(t.groups[a].nodesV2[n]===e)return a;return""},O=e=>{var t,a;let[r,s]=(0,i.useState)({data:N(e.hash,e.data)});return(0,i.useEffect)(()=>{e.hash&&s({data:N(e.hash,e.data)})},[e.hash,e.data]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.A,{label:"Group",className:"mb-2",children:(0,n.jsx)(v.FX,{emptyChoose:!0,value:r.data,onChange:e=>{s({data:e})},values:Object.keys(e.data?e.data.groups:{}).sort((e,t)=>e<=t?-1:1)})}),(0,n.jsx)(f.A,{label:"Node",children:(0,n.jsx)(v.FX,{emptyChoose:!0,value:e.hash,onChange:t=>{e.onChangeNode(t)},values:Object.entries(e.data&&null!=(a=null==(t=e.data.groups[r.data])?void 0:t.nodesV2)?a:{}).sort((e,t)=>e<=t?-1:1)})})]})},S=e=>(0,n.jsx)(f.A,{label:"Mirror",className:"mb-2",children:(0,n.jsx)(v.FX,{emptyChoose:!0,value:e.value,onChange:t=>{e.onChangeMirror(t)},values:Object.keys(e.data.tags).sort((e,t)=>e<=t?-1:1)})}),P=function(){let e=(0,i.useContext)(w.u),{data:t,error:a,isLoading:o,mutate:g}=(0,b.mp)(A.Tc.method.list),{data:p}=(0,b.mp)(A.rH.method.list),[m,f]=(0,i.useState)({hash:"",show:!1}),[x,v]=(0,i.useState)({show:!1,tag:(0,r.v)(A.hf,{tag:"",hash:"",type:_.mm.node}),new:!0}),[N,O]=(0,i.useState)({show:!1,name:""});if(void 0!==a)return(0,n.jsx)(l(),{statusCode:a.code,title:a.msg});if(o||void 0==t)return(0,n.jsx)(y.A,{});let S=e=>{let{k:t,v:a}=e;return(0,n.jsxs)(d.A.Item,{className:"align-items-center d-flex justify-content-between",style:{border:"0ch",borderBottom:"1px solid #dee2e6"},action:!0,onClick:()=>{v({show:!0,tag:(0,r.v)(A.hf,{tag:t,hash:a.hash[0],type:a.type}),new:!1})},children:[(0,n.jsxs)("div",{children:[t,(0,n.jsx)(c.A,{className:"rounded-pill bg-light text-dark ms-1",children:0===a.hash.length||""===a.hash[0]?(0,n.jsxs)(n.Fragment,{children:["Fallback ",(0,n.jsx)("i",{className:"bi bi-heart-arrow"})," Global"]}):a.type===_.mm.mirror?(0,n.jsxs)(n.Fragment,{children:["Mirror ",(0,n.jsx)("i",{className:"bi bi-arrow-right"})," ",a.hash]}):(0,n.jsxs)(n.Fragment,{children:["Target ",(0,n.jsx)("i",{className:"bi bi-arrow-right"}),(0,n.jsx)("a",{className:"text-truncate",href:"#",onClick:e=>{e.preventDefault(),e.stopPropagation(),f({hash:a.hash[0],show:!0})},children:a.hash})]})})]}),(0,n.jsx)(h.A,{variant:"outline-danger",as:"span",size:"sm",onClick:e=>{e.stopPropagation(),O({show:!0,name:t})},children:(0,n.jsx)("i",{className:"bi-trash"})})]},t)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j.u,{show:N.show,content:(0,n.jsxs)("p",{children:["Delete tag ",N.name,"?"]}),onHide:()=>O({...N,show:!1}),onOk:()=>{(0,b.kP)(A.Tc.method.remove,(0,r.v)(s.g8,{value:N.name})).then(async t=>{let{error:a}=t;void 0!==a?e.Error("delete tag ".concat(N.name," failed, ").concat(a.code,"| ").concat(a.msg)):(e.Info("delete tag ".concat(N.name," success")),await g()),O({...N,show:!1})})}}),(0,n.jsx)(C.y,{show:m.show,hash:m.hash,onHide:()=>f({...m,show:!1})}),(0,n.jsx)(k,{show:x.show,nodes:p,data:t,tag:x.tag,onChangeTag:e=>v({...x,tag:e}),new:x.new,onHide:()=>v({...x,show:!1}),onSave:()=>{""!==x.tag.tag&&""!==x.tag.hash&&(0,b.kP)(A.Tc.method.save,x.tag).then(async t=>{let{error:a}=t;void 0!==a?e.Error("save tag ".concat(x.tag.tag," failed, ").concat(a.code,"| ").concat(a.msg)):(e.Info("Set tag ".concat(x.tag.tag," to ").concat(x.tag.hash," successful")),await g()),v({...x,show:!1})})}}),(0,n.jsx)(u.A,{className:"mb-3",children:(0,n.jsxs)(d.A,{variant:"flush",children:[Object.entries(t.tags).sort((e,t)=>e<=t?-1:1).map(e=>{let[t,a]=e;return(0,n.jsx)(S,{k:t,v:(0,r.v)(_.xN,a)},t)}),(0,n.jsx)(d.A.Item,{className:"d-sm-flex",children:(0,n.jsxs)(h.A,{variant:"outline-success",className:"flex-grow-1",onClick:()=>v({show:!0,tag:(0,r.v)(A.hf,{tag:"new tag",hash:"",type:_.mm.node}),new:!0}),children:[(0,n.jsx)("i",{className:"bi bi-plus-lg"}),"New"]})})]})})]})}},22523:(e,t,a)=>{"use strict";a.d(t,{u:()=>o});var n=a(95155),r=a(63678),s=a(36947);let o=e=>{let{onOk:t,content:a,show:o,onHide:l}=e;return(0,n.jsxs)(r.A,{show:o,onHide:l,centered:!0,children:[(0,n.jsx)(r.A.Body,{children:a}),(0,n.jsxs)(r.A.Footer,{children:[(0,n.jsx)(s.A,{variant:"outline-secondary",onClick:()=>{l()},children:"Cancel"}),(0,n.jsx)(s.A,{variant:"outline-danger",onClick:()=>{t(),l()},children:"OK"})]})]})}},38092:(e,t,a)=>{Promise.resolve().then(a.bind(a,19438))},40574:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var n=a(2821),r=a(12115),s=a(76837),o=a(95155);let l=r.forwardRef((e,t)=>{let{bsPrefix:a,bg:r="primary",pill:l=!1,text:i,className:d,as:c="span",...h}=e,u=(0,s.oU)(a,"badge");return(0,o.jsx)(c,{ref:t,...h,className:(0,n.A)(d,u,l&&"rounded-pill",i&&"text-".concat(i),r&&"bg-".concat(r))})});l.displayName="Badge";let i=l},45811:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var n=a(2821),r=a(12115),s=a(76837),o=a(36947),l=a(95155);let i=()=>void 0,d=r.forwardRef((e,t)=>{let{bsPrefix:a,name:r,className:d,checked:c,type:h,onChange:u,value:g,disabled:p,id:m,inputRef:f,...x}=e;return a=(0,s.oU)(a,"btn-check"),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("input",{className:a,name:r,type:h,value:g,ref:f,autoComplete:"off",checked:!!c,disabled:!!p,onChange:u||i,id:m}),(0,l.jsx)(o.A,{...x,ref:t,className:(0,n.A)(d,p&&"disabled"),type:void 0,role:void 0,as:"label",htmlFor:m})]})});d.displayName="ToggleButton";let c=d},55939:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let n=a(28140),r=a(95155),s=n._(a(12115)),o=n._(a(74841)),l={400:"Bad Request",404:"This page could not be found",405:"Method Not Allowed",500:"Internal Server Error"};function i(e){let{req:t,res:a,err:n}=e;return{statusCode:a&&a.statusCode?a.statusCode:n?n.statusCode:404,hostname:window.location.hostname}}let d={error:{fontFamily:'system-ui,"Segoe UI",Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji"',height:"100vh",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},desc:{lineHeight:"48px"},h1:{display:"inline-block",margin:"0 20px 0 0",paddingRight:23,fontSize:24,fontWeight:500,verticalAlign:"top"},h2:{fontSize:14,fontWeight:400,lineHeight:"28px"},wrap:{display:"inline-block"}};class c extends s.default.Component{render(){let{statusCode:e,withDarkMode:t=!0}=this.props,a=this.props.title||l[e]||"An unexpected error has occurred";return(0,r.jsxs)("div",{style:d.error,children:[(0,r.jsx)(o.default,{children:(0,r.jsx)("title",{children:e?e+": "+a:"Application error: a client-side exception has occurred"})}),(0,r.jsxs)("div",{style:d.desc,children:[(0,r.jsx)("style",{dangerouslySetInnerHTML:{__html:"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}"+(t?"@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}":"")}}),e?(0,r.jsx)("h1",{className:"next-error-h1",style:d.h1,children:e}):null,(0,r.jsx)("div",{style:d.wrap,children:(0,r.jsxs)("h2",{style:d.h2,children:[this.props.title||e?a:(0,r.jsxs)(r.Fragment,{children:["Application error: a client-side exception has occurred"," ",!!this.props.hostname&&(0,r.jsxs)(r.Fragment,{children:["while loading ",this.props.hostname]})," ","(see the browser console for more information)"]}),"."]})})]})]})}}c.displayName="ErrorPage",c.getInitialProps=i,c.origGetInitialProps=i,("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},56696:(e,t,a)=>{e.exports=a(55939)},60861:(e,t)=>{"use strict";function a(e){let{ampFirst:t=!1,hybrid:a=!1,hasQuery:n=!1}=void 0===e?{}:e;return t||a&&n}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isInAmpMode",{enumerable:!0,get:function(){return a}})},74841:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{default:function(){return m},defaultHead:function(){return h}});let n=a(28140),r=a(49417),s=a(95155),o=r._(a(12115)),l=n._(a(1262)),i=a(90737),d=a(82073),c=a(60861);function h(e){void 0===e&&(e=!1);let t=[(0,s.jsx)("meta",{charSet:"utf-8"},"charset")];return e||t.push((0,s.jsx)("meta",{name:"viewport",content:"width=device-width"},"viewport")),t}function u(e,t){return"string"==typeof t||"number"==typeof t?e:t.type===o.default.Fragment?e.concat(o.default.Children.toArray(t.props.children).reduce((e,t)=>"string"==typeof t||"number"==typeof t?e:e.concat(t),[])):e.concat(t)}a(94781);let g=["name","httpEquiv","charSet","itemProp"];function p(e,t){let{inAmpMode:a}=t;return e.reduce(u,[]).reverse().concat(h(a).reverse()).filter(function(){let e=new Set,t=new Set,a=new Set,n={};return r=>{let s=!0,o=!1;if(r.key&&"number"!=typeof r.key&&r.key.indexOf("$")>0){o=!0;let t=r.key.slice(r.key.indexOf("$")+1);e.has(t)?s=!1:e.add(t)}switch(r.type){case"title":case"base":t.has(r.type)?s=!1:t.add(r.type);break;case"meta":for(let e=0,t=g.length;e<t;e++){let t=g[e];if(r.props.hasOwnProperty(t))if("charSet"===t)a.has(t)?s=!1:a.add(t);else{let e=r.props[t],a=n[t]||new Set;("name"!==t||!o)&&a.has(e)?s=!1:(a.add(e),n[t]=a)}}}return s}}()).reverse().map((e,t)=>{let a=e.key||t;return o.default.cloneElement(e,{key:a})})}let m=function(e){let{children:t}=e,a=(0,o.useContext)(i.AmpStateContext),n=(0,o.useContext)(d.HeadManagerContext);return(0,s.jsx)(l.default,{reduceComponentsToState:p,headManager:n,inAmpMode:(0,c.isInAmpMode)(a),children:t})};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},90737:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AmpStateContext",{enumerable:!0,get:function(){return n}});let n=a(28140)._(a(12115)).default.createContext({})}},e=>{e.O(0,[6970,962,2141,449,4066,9048,8076,779,9064,4539,6164,8603,8441,1255,7358],()=>e(e.s=38092)),_N_E=e.O()}]);