(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[962],{9475:function(e,n,t){Promise.resolve().then(t.bind(t,1219))},1219:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return E}});var s=t(7437),r=t(2265),a=t(477),i=t(5097),o=t(8168),c=t(2389),l=t(5914),u=t(590),d=t(7386),m=t(3098),h=t(6879),p=t(5952),w=t(6491),y=t(6756),f=t(1252),g=t(8224),v=t(2283),x=t.n(v),j=t(9865),k=t(4344),S=t(4272),Z=t(7866),J=t(9584);class N extends S.v{static fromBinary(e,n){return new N().fromBinary(e,n)}static fromJson(e,n){return new N().fromJson(e,n)}static fromJsonString(e,n){return new N().fromJsonString(e,n)}static equals(e,n){return Z.w.util.equals(N,e,n)}constructor(e){super(),this.url="",Z.w.util.initPartial(e,this)}}N.runtime=Z.w,N.typeName="yuhaiin.latency.http",N.fields=Z.w.util.newFieldList(()=>[{no:1,name:"url",kind:"scalar",T:9}]);class B extends S.v{static fromBinary(e,n){return new B().fromBinary(e,n)}static fromJson(e,n){return new B().fromJson(e,n)}static fromJsonString(e,n){return new B().fromJsonString(e,n)}static equals(e,n){return Z.w.util.equals(B,e,n)}constructor(e){super(),this.host="",this.targetDomain="",Z.w.util.initPartial(e,this)}}B.runtime=Z.w,B.typeName="yuhaiin.latency.dns",B.fields=Z.w.util.newFieldList(()=>[{no:1,name:"host",kind:"scalar",T:9},{no:2,name:"target_domain",jsonName:"target_name",kind:"scalar",T:9}]);class T extends S.v{static fromBinary(e,n){return new T().fromBinary(e,n)}static fromJson(e,n){return new T().fromJson(e,n)}static fromJsonString(e,n){return new T().fromJsonString(e,n)}static equals(e,n){return Z.w.util.equals(T,e,n)}constructor(e){super(),this.host="",this.targetDomain="",Z.w.util.initPartial(e,this)}}T.runtime=Z.w,T.typeName="yuhaiin.latency.dns_over_quic",T.fields=Z.w.util.newFieldList(()=>[{no:1,name:"host",kind:"scalar",T:9},{no:2,name:"target_domain",jsonName:"target_name",kind:"scalar",T:9}]);class _ extends S.v{static fromBinary(e,n){return new _().fromBinary(e,n)}static fromJson(e,n){return new _().fromJson(e,n)}static fromJsonString(e,n){return new _().fromJsonString(e,n)}static equals(e,n){return Z.w.util.equals(_,e,n)}constructor(e){super(),this.protocol={case:void 0},Z.w.util.initPartial(e,this)}}_.runtime=Z.w,_.typeName="yuhaiin.latency.protocol",_.fields=Z.w.util.newFieldList(()=>[{no:1,name:"http",kind:"message",T:N,oneof:"protocol"},{no:2,name:"dns",kind:"message",T:B,oneof:"protocol"},{no:3,name:"dns_over_quic",jsonName:"dns_over_quic",kind:"message",T:T,oneof:"protocol"}]);class q extends S.v{static fromBinary(e,n){return new q().fromBinary(e,n)}static fromJson(e,n){return new q().fromJson(e,n)}static fromJsonString(e,n){return new q().fromJsonString(e,n)}static equals(e,n){return Z.w.util.equals(q,e,n)}constructor(e){super(),this.id="",this.hash="",this.ipv6=!1,Z.w.util.initPartial(e,this)}}q.runtime=Z.w,q.typeName="yuhaiin.latency.request",q.fields=Z.w.util.newFieldList(()=>[{no:3,name:"id",kind:"scalar",T:9},{no:1,name:"hash",kind:"scalar",T:9},{no:4,name:"ipv6",kind:"scalar",T:8},{no:2,name:"protocol",kind:"message",T:_}]);class b extends S.v{static fromBinary(e,n){return new b().fromBinary(e,n)}static fromJson(e,n){return new b().fromJson(e,n)}static fromJsonString(e,n){return new b().fromJsonString(e,n)}static equals(e,n){return Z.w.util.equals(b,e,n)}constructor(e){super(),this.requests=[],Z.w.util.initPartial(e,this)}}b.runtime=Z.w,b.typeName="yuhaiin.latency.requests",b.fields=Z.w.util.newFieldList(()=>[{no:1,name:"requests",kind:"message",T:q,repeated:!0}]);class P extends S.v{static fromBinary(e,n){return new P().fromBinary(e,n)}static fromJson(e,n){return new P().fromJson(e,n)}static fromJsonString(e,n){return new P().fromJsonString(e,n)}static equals(e,n){return Z.w.util.equals(P,e,n)}constructor(e){super(),this.idLatencyMap={},Z.w.util.initPartial(e,this)}}P.runtime=Z.w,P.typeName="yuhaiin.latency.response",P.fields=Z.w.util.newFieldList(()=>[{no:1,name:"id_latency_map",jsonName:"id_latency_map",kind:"map",K:9,V:{kind:"message",T:J.n}}]);var L=t(5051),C=t(3525),O=t(5299),E=function(){var e;let n=(0,r.useContext)(y.P),[t,v]=(0,r.useState)(""),[S,Z]=(0,r.useState)("Select..."),[J,B]=(0,r.useState)({point:new O.x({}),hash:"",show:!1}),[q,E]=(0,r.useState)({data:!1}),[D,F]=(0,r.useState)({}),{data:I,error:U,isLoading:V,mutate:K}=(0,f.ZP)("/nodes",(0,g.D4)(new k.BP));if(void 0!==U)return(0,s.jsx)(x(),{statusCode:U.code,title:U.msg});if(V||void 0===I)return(0,s.jsx)(w.Z,{});let A=r.memo(e=>{var n,t;let r=e=>void 0===e?"N/A":e,o=n=>{F(t=>{let s=t[e.hash];return null==s&&(s={tcp:"N/A",udp:"N/A"}),n(s),t[e.hash]=s,{...t}})},c=(n,t)=>{(0,g.Uo)("/latency",{body:new b({requests:[{hash:e.hash,id:"latency",ipv6:j.YO,protocol:n}]}).toBinary(),process:async e=>{let n=new P().fromBinary(new Uint8Array(await e.arrayBuffer())).idLatencyMap.latency;return n&&(0!==n.nanos||n.seconds!==BigInt(0))?function(e,n){let t=1e9*e+1*n;return t>=36e11?"".concat(t/36e11," h"):t>=6e10?"".concat(t/6e10," m"):t>=1e9?"".concat(t/1e9," s"):t>=1e6?"".concat(t/1e6," ms"):t>=1e3?"".concat(t/1e3," us"):"".concat(t/1," ns")}(Number(n.seconds),n.nanos):"timeout"}}).then(async e=>{let{data:n,error:s}=e,r="timeout";!s&&n&&(r=await n),t(r)})};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i.Z,{className:"rounded-pill bg-light text-dark ms-1 text-uppercase",children:["tcp: ",r(null===(n=e.latency)||void 0===n?void 0:n.tcp)]}),(0,s.jsxs)(i.Z,{className:"rounded-pill bg-light text-dark ms-1 me-1 text-uppercase",children:["udp:",r(null===(t=e.latency)||void 0===t?void 0:t.udp)]}),(0,s.jsx)(()=>{var n,t;return(null===(n=e.latency)||void 0===n?void 0:n.tcpOnLoading)||(null===(t=e.latency)||void 0===t?void 0:t.udpOnLoading)?(0,s.jsx)(a.Z,{animation:"border",size:"sm"}):(0,s.jsx)("a",{href:"#empty",onClick:async()=>{o(e=>{e.tcpOnLoading=!0,e.udpOnLoading=!0}),c(new _({protocol:{case:"http",value:new N({url:j.rQ})}}),e=>{o(async n=>{n.tcpOnLoading=!1,n.tcp=e})}),c(new _({protocol:{case:"dnsOverQuic",value:new T({host:j.gU,targetDomain:"www.google.com"})}}),e=>{o(async n=>{n.udpOnLoading=!1,n.udp=e})})},children:"Test"})},{})]})}),M=r.memo(e=>{let n=Object.entries(void 0!==e.nodes&&null!==e.nodes?e.nodes:{});return 0===n.length?(0,s.jsx)(o.Z.Body,{children:(0,s.jsx)("div",{className:"text-center my-2",style:{opacity:"0.4"},children:"グールプはまだ指定されていません。"})}):(0,s.jsx)(c.Z,{variant:"flush",children:n.sort((e,n)=>e<=n?-1:1).map(e=>{let[n,r]=e;return(0,s.jsxs)(c.Z.Item,{as:"label",style:{border:"0ch",borderBottom:"1px solid #dee2e6"},children:[(0,s.jsx)("input",{className:"form-check-input me-1",type:"radio",name:"select_node",value:r,onChange:e=>{v(e.target.value)},checked:t===r}),(0,s.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),I.nodes&&B({point:I.nodes[r],hash:r,show:!0})},children:n}),(0,s.jsx)(A,{hash:r,latency:D[r]})]},r)})})});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.Z,{show:J.show,hash:J.hash,point:J.point,onChangePoint:e=>{B(n=>({...n,point:e}))},editable:!0,onHide:()=>B({...J,show:!1}),onSave:()=>K(),groups:Object.keys(I.groupsV2).sort((e,n)=>e<=n?-1:1)}),(0,s.jsx)(p.b,{show:q.data,onSave:()=>K(),onHide:()=>E({data:!1})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.Z,{children:(0,s.jsx)(u.Z,{className:"mb-4 d-flex",children:(0,s.jsxs)(d.Z,{onSelect:e=>{Z(null!=e?e:"Select...")},children:[(0,s.jsx)(d.Z.Toggle,{variant:"light",children:null!=S?S:"GROUP"}),(0,s.jsxs)(d.Z.Menu,{children:[(0,s.jsx)(d.Z.Item,{eventKey:"Select...",children:"Select..."}),I.groupsV2&&Object.keys(I.groupsV2).sort((e,n)=>e<=n?-1:1).map(e=>(0,s.jsx)(d.Z.Item,{eventKey:e,children:e},e))]})]})})}),(0,s.jsxs)(o.Z,{className:"mb-3",children:[(0,s.jsx)(M,{nodes:S&&I.groupsV2?null===(e=I.groupsV2[S])||void 0===e?void 0:e.nodesV2:void 0}),(0,s.jsx)(o.Z.Header,{children:(0,s.jsx)(d.Z,{onSelect:async e=>{(0,g.Uo)("/node",{method:"PUT",body:new L.Gy({tcp:"tcp"===e||"tcpudp"===e,udp:"udp"===e||"tcpudp"===e,hash:t}).toBinary()}).then(async s=>{let{error:r}=s;void 0!==r?n.Error("change node failed, ".concat(r.code,"| ").concat(await r.msg)):n.Info("Change".concat(e," Node To ").concat(t," Successful"))})},children:(0,s.jsxs)(m.Z,{children:[(0,s.jsxs)(m.Z,{children:[(0,s.jsx)(d.Z.Toggle,{variant:"outline-primary",children:"USE"}),(0,s.jsxs)(d.Z.Menu,{children:[(0,s.jsx)(d.Z.Item,{eventKey:"tcpudp",children:"TCP&UDP"}),(0,s.jsx)(d.Z.Item,{eventKey:"tcp",children:"TCP"}),(0,s.jsx)(d.Z.Item,{eventKey:"udp",children:"UDP"})]})]}),(0,s.jsx)(h.Z,{variant:"outline-success",onClick:()=>{B({point:new O.x({group:"template_group",name:"template_name",origin:O.h.manual}),hash:"new node",show:!0})},children:"New"}),(0,s.jsx)(h.Z,{variant:"outline-success",onClick:()=>{E({data:!0})},children:"Import"}),(0,s.jsx)(h.Z,{variant:"outline-danger",onClick:()=>{(0,g.Uo)("/node",{method:"DELETE",body:new C.Gm({value:t}).toBinary()}).then(async e=>{let{error:s}=e;void 0!==s?n.Error("Delete Node ".concat(t," Failed ").concat(s.code,"| ").concat(await s.msg)):(n.Info("Delete Node ".concat(t," Successful.")),K())})},children:"DELETE"})]})})})]})]})]})}}},function(e){e.O(0,[465,149,329,728,717,713,355,373,860,178,186,971,69,744],function(){return e(e.s=9475)}),_N_E=e.O()}]);