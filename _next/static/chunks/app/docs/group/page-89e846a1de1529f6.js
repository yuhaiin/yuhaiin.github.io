(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[962],{7355:function(e,n,s){Promise.resolve().then(s.bind(s,7500))},7500:function(e,n,s){"use strict";s.r(n);var t=s(7437),a=s(2265),l=s(6712),c=s(7185),i=s(4694),o=s(3181),d=s(8785),r=s(5554),h=s(2808),u=s(2514),p=s(358),m=s(7833),v=s(716),x=s(1159),y=s(1617),j=s(879),g=s(6264),w=s.n(g),N=s(4971),Z=s(256),f=s(7379),U=s(3056),O=s(629),C=s(6878),b=s(8537),I=s(7764),P=s(3168);let S=a.memo(e=>{var n,s;let p=(0,a.useContext)(x.P),m=n=>{n(e.latency),e.onChangeLatency(e.latency)},v=e=>e.tcp||e.udp?"timeout"===e.tcp&&"timeout"===e.udp?"danger":"success":"secondary",y=(n,s)=>{(0,j.U)("/latency",{body:(0,C.O)(f.Fg,(0,b.U)(f.Fg,{requests:[{hash:e.hash,id:"latency",ipv6:N.YO,protocol:n}]})),process:async e=>{let n=(0,I.h4)(f.yJ,new Uint8Array(await e.arrayBuffer())).idLatencyMap.latency.reply;switch(n.case){case"latency":{let e=n.value;if(e&&(0!==e.nanos||e.seconds!==BigInt(0)))return[function(e,n){let s=1e9*e+1*n;return s>=36e11?"".concat(s/36e11," h"):s>=6e10?"".concat(s/6e10," m"):s>=1e9?"".concat(s/1e9," s"):s>=1e6?"".concat(s/1e6," ms"):s>=1e3?"".concat(s/1e3," us"):"".concat(s/1," ns")}(Number(e.seconds),e.nanos)];break}case"ip":{let e=n.value;return[e.ipv4,e.ipv6]}}return["timeout"]}}).then(async e=>{let{data:n,error:t}=e,a=["timeout"];!t&&n&&(a=await n),s(a)})};return(0,t.jsx)(l.Z,{className:"mb-3",children:(0,t.jsxs)(c.Z,{className:"h-100 shadow-sm",children:[(0,t.jsx)(c.Z.Header,{children:e.title}),(0,t.jsx)(c.Z.Body,{children:(0,t.jsxs)(i.Z,{variant:"flush",children:[(0,t.jsx)(i.Z.Item,{children:(0,t.jsxs)("div",{className:"d-sm-flex",children:[(0,t.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"TCP"}),(0,t.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-download",children:null!==(n=e.latency.tcp)&&void 0!==n?n:"N/A"})]})}),(0,t.jsx)(i.Z.Item,{children:(0,t.jsxs)("div",{className:"d-sm-flex",children:[(0,t.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"UDP"}),(0,t.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-upload",children:null!==(s=e.latency.udp)&&void 0!==s?s:"N/A"})]})}),e.latency.ipv4&&(0,t.jsx)(i.Z.Item,{children:(0,t.jsxs)("div",{className:"d-sm-flex",children:[(0,t.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"IPv4"}),(0,t.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-upload",children:e.latency.ipv4})]})}),e.latency.ipv6&&(0,t.jsx)(i.Z.Item,{children:(0,t.jsxs)("div",{className:"d-sm-flex",children:[(0,t.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"IPv6"}),(0,t.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-upload",children:e.latency.ipv6})]})}),(0,t.jsx)(i.Z.Item,{children:(0,t.jsxs)(o.Z,{className:"d-sm-flex",children:[(0,t.jsxs)(d.Z,{onSelect:async n=>{(0,j.U)("/node",{method:"PUT",body:(0,C.O)(U.Fe,(0,b.U)(U.Fe,{tcp:"tcp"===n||"tcpudp"===n,udp:"udp"===n||"tcpudp"===n,hash:e.hash}))}).then(async s=>{let{error:t}=s;void 0!==t?p.Error("change node failed, ".concat(t.code,"| ").concat(await t.msg)):p.Info("Change ".concat(n," Node To ").concat(e.hash," Successful"))})},as:o.Z,variant:"outline-primary",title:"USE",className:"w-100",children:[(0,t.jsx)(r.Z.Item,{eventKey:"tcpudp",children:"TCP&UDP"}),(0,t.jsx)(r.Z.Item,{eventKey:"tcp",children:"TCP"}),(0,t.jsx)(r.Z.Item,{eventKey:"udp",children:"UDP"})]}),(0,t.jsx)(h.Z,{variant:"outline-primary",className:"w-100",onClick:e.onClickEdit,children:"Edit"}),(0,t.jsxs)(h.Z,{variant:"outline-"+v(e.latency),className:"w-100",disabled:e.latency.tcpOnLoading||e.latency.udpOnLoading,onClick:async()=>{m(e=>{e.tcpOnLoading=!0,e.udpOnLoading=!0,e.ipOnLoading=!0}),y((0,b.U)(f.n0,{protocol:{case:"http",value:(0,b.U)(f.Ii,{url:N.rQ})}}),e=>{m(async n=>{n.tcpOnLoading=!1,n.tcp=e[0]})}),y((0,b.U)(f.n0,{protocol:{case:"dnsOverQuic",value:(0,b.U)(f.aG,{host:N.gU,targetDomain:"www.google.com"})}}),e=>{m(async n=>{n.udpOnLoading=!1,n.udp=e[0]})}),y((0,b.U)(f.n0,{protocol:{case:"ip",value:(0,b.U)(f.gy,{url:N.Ti})}}),e=>{m(async n=>{n.ipOnLoading=!1,n.ipv4=e[0],n.ipv6=e[1]})})},children:[(e.latency.tcpOnLoading||e.latency.udpOnLoading)&&(0,t.jsx)(u.Z,{size:"sm",animation:"border",variant:v(e.latency)}),"Test"]})]})})]})})]})})});class D{constructor(e){var n,s,t;this.point=null!==(n=null==e?void 0:e.point)&&void 0!==n?n:(0,b.U)(O.tQ,{}),this.hash=null!==(s=null==e?void 0:e.hash)&&void 0!==s?s:"",this.show=null!==(t=null==e?void 0:e.show)&&void 0!==t&&t,this.onDelete=null==e?void 0:e.onDelete}}n.default=function(){let e=(0,a.useContext)(x.P),[n,s]=(0,a.useState)("Select..."),[c,i]=(0,a.useState)(new D),[d,u]=(0,a.useState)({data:!1}),[g,N]=(0,a.useState)({}),{data:f,error:U,isLoading:I,mutate:L}=(0,y.ZP)("/nodes",(0,j.D)(Z.Jq));return void 0!==U?(0,t.jsx)(w(),{statusCode:U.code,title:U.msg}):I||void 0===f?(0,t.jsx)(v.Z,{}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Z,{show:c.show,hash:c.hash,point:c.point,isNew:c.isNew,onDelete:c.onDelete,onChangePoint:e=>{i(n=>({...n,point:e}))},editable:!0,onHide:()=>i({...c,show:!1}),onSave:()=>L(),groups:Object.keys(f.groupsV2).sort((e,n)=>e<=n?-1:1)}),(0,t.jsx)(m.b,{show:d.data,onSave:()=>L(),onHide:()=>u({data:!1}),isNew:!0}),(0,t.jsxs)("div",{children:[(0,t.jsx)(p.Z,{children:(0,t.jsxs)(l.Z,{className:"mb-4 d-flex",children:[(0,t.jsxs)(r.Z,{onSelect:e=>{s(null!=e?e:"Select...")},children:[(0,t.jsx)(r.Z.Toggle,{variant:"light",children:null!=n?n:"GROUP"}),(0,t.jsxs)(r.Z.Menu,{children:[(0,t.jsx)(r.Z.Item,{eventKey:"Select...",children:"Select..."}),f.groupsV2&&Object.keys(f.groupsV2).sort((e,n)=>e<=n?-1:1).map(e=>(0,t.jsx)(r.Z.Item,{eventKey:e,children:e},e))]})]}),(0,t.jsxs)(o.Z,{className:"ms-2 d-flex",children:[(0,t.jsx)(h.Z,{variant:"outline-success",className:"w-100",onClick:()=>{i({point:(0,b.U)(O.tQ,{group:"template_group",name:"template_name",origin:O.hW.manual}),hash:"new node",show:!0,onDelete:void 0,isNew:!0})},children:"New"}),(0,t.jsx)(h.Z,{variant:"outline-success",className:"w-100",onClick:()=>{u({data:!0})},children:"Import"})]})]})}),n&&f.groupsV2&&f.groupsV2[n]?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(p.Z,{className:"row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4",children:Object.entries(f.groupsV2[n].nodesV2).sort((e,n)=>e<=n?-1:1).map(n=>{var s;let[a,l]=n;return(0,t.jsx)(S,{hash:l,title:a,latency:null!==(s=g[l])&&void 0!==s?s:{},onChangeLatency:e=>{N(n=>({...n,[l]:e}))},onClickEdit:()=>{f.nodes&&i({point:f.nodes[l],hash:l,show:!0,onDelete:()=>{(0,j.U)("/node",{method:"DELETE",body:(0,C.O)(P.mV,(0,b.U)(P.mV,{value:l}))}).then(async n=>{let{error:s}=n;void 0!==s?e.Error("Delete Node ".concat(l," Failed ").concat(s.code,"| ").concat(await s.msg)):(e.Info("Delete Node ".concat(l," Successful.")),L())})}})}},a)})})}):(0,t.jsx)(t.Fragment,{})]})]})}}},function(e){e.O(0,[988,113,481,466,262,364,84,361,856,784,688,833,971,23,744],function(){return e(e.s=7355)}),_N_E=e.O()}]);