(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[962],{7355:function(n,e,t){Promise.resolve().then(t.bind(t,8096))},8096:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return V}});var s=t(7437),r=t(2265),i=t(6712),a=t(7185),o=t(4694),u=t(3181),l=t(8785),c=t(5554),m=t(2808),d=t(2514),w=t(358),h=t(7833),f=t(716),p=t(1159),y=t(1617),g=t(879),v=t(6264),J=t.n(v),x=t(4971),k=t(256),N=t(1859),S=t(3256),j=t(7065);class T extends N.v{constructor(n){super(),this.seconds=j.q.zero,this.nanos=0,S.w.util.initPartial(n,this)}fromJson(n,e){if("string"!=typeof n)throw Error(`cannot decode google.protobuf.Duration from JSON: ${S.w.json.debug(n)}`);let t=n.match(/^(-?[0-9]+)(?:\.([0-9]+))?s/);if(null===t)throw Error(`cannot decode google.protobuf.Duration from JSON: ${S.w.json.debug(n)}`);let s=Number(t[1]);if(s>315576e6||s<-315576e6)throw Error(`cannot decode google.protobuf.Duration from JSON: ${S.w.json.debug(n)}`);if(this.seconds=j.q.parse(s),"string"==typeof t[2]){let n=t[2]+"0".repeat(9-t[2].length);this.nanos=parseInt(n),(s<0||Object.is(s,-0))&&(this.nanos=-this.nanos)}return this}toJson(n){if(Number(this.seconds)>315576e6||-315576e6>Number(this.seconds))throw Error("cannot encode google.protobuf.Duration to JSON: value out of range");let e=this.seconds.toString();if(0!==this.nanos){let n=Math.abs(this.nanos).toString();"000000"===(n="0".repeat(9-n.length)+n).substring(3)?n=n.substring(0,3):"000"===n.substring(6)&&(n=n.substring(0,6)),e+="."+n,this.nanos<0&&0==Number(this.seconds)&&(e="-"+e)}return e+"s"}static fromBinary(n,e){return new T().fromBinary(n,e)}static fromJson(n,e){return new T().fromJson(n,e)}static fromJsonString(n,e){return new T().fromJsonString(n,e)}static equals(n,e){return S.w.util.equals(T,n,e)}}T.runtime=S.w,T.typeName="google.protobuf.Duration",T.fields=S.w.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);class q extends N.v{static fromBinary(n,e){return new q().fromBinary(n,e)}static fromJson(n,e){return new q().fromJson(n,e)}static fromJsonString(n,e){return new q().fromJsonString(n,e)}static equals(n,e){return S.w.util.equals(q,n,e)}constructor(n){super(),this.url="",S.w.util.initPartial(n,this)}}q.runtime=S.w,q.typeName="yuhaiin.latency.http",q.fields=S.w.util.newFieldList(()=>[{no:1,name:"url",kind:"scalar",T:9}]);class B extends N.v{static fromBinary(n,e){return new B().fromBinary(n,e)}static fromJson(n,e){return new B().fromJson(n,e)}static fromJsonString(n,e){return new B().fromJsonString(n,e)}static equals(n,e){return S.w.util.equals(B,n,e)}constructor(n){super(),this.host="",this.targetDomain="",S.w.util.initPartial(n,this)}}B.runtime=S.w,B.typeName="yuhaiin.latency.dns",B.fields=S.w.util.newFieldList(()=>[{no:1,name:"host",kind:"scalar",T:9},{no:2,name:"target_domain",jsonName:"target_name",kind:"scalar",T:9}]);class b extends N.v{static fromBinary(n,e){return new b().fromBinary(n,e)}static fromJson(n,e){return new b().fromJson(n,e)}static fromJsonString(n,e){return new b().fromJsonString(n,e)}static equals(n,e){return S.w.util.equals(b,n,e)}constructor(n){super(),this.host="",this.targetDomain="",S.w.util.initPartial(n,this)}}b.runtime=S.w,b.typeName="yuhaiin.latency.dns_over_quic",b.fields=S.w.util.newFieldList(()=>[{no:1,name:"host",kind:"scalar",T:9},{no:2,name:"target_domain",jsonName:"target_name",kind:"scalar",T:9}]);class _ extends N.v{static fromBinary(n,e){return new _().fromBinary(n,e)}static fromJson(n,e){return new _().fromJson(n,e)}static fromJsonString(n,e){return new _().fromJsonString(n,e)}static equals(n,e){return S.w.util.equals(_,n,e)}constructor(n){super(),this.protocol={case:void 0},S.w.util.initPartial(n,this)}}_.runtime=S.w,_.typeName="yuhaiin.latency.protocol",_.fields=S.w.util.newFieldList(()=>[{no:1,name:"http",kind:"message",T:q,oneof:"protocol"},{no:2,name:"dns",kind:"message",T:B,oneof:"protocol"},{no:3,name:"dns_over_quic",jsonName:"dns_over_quic",kind:"message",T:b,oneof:"protocol"}]);class P extends N.v{static fromBinary(n,e){return new P().fromBinary(n,e)}static fromJson(n,e){return new P().fromJson(n,e)}static fromJsonString(n,e){return new P().fromJsonString(n,e)}static equals(n,e){return S.w.util.equals(P,n,e)}constructor(n){super(),this.id="",this.hash="",this.ipv6=!1,S.w.util.initPartial(n,this)}}P.runtime=S.w,P.typeName="yuhaiin.latency.request",P.fields=S.w.util.newFieldList(()=>[{no:3,name:"id",kind:"scalar",T:9},{no:1,name:"hash",kind:"scalar",T:9},{no:4,name:"ipv6",kind:"scalar",T:8},{no:2,name:"protocol",kind:"message",T:_}]);class L extends N.v{static fromBinary(n,e){return new L().fromBinary(n,e)}static fromJson(n,e){return new L().fromJson(n,e)}static fromJsonString(n,e){return new L().fromJsonString(n,e)}static equals(n,e){return S.w.util.equals(L,n,e)}constructor(n){super(),this.requests=[],S.w.util.initPartial(n,this)}}L.runtime=S.w,L.typeName="yuhaiin.latency.requests",L.fields=S.w.util.newFieldList(()=>[{no:1,name:"requests",kind:"message",T:P,repeated:!0}]);class Z extends N.v{static fromBinary(n,e){return new Z().fromBinary(n,e)}static fromJson(n,e){return new Z().fromJson(n,e)}static fromJsonString(n,e){return new Z().fromJsonString(n,e)}static equals(n,e){return S.w.util.equals(Z,n,e)}constructor(n){super(),this.idLatencyMap={},S.w.util.initPartial(n,this)}}Z.runtime=S.w,Z.typeName="yuhaiin.latency.response",Z.fields=S.w.util.newFieldList(()=>[{no:1,name:"id_latency_map",jsonName:"id_latency_map",kind:"map",K:9,V:{kind:"message",T:T}}]);var F=t(3056),D=t(6541),O=t(629);let E=r.memo(n=>{var e,t;let w=(0,r.useContext)(p.P),h=e=>{e(n.latency),n.onChangeLatency(n.latency)},f=n=>n.tcp||n.udp?"timeout"===n.tcp&&"timeout"===n.udp?"danger":"success":"secondary",y=(e,t)=>{(0,g.U)("/latency",{body:new L({requests:[{hash:n.hash,id:"latency",ipv6:x.YO,protocol:e}]}).toBinary(),process:async n=>{let e=new Z().fromBinary(new Uint8Array(await n.arrayBuffer())).idLatencyMap.latency;return e&&(0!==e.nanos||e.seconds!==BigInt(0))?function(n,e){let t=1e9*n+1*e;return t>=36e11?"".concat(t/36e11," h"):t>=6e10?"".concat(t/6e10," m"):t>=1e9?"".concat(t/1e9," s"):t>=1e6?"".concat(t/1e6," ms"):t>=1e3?"".concat(t/1e3," us"):"".concat(t/1," ns")}(Number(e.seconds),e.nanos):"timeout"}}).then(async n=>{let{data:e,error:s}=n,r="timeout";!s&&e&&(r=await e),t(r)})};return(0,s.jsx)(i.Z,{className:"mb-3",children:(0,s.jsxs)(a.Z,{className:"h-100 shadow-sm",children:[(0,s.jsx)(a.Z.Header,{children:n.title}),(0,s.jsx)(a.Z.Body,{children:(0,s.jsxs)(o.Z,{variant:"flush",children:[(0,s.jsx)(o.Z.Item,{children:(0,s.jsxs)("div",{className:"d-sm-flex",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"TCP"}),(0,s.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-download",children:null!==(e=n.latency.tcp)&&void 0!==e?e:"N/A"})]})}),(0,s.jsx)(o.Z.Item,{children:(0,s.jsxs)("div",{className:"d-sm-flex",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"UDP"}),(0,s.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-upload",children:null!==(t=n.latency.udp)&&void 0!==t?t:"N/A"})]})}),(0,s.jsx)(o.Z.Item,{children:(0,s.jsxs)(u.Z,{className:"d-sm-flex",children:[(0,s.jsxs)(l.Z,{onSelect:async e=>{(0,g.U)("/node",{method:"PUT",body:new F.Gy({tcp:"tcp"===e||"tcpudp"===e,udp:"udp"===e||"tcpudp"===e,hash:n.hash}).toBinary()}).then(async t=>{let{error:s}=t;void 0!==s?w.Error("change node failed, ".concat(s.code,"| ").concat(await s.msg)):w.Info("Change ".concat(e," Node To ").concat(n.hash," Successful"))})},as:u.Z,variant:"outline-primary",title:"USE",className:"w-100",children:[(0,s.jsx)(c.Z.Item,{eventKey:"tcpudp",children:"TCP&UDP"}),(0,s.jsx)(c.Z.Item,{eventKey:"tcp",children:"TCP"}),(0,s.jsx)(c.Z.Item,{eventKey:"udp",children:"UDP"})]}),(0,s.jsx)(m.Z,{variant:"outline-primary",className:"w-100",onClick:n.onClickEdit,children:"Edit"}),(0,s.jsxs)(m.Z,{variant:"outline-"+f(n.latency),className:"w-100",disabled:n.latency.tcpOnLoading||n.latency.udpOnLoading,onClick:async()=>{h(n=>{n.tcpOnLoading=!0,n.udpOnLoading=!0}),y(new _({protocol:{case:"http",value:new q({url:x.rQ})}}),n=>{h(async e=>{e.tcpOnLoading=!1,e.tcp=n})}),y(new _({protocol:{case:"dnsOverQuic",value:new b({host:x.gU,targetDomain:"www.google.com"})}}),n=>{h(async e=>{e.udpOnLoading=!1,e.udp=n})})},children:[(n.latency.tcpOnLoading||n.latency.udpOnLoading)&&(0,s.jsx)(d.Z,{size:"sm",animation:"border",variant:f(n.latency)}),"Test"]})]})})]})})]})})});class C{constructor(n){var e,t,s;this.point=null!==(e=null==n?void 0:n.point)&&void 0!==e?e:new O.x({}),this.hash=null!==(t=null==n?void 0:n.hash)&&void 0!==t?t:"",this.show=null!==(s=null==n?void 0:n.show)&&void 0!==s&&s,this.onDelete=null==n?void 0:n.onDelete}}var V=function(){let n=(0,r.useContext)(p.P),[e,t]=(0,r.useState)("Select..."),[a,o]=(0,r.useState)(new C),[l,d]=(0,r.useState)({data:!1}),[v,x]=(0,r.useState)({}),{data:N,error:S,isLoading:j,mutate:T}=(0,y.ZP)("/nodes",(0,g.D)(new k.BP));return void 0!==S?(0,s.jsx)(J(),{statusCode:S.code,title:S.msg}):j||void 0===N?(0,s.jsx)(f.Z,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,{show:a.show,hash:a.hash,point:a.point,isNew:a.isNew,onDelete:a.onDelete,onChangePoint:n=>{o(e=>({...e,point:n}))},editable:!0,onHide:()=>o({...a,show:!1}),onSave:()=>T(),groups:Object.keys(N.groupsV2).sort((n,e)=>n<=e?-1:1)}),(0,s.jsx)(h.b,{show:l.data,onSave:()=>T(),onHide:()=>d({data:!1}),isNew:!0}),(0,s.jsxs)("div",{children:[(0,s.jsx)(w.Z,{children:(0,s.jsxs)(i.Z,{className:"mb-4 d-flex",children:[(0,s.jsxs)(c.Z,{onSelect:n=>{t(null!=n?n:"Select...")},children:[(0,s.jsx)(c.Z.Toggle,{variant:"light",children:null!=e?e:"GROUP"}),(0,s.jsxs)(c.Z.Menu,{children:[(0,s.jsx)(c.Z.Item,{eventKey:"Select...",children:"Select..."}),N.groupsV2&&Object.keys(N.groupsV2).sort((n,e)=>n<=e?-1:1).map(n=>(0,s.jsx)(c.Z.Item,{eventKey:n,children:n},n))]})]}),(0,s.jsxs)(u.Z,{className:"ms-2 d-flex",children:[(0,s.jsx)(m.Z,{variant:"outline-success",className:"w-100",onClick:()=>{o({point:new O.x({group:"template_group",name:"template_name",origin:O.h.manual}),hash:"new node",show:!0,onDelete:void 0,isNew:!0})},children:"New"}),(0,s.jsx)(m.Z,{variant:"outline-success",className:"w-100",onClick:()=>{d({data:!0})},children:"Import"})]})]})}),e&&N.groupsV2&&N.groupsV2[e]?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(w.Z,{className:"row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4",children:Object.entries(N.groupsV2[e].nodesV2).sort((n,e)=>n<=e?-1:1).map(e=>{var t;let[r,i]=e;return(0,s.jsx)(E,{hash:i,title:r,latency:null!==(t=v[i])&&void 0!==t?t:{},onChangeLatency:n=>{x(e=>({...e,[i]:n}))},onClickEdit:()=>{N.nodes&&o({point:N.nodes[i],hash:i,show:!0,onDelete:()=>{(0,g.U)("/node",{method:"DELETE",body:new D.Gm({value:i}).toBinary()}).then(async e=>{let{error:t}=e;void 0!==t?n.Error("Delete Node ".concat(i," Failed ").concat(t.code,"| ").concat(await t.msg)):(n.Info("Delete Node ".concat(i," Successful.")),T())})}})}},r)})})}):(0,s.jsx)(s.Fragment,{})]})]})}},3056:function(n,e,t){"use strict";t.d(e,{DL:function(){return m},Gy:function(){return l},O1:function(){return c},W:function(){return u},hr:function(){return w},pe:function(){return d}});var s=t(1859),r=t(3256),i=t(629),a=t(1462),o=t(5077);class u extends s.v{static fromBinary(n,e){return new u().fromBinary(n,e)}static fromJson(n,e){return new u().fromJson(n,e)}static fromJsonString(n,e){return new u().fromJsonString(n,e)}static equals(n,e){return r.w.util.equals(u,n,e)}constructor(n){super(),r.w.util.initPartial(n,this)}}u.runtime=r.w,u.typeName="yuhaiin.protos.node.service.now_resp",u.fields=r.w.util.newFieldList(()=>[{no:1,name:"tcp",kind:"message",T:i.x},{no:2,name:"udp",kind:"message",T:i.x}]);class l extends s.v{static fromBinary(n,e){return new l().fromBinary(n,e)}static fromJson(n,e){return new l().fromJson(n,e)}static fromJsonString(n,e){return new l().fromJsonString(n,e)}static equals(n,e){return r.w.util.equals(l,n,e)}constructor(n){super(),this.tcp=!1,this.udp=!1,this.hash="",r.w.util.initPartial(n,this)}}l.runtime=r.w,l.typeName="yuhaiin.protos.node.service.use_req",l.fields=r.w.util.newFieldList(()=>[{no:1,name:"tcp",kind:"scalar",T:8},{no:2,name:"udp",kind:"scalar",T:8},{no:3,name:"hash",kind:"scalar",T:9}]);class c extends s.v{static fromBinary(n,e){return new c().fromBinary(n,e)}static fromJson(n,e){return new c().fromJson(n,e)}static fromJsonString(n,e){return new c().fromJsonString(n,e)}static equals(n,e){return r.w.util.equals(c,n,e)}constructor(n){super(),this.links=[],r.w.util.initPartial(n,this)}}c.runtime=r.w,c.typeName="yuhaiin.protos.node.service.save_link_req",c.fields=r.w.util.newFieldList(()=>[{no:1,name:"links",kind:"message",T:a.p,repeated:!0}]);class m extends s.v{static fromBinary(n,e){return new m().fromBinary(n,e)}static fromJson(n,e){return new m().fromJson(n,e)}static fromJsonString(n,e){return new m().fromJsonString(n,e)}static equals(n,e){return r.w.util.equals(m,n,e)}constructor(n){super(),this.names=[],r.w.util.initPartial(n,this)}}m.runtime=r.w,m.typeName="yuhaiin.protos.node.service.link_req",m.fields=r.w.util.newFieldList(()=>[{no:1,name:"names",kind:"scalar",T:9,repeated:!0}]);class d extends s.v{static fromBinary(n,e){return new d().fromBinary(n,e)}static fromJson(n,e){return new d().fromJson(n,e)}static fromJsonString(n,e){return new d().fromJsonString(n,e)}static equals(n,e){return r.w.util.equals(d,n,e)}constructor(n){super(),this.links={},r.w.util.initPartial(n,this)}}d.runtime=r.w,d.typeName="yuhaiin.protos.node.service.get_links_resp",d.fields=r.w.util.newFieldList(()=>[{no:1,name:"links",kind:"map",K:9,V:{kind:"message",T:a.p}}]);class w extends s.v{static fromBinary(n,e){return new w().fromBinary(n,e)}static fromJson(n,e){return new w().fromJson(n,e)}static fromJsonString(n,e){return new w().fromJsonString(n,e)}static equals(n,e){return r.w.util.equals(w,n,e)}constructor(n){super(),this.tag="",this.type=o.f.node,this.hash="",r.w.util.initPartial(n,this)}}w.runtime=r.w,w.typeName="yuhaiin.protos.node.service.save_tag_req",w.fields=r.w.util.newFieldList(()=>[{no:1,name:"tag",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:r.w.getEnumType(o.f)},{no:2,name:"hash",kind:"scalar",T:9}])},256:function(n,e,t){"use strict";t.d(e,{BP:function(){return c}});var s=t(1859),r=t(3256),i=t(629),a=t(1462),o=t(5077);class u extends s.v{static fromBinary(n,e){return new u().fromBinary(n,e)}static fromJson(n,e){return new u().fromJson(n,e)}static fromJsonString(n,e){return new u().fromJsonString(n,e)}static equals(n,e){return r.w.util.equals(u,n,e)}constructor(n){super(),this.links={},r.w.util.initPartial(n,this)}}u.runtime=r.w,u.typeName="yuhaiin.node.node",u.fields=r.w.util.newFieldList(()=>[{no:4,name:"tcp",kind:"message",T:i.x},{no:5,name:"udp",kind:"message",T:i.x},{no:2,name:"links",kind:"map",K:9,V:{kind:"message",T:a.p}},{no:3,name:"manager",kind:"message",T:c}]);class l extends s.v{static fromBinary(n,e){return new l().fromBinary(n,e)}static fromJson(n,e){return new l().fromJson(n,e)}static fromJsonString(n,e){return new l().fromJsonString(n,e)}static equals(n,e){return r.w.util.equals(l,n,e)}constructor(n){super(),this.nodesV2={},r.w.util.initPartial(n,this)}}l.runtime=r.w,l.typeName="yuhaiin.node.nodes",l.fields=r.w.util.newFieldList(()=>[{no:3,name:"nodesV2",jsonName:"node_hash_map",kind:"map",K:9,V:{kind:"scalar",T:9}}]);class c extends s.v{static fromBinary(n,e){return new c().fromBinary(n,e)}static fromJson(n,e){return new c().fromJson(n,e)}static fromJsonString(n,e){return new c().fromJsonString(n,e)}static equals(n,e){return r.w.util.equals(c,n,e)}constructor(n){super(),this.groupsV2={},this.nodes={},this.tags={},r.w.util.initPartial(n,this)}}c.runtime=r.w,c.typeName="yuhaiin.node.manager",c.fields=r.w.util.newFieldList(()=>[{no:2,name:"groupsV2",jsonName:"group_nodes_map",kind:"map",K:9,V:{kind:"message",T:l}},{no:3,name:"nodes",kind:"map",K:9,V:{kind:"message",T:i.x}},{no:4,name:"tags",kind:"map",K:9,V:{kind:"message",T:o.p}}])},1462:function(n,e,t){"use strict";t.d(e,{d:function(){return r},p:function(){return o}});var s,r,i=t(3256),a=t(1859);(s=r||(r={}))[s.reserve=0]="reserve",s[s.trojan=1]="trojan",s[s.vmess=2]="vmess",s[s.shadowsocks=3]="shadowsocks",s[s.shadowsocksr=4]="shadowsocksr",i.w.util.setEnumType(r,"yuhaiin.subscribe.type",[{no:0,name:"reserve"},{no:1,name:"trojan"},{no:2,name:"vmess"},{no:3,name:"shadowsocks"},{no:4,name:"shadowsocksr"}]);class o extends a.v{static fromBinary(n,e){return new o().fromBinary(n,e)}static fromJson(n,e){return new o().fromJson(n,e)}static fromJsonString(n,e){return new o().fromJsonString(n,e)}static equals(n,e){return i.w.util.equals(o,n,e)}constructor(n){super(),this.name="",this.type=0,this.url="",i.w.util.initPartial(n,this)}}o.runtime=i.w,o.typeName="yuhaiin.subscribe.link",o.fields=i.w.util.newFieldList(()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:i.w.getEnumType(r)},{no:3,name:"url",kind:"scalar",T:9}])},5077:function(n,e,t){"use strict";t.d(e,{f:function(){return r},p:function(){return o}});var s,r,i=t(3256),a=t(1859);(s=r||(r={}))[s.node=0]="node",s[s.mirror=1]="mirror",i.w.util.setEnumType(r,"yuhaiin.tag.tag_type",[{no:0,name:"node"},{no:1,name:"mirror"}]);class o extends a.v{static fromBinary(n,e){return new o().fromBinary(n,e)}static fromJson(n,e){return new o().fromJson(n,e)}static fromJsonString(n,e){return new o().fromJsonString(n,e)}static equals(n,e){return i.w.util.equals(o,n,e)}constructor(n){super(),this.tag="",this.type=0,this.hash=[],i.w.util.initPartial(n,this)}}o.runtime=i.w,o.typeName="yuhaiin.tag.tags",o.fields=i.w.util.newFieldList(()=>[{no:1,name:"tag",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:i.w.getEnumType(r)},{no:2,name:"hash",kind:"scalar",T:9,repeated:!0}])}},function(n){n.O(0,[416,113,485,466,262,364,672,650,427,688,833,971,23,744],function(){return n(n.s=7355)}),_N_E=n.O()}]);