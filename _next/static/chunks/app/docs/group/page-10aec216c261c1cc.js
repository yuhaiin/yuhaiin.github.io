(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[564],{5880:(e,t,n)=>{Promise.resolve().then(n.bind(n,8646))},8646:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>S});var s=n(5155),a=n(3577),l=n(1936),i=n(5554),r=n.n(i),o=n(2115),c=n(6121),d=n(3667),u=n(9637),p=n(3614),m=n(2963),h=n(8900),x=n(57),v=n(8143),g=n(4216),A=n(4995),y=n(744),j=n(9169),f=n(8927),N=n(148),w=n(1731),b=n(9969),I=n(2197),C=n(2049);function k(e){if(0===e.nanos&&0===Number(e.seconds))return"timeout";let t=1e9*Number(e.seconds)+1*e.nanos;return t>=36e11?"".concat(t/36e11," h"):t>=6e10?"".concat(t/6e10," m"):t>=1e9?"".concat(t/1e9," s"):t>=1e6?"".concat(t/1e6," ms"):t>=1e3?"".concat(t/1e3," us"):"".concat(t/1," ns")}var E=function(e){return e.TCP="tcp",e.UDP="udp",e.IP="ip",e.STUN="stun",e.STUNTCP="stun-tcp",e}(E||{});let _=()=>({tcp:{loading:!1},udp:{loading:!1},ip:{loading:!1},stun:{loading:!1},stun_tcp:{loading:!1}}),T=e=>{switch(e){case I.HZ.NAT_UNKNOWN:return"unknown";case I.HZ.NAT_NO_RESULT:return"noresult";case I.HZ.NAT_AddressAndPortDependent:return"address-and-port-dependent";case I.HZ.NAT_AddressDependent:return"address-dependent";case I.HZ.NAT_EndpointIndependent:return"endpoint-independent";case I.HZ.NAT_EndpointIndependentNoNAT:return"endpoint-independent-no-nat";case I.HZ.NAT_ServerNotSupportChangePort:return"server-not-support";default:return"unknown"}};class P{constructor(e){var t,n;this.point=null==e?void 0:e.point,this.hash=null!==(t=null==e?void 0:e.hash)&&void 0!==t?t:"",this.show=null!==(n=null==e?void 0:e.show)&&void 0!==n&&n,this.onDelete=null==e?void 0:e.onDelete}}let S=function(){let e=(0,o.useContext)(N.u),[t,n]=(0,o.useState)("Select..."),[i,x]=(0,o.useState)(new P),[v,g]=(0,o.useState)({data:!1}),[y,I]=(0,o.useState)({}),{data:k,error:E,isLoading:T,mutate:S}=(0,A.Ay)("/nodes",(0,f.AD)(b.rH.method.list));if(void 0!==E)return(0,s.jsx)(r(),{statusCode:E.code,title:E.msg});if(T||void 0===k)return(0,s.jsx)(j.A,{});let U=t=>{x({hash:t,show:!0,onDelete:()=>{(0,f.kP)(b.rH.method.remove,"/node","DELETE",(0,a.v)(l.g8,{value:t})).then(async n=>{let{error:s}=n;void 0!==s?e.Error("Delete Node ".concat(t," Failed ").concat(s.code,"| ").concat(s.msg)):(e.Info("Delete Node ".concat(t," Successful.")),S())})}})};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(w.y,{show:i.show,hash:i.hash,point:i.point,isNew:i.isNew,onDelete:i.onDelete,editable:!0,onHide:()=>x({...i,show:!1}),onSave:()=>S(),groups:Object.keys(k.groups).sort((e,t)=>e<=t?-1:1)}),(0,s.jsx)(w.E,{show:v.data,onSave:()=>S(),onHide:()=>g({data:!1}),isNew:!0}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.A,{children:(0,s.jsxs)(d.A,{className:"mb-4 d-flex",children:[(0,s.jsxs)(u.A,{onSelect:e=>{n(null!=e?e:"Select...")},children:[(0,s.jsx)(u.A.Toggle,{variant:"light",children:null!=t?t:"GROUP"}),(0,s.jsxs)(u.A.Menu,{children:[(0,s.jsx)(u.A.Item,{eventKey:"Select...",children:"Select..."}),k.groups&&Object.keys(k.groups).sort((e,t)=>e<=t?-1:1).map(e=>(0,s.jsx)(u.A.Item,{eventKey:e,children:e},e))]})]}),(0,s.jsxs)(p.A,{className:"ms-2 d-flex",children:[(0,s.jsx)(m.A,{variant:"outline-success",className:"w-100",onClick:()=>{x({point:(0,a.v)(C.Ac,{group:"template_group",name:"template_name",origin:C.TG.manual}),hash:"new node",show:!0,onDelete:void 0,isNew:!0})},children:"New"}),(0,s.jsx)(m.A,{variant:"outline-success",className:"w-100",onClick:()=>{g({data:!0})},children:"Import"})]})]})}),(0,s.jsx)(h.A,{className:"mb-3",alwaysOpen:!0,id:"connections",children:k.groups[t]&&Object.entries(k.groups[t].nodesV2).sort((e,t)=>e<=t?-1:1).map(e=>{var t;let[n,a]=e;return(0,s.jsx)(H,{hash:a,name:n,latency:null!==(t=y[a])&&void 0!==t?t:_(),onChangeLatency:e=>{I(t=>({...t,[a]:e}))},onClickEdit:()=>{U(a)}},a)})})]})]})},U=e=>{switch(e.case){case"http":return(0,a.v)(I._1,{protocol:{case:"http",value:(0,a.v)(I.UM,{url:e.url})}});case"dnsOverQuic":return(0,a.v)(I._1,{protocol:{case:"dnsOverQuic",value:(0,a.v)(I.Jc,{host:e.host,targetDomain:e.targetDomain})}});case"ip":return(0,a.v)(I._1,{protocol:{case:"ip",value:(0,a.v)(I.B$,{url:e.url,userAgent:e.userAgent})}});case"stun":return(0,a.v)(I._1,{protocol:{case:"stun",value:(0,a.v)(I._t,{host:e.host,tcp:e.tcp})}})}},D=e=>{switch(e){case"tcp":return U({case:"http",url:y.Oz});case"udp":return U({case:"dnsOverQuic",host:y.r3,targetDomain:"www.google.com"});case"ip":return U({case:"ip",url:y.DH});case"stun-tcp":return U({case:"stun",host:y.X3,tcp:!0});case"stun":return U({case:"stun",host:y.u1,tcp:!1})}},H=e=>{var t,n;let{hash:l,name:i,onClickEdit:r,onChangeLatency:c,latency:d}=e,A=(0,o.useContext)(N.u),j=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2?arguments[2]:void 0;switch(e){case"tcp":c({...d,tcp:{...d.tcp,loading:t}}),n&&c({...d,tcp:{...d.tcp,loading:!1,value:n}});break;case"udp":c({...d,udp:{...d.udp,loading:t}}),n&&c({...d,udp:{...d.udp,loading:!1,value:n}});break;case"ip":c({...d,ip:{...d.ip,loading:t}}),n&&c({...d,ip:{...d.ip,loading:!1,ipv4:n,ipv6:n}});break;case"stun":c({...d,stun:{...d.stun,loading:t}}),n&&c({...d,stun:{loading:!1,mappedAddress:n}});break;case"stun-tcp":c({...d,stun_tcp:{...d.stun_tcp,loading:t}}),n&&c({...d,stun_tcp:{loading:!1,ip:n}})}},w=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.reply;switch(n.case){case"ip":c({...d,ip:{ipv4:n.value.ipv4,ipv6:n.value.ipv6,loading:!1}});break;case"stun":t?c({...d,stun_tcp:{loading:!1,ip:n.value.mappedAddress}}):c({...d,stun:{loading:!1,mapping:T(n.value.Mapping),filtering:T(n.value.Filtering),mappedAddress:n.value.mappedAddress}});break;case"latency":t?c({...d,tcp:{value:k(n.value),loading:!1}}):c({...d,udp:{value:k(n.value),loading:!1}})}},C=e=>{j("tcp",!0),(0,f.kP)(b.rH.method.latency,"/latency","POST",(0,a.v)(I.oL,{requests:[{hash:l,id:"latency",ipv6:y.oH,protocol:D(e)}]})).then(async t=>{let{data:n,error:s}=t;if(s){console.log("test failed ".concat(s.code,"| ").concat(s.msg)),j(e,!1,"".concat(s.code,"| ").concat(s.msg));return}if(n&&n.idLatencyMap.latency){let t=n.idLatencyMap.latency;if("error"===t.reply.case){console.log("test failed ".concat(t.reply.value.msg)),j(e,!1,t.reply.value.msg);return}j(e,!1),w(n.idLatencyMap.latency,"stun-tcp"===e||"tcp"===e)}else j(e,!1,"timeout")})};return(0,s.jsxs)(h.A.Item,{eventKey:l,children:[(0,s.jsx)(h.A.Header,{children:i}),(0,s.jsx)(h.A.Body,{children:(0,s.jsxs)(x.A,{variant:"flush",children:[(0,s.jsx)(x.A.Item,{children:(0,s.jsxs)("div",{className:"d-xl-flex",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"TCP"}),(0,s.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},id:"statistic-download",children:null!==(t=d.tcp.value)&&void 0!==t?t:"N/A"})]})}),(0,s.jsx)(x.A.Item,{children:(0,s.jsxs)("div",{className:"d-xl-flex",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"UDP"}),(0,s.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},id:"statistic-upload",children:null!==(n=d.udp.value)&&void 0!==n?n:"N/A"})]})}),d.ip.ipv4&&(0,s.jsx)(x.A.Item,{children:(0,s.jsxs)("div",{className:"d-xl-flex",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"IPv4"}),(0,s.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},id:"statistic-upload",children:d.ip.ipv4})]})}),d.ip.ipv6&&(0,s.jsx)(x.A.Item,{children:(0,s.jsxs)("div",{className:"d-xl-flex",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"IPv6"}),(0,s.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},id:"statistic-upload",children:d.ip.ipv6})]})}),d.stun.mapping&&(0,s.jsx)(x.A.Item,{children:(0,s.jsxs)("div",{className:"d-xl-flex text-truncate",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-truncate",children:"Mapping"}),(0,s.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},id:"statistic-upload",children:d.stun.mapping})]})}),d.stun.filtering&&(0,s.jsx)(x.A.Item,{children:(0,s.jsxs)("div",{className:"d-xl-flex text-truncate",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-truncate",children:"Filtering"}),(0,s.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},id:"statistic-upload",children:d.stun.filtering})]})}),d.stun.mappedAddress&&(0,s.jsx)(x.A.Item,{children:(0,s.jsxs)("div",{className:"d-xl-flex text-truncate",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-truncate",children:"MappedAddress"}),(0,s.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},id:"statistic-upload",children:d.stun.mappedAddress})]})}),d.stun_tcp.ip&&(0,s.jsx)(x.A.Item,{children:(0,s.jsxs)("div",{className:"d-xl-flex text-truncate",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-truncate",children:"STUN IP"}),(0,s.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},id:"statistic-upload",children:d.stun_tcp.ip})]})}),(0,s.jsx)(x.A.Item,{className:"d-flex justify-content-center",children:(0,s.jsxs)(p.A,{children:[(0,s.jsxs)(v.A,{onSelect:async e=>{K(A,l,e)},as:p.A,variant:"outline-primary",title:"USE",children:[(0,s.jsx)(u.A.Item,{eventKey:"tcpudp",children:"TCP and UDP"}),(0,s.jsx)(u.A.Item,{eventKey:"tcp",children:"TCP"}),(0,s.jsx)(u.A.Item,{eventKey:"udp",children:"UDP"})]}),(0,s.jsx)(m.A,{variant:"outline-primary",onClick:r,children:"Edit"}),(0,s.jsxs)(v.A,{onSelect:async e=>{C(e)},as:p.A,variant:"outline-primary",title:(0,s.jsxs)(s.Fragment,{children:["Test",function(e){return e.tcp.loading||e.udp.loading||e.ip.loading||e.stun.loading||e.stun_tcp.loading}(d)&&(0,s.jsxs)(s.Fragment,{children:["\xa0",(0,s.jsx)(g.A,{size:"sm",animation:"border"})]})]}),children:[(0,s.jsxs)(u.A.Item,{disabled:d.tcp.loading,eventKey:"tcp",children:["TCP\xa0",d.tcp.loading&&(0,s.jsx)(g.A,{size:"sm",animation:"border"})]}),(0,s.jsxs)(u.A.Item,{disabled:d.udp.loading,eventKey:"udp",children:["UDP\xa0",d.udp.loading&&(0,s.jsx)(g.A,{size:"sm",animation:"border"})," "]}),(0,s.jsxs)(u.A.Item,{disabled:d.stun.loading,eventKey:"stun",children:["STUN\xa0",d.stun.loading&&(0,s.jsx)(g.A,{size:"sm",animation:"border"})]}),(0,s.jsxs)(u.A.Item,{disabled:d.stun_tcp.loading,eventKey:"stun-tcp",children:["STUN TCP\xa0",d.stun_tcp.loading&&(0,s.jsx)(g.A,{size:"sm",animation:"border"})]}),(0,s.jsxs)(u.A.Item,{disabled:d.ip.loading,eventKey:"ip",children:["IP\xa0",d.ip.loading&&(0,s.jsx)(g.A,{size:"sm",animation:"border"})]})]})]})})]})})]})},K=(e,t,n)=>{(0,f.kP)(b.rH.method.use,"/node","PUT",(0,a.v)(b.q,{tcp:"tcp"===n||"tcpudp"===n,udp:"udp"===n||"tcpudp"===n,hash:t})).then(async s=>{let{error:a}=s;void 0!==a?e.Error("change node failed, ".concat(a.code,"| ").concat(a.msg)):e.Info("Change ".concat(n," Node To ").concat(t," Successful"))})}},8900:(e,t,n)=>{"use strict";n.d(t,{A:()=>y});var s=n(4617),a=n.n(s),l=n(2115),i=n(6647),r=n(1653),o=n(896);function c(e,t){return Array.isArray(e)?e.includes(t):e===t}let d=l.createContext({});d.displayName="AccordionContext";var u=n(5155);let p=l.forwardRef((e,t)=>{let{as:n="div",bsPrefix:s,className:i,children:p,eventKey:m,...h}=e,{activeEventKey:x}=(0,l.useContext)(d);return s=(0,r.oU)(s,"accordion-collapse"),(0,u.jsx)(o.A,{ref:t,in:c(x,m),...h,className:a()(i,s),children:(0,u.jsx)(n,{children:l.Children.only(p)})})});p.displayName="AccordionCollapse";let m=l.createContext({eventKey:""});m.displayName="AccordionItemContext";let h=l.forwardRef((e,t)=>{let{as:n="div",bsPrefix:s,className:i,onEnter:o,onEntering:c,onEntered:d,onExit:h,onExiting:x,onExited:v,...g}=e;s=(0,r.oU)(s,"accordion-body");let{eventKey:A}=(0,l.useContext)(m);return(0,u.jsx)(p,{eventKey:A,onEnter:o,onEntering:c,onEntered:d,onExit:h,onExiting:x,onExited:v,children:(0,u.jsx)(n,{ref:t,...g,className:a()(i,s)})})});h.displayName="AccordionBody";let x=l.forwardRef((e,t)=>{let{as:n="button",bsPrefix:s,className:i,onClick:o,...p}=e;s=(0,r.oU)(s,"accordion-button");let{eventKey:h}=(0,l.useContext)(m),x=function(e,t){let{activeEventKey:n,onSelect:s,alwaysOpen:a}=(0,l.useContext)(d);return l=>{let i=e===n?null:e;a&&(i=Array.isArray(n)?n.includes(e)?n.filter(t=>t!==e):[...n,e]:[e]),null==s||s(i,l),null==t||t(l)}}(h,o),{activeEventKey:v}=(0,l.useContext)(d);return"button"===n&&(p.type="button"),(0,u.jsx)(n,{ref:t,onClick:x,...p,"aria-expanded":Array.isArray(v)?v.includes(h):h===v,className:a()(i,s,!c(v,h)&&"collapsed")})});x.displayName="AccordionButton";let v=l.forwardRef((e,t)=>{let{as:n="h2","aria-controls":s,bsPrefix:l,className:i,children:o,onClick:c,...d}=e;return l=(0,r.oU)(l,"accordion-header"),(0,u.jsx)(n,{ref:t,...d,className:a()(i,l),children:(0,u.jsx)(x,{onClick:c,"aria-controls":s,children:o})})});v.displayName="AccordionHeader";let g=l.forwardRef((e,t)=>{let{as:n="div",bsPrefix:s,className:i,eventKey:o,...c}=e;s=(0,r.oU)(s,"accordion-item");let d=(0,l.useMemo)(()=>({eventKey:o}),[o]);return(0,u.jsx)(m.Provider,{value:d,children:(0,u.jsx)(n,{ref:t,...c,className:a()(i,s)})})});g.displayName="AccordionItem";let A=l.forwardRef((e,t)=>{let{as:n="div",activeKey:s,bsPrefix:o,className:c,onSelect:p,flush:m,alwaysOpen:h,...x}=(0,i.Zw)(e,{activeKey:"onSelect"}),v=(0,r.oU)(o,"accordion"),g=(0,l.useMemo)(()=>({activeEventKey:s,onSelect:p,alwaysOpen:h}),[s,p,h]);return(0,u.jsx)(d.Provider,{value:g,children:(0,u.jsx)(n,{ref:t,...x,className:a()(c,v,m&&"".concat(v,"-flush"))})})});A.displayName="Accordion";let y=Object.assign(A,{Button:x,Collapse:p,Item:g,Header:v,Body:h})},896:(e,t,n)=>{"use strict";n.d(t,{A:()=>g});var s=n(4617),a=n.n(s),l=n(3762),i=n(2115),r=n(2400),o=n(5998),c=n(4837),d=n(4309),u=n(3557),p=n(4579),m=n(5155);let h={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function x(e,t){let n=t["offset".concat(e[0].toUpperCase()).concat(e.slice(1))],s=h[e];return n+parseInt((0,l.A)(t,s[0]),10)+parseInt((0,l.A)(t,s[1]),10)}let v={[r.kp]:"collapse",[r.ze]:"collapsing",[r.ns]:"collapsing",[r._K]:"collapse show"},g=i.forwardRef((e,t)=>{let{onEnter:n,onEntering:s,onEntered:l,onExit:r,onExiting:h,className:g,children:A,dimension:y="height",in:j=!1,timeout:f=300,mountOnEnter:N=!1,unmountOnExit:w=!1,appear:b=!1,getDimensionValue:I=x,...C}=e,k="function"==typeof y?y():y,E=(0,i.useMemo)(()=>(0,d.A)(e=>{e.style[k]="0"},n),[k,n]),_=(0,i.useMemo)(()=>(0,d.A)(e=>{let t="scroll".concat(k[0].toUpperCase()).concat(k.slice(1));e.style[k]="".concat(e[t],"px")},s),[k,s]),T=(0,i.useMemo)(()=>(0,d.A)(e=>{e.style[k]=null},l),[k,l]),P=(0,i.useMemo)(()=>(0,d.A)(e=>{e.style[k]="".concat(I(k,e),"px"),(0,u.A)(e)},r),[r,I,k]),S=(0,i.useMemo)(()=>(0,d.A)(e=>{e.style[k]=null},h),[k,h]);return(0,m.jsx)(p.A,{ref:t,addEndListener:c.A,...C,"aria-expanded":C.role?j:null,onEnter:E,onEntering:_,onEntered:T,onExit:P,onExiting:S,childRef:(0,o.am)(A),in:j,timeout:f,mountOnEnter:N,unmountOnExit:w,appear:b,children:(e,t)=>i.cloneElement(A,{...t,className:a()(g,A.props.className,v[e],"width"===k&&"collapse-horizontal")})})})},4309:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(e=>null!=e).reduce((e,t)=>{if("function"!=typeof t)throw Error("Invalid Argument Type, must only provide functions, undefined, or null.");return null===e?t:function(){for(var n=arguments.length,s=Array(n),a=0;a<n;a++)s[a]=arguments[a];e.apply(this,s),t.apply(this,s)}},null)}}},e=>{var t=t=>e(e.s=t);e.O(0,[295,375,515,920,637,354,340,190,723,922,969,112,441,517,358],()=>t(5880)),_N_E=e.O()}]);