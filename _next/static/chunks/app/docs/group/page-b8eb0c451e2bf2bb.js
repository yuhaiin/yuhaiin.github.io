(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[962],{9989:function(e,t,o){Promise.resolve().then(o.bind(o,1804))},1804:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return X}});var n=o(7437),r=o(2265),i=o(1329),a=o(4665),l=o(3572),s=o(4297),c=o(8036),d=o(3518),u=o(5503),h=o(6879),p=o(4860),v=o(6168),f=o(1308),m=o(6347),g=o(713),_=o(6934),y=o(1375),k=o.n(y),b=o(9445),N=o(7337),S=o(4481),O=o.n(S),x=o(7508);function j(){return{seconds:0,nanos:0}}let P={encode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O().Writer.create();return 0!==e.seconds&&t.uint32(8).int64(e.seconds),0!==e.nanos&&t.uint32(16).int32(e.nanos),t},decode(e,t){let o=e instanceof O().Reader?e:O().Reader.create(e),n=void 0===t?o.len:o.pos+t,r=j();for(;o.pos<n;){let e=o.uint32();switch(e>>>3){case 1:if(8!==e)break;r.seconds=function(e){if(e.gt(Number.MAX_SAFE_INTEGER))throw new J.Error("Value is larger than Number.MAX_SAFE_INTEGER");return e.toNumber()}(o.int64());continue;case 2:if(16!==e)break;r.nanos=o.int32();continue}if((7&e)==4||0===e)break;o.skipType(7&e)}return r},fromJSON:e=>{var t,o;return{seconds:null!=e.seconds?Number(e.seconds):0,nanos:null!=e.nanos?Number(e.nanos):0}},toJSON(e){let t={};return 0!==e.seconds&&(t.seconds=Math.round(e.seconds)),0!==e.nanos&&(t.nanos=Math.round(e.nanos)),t},create:e=>P.fromPartial(null!=e?e:{}),fromPartial(e){var t,o;let n=j();return n.seconds=null!==(t=e.seconds)&&void 0!==t?t:0,n.nanos=null!==(o=e.nanos)&&void 0!==o?o:0,n}},J="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:window;O().util.Long!==x.Z&&(O().util.Long=x.Z,O().configure());let q={encode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O().Writer.create();return""!==e.url&&t.uint32(10).string(e.url),t},decode(e,t){let o=e instanceof O().Reader?e:O().Reader.create(e),n=void 0===t?o.len:o.pos+t,r={url:""};for(;o.pos<n;){let e=o.uint32();switch(e>>>3){case 1:if(10!==e)break;r.url=o.string();continue}if((7&e)==4||0===e)break;o.skipType(7&e)}return r},fromJSON:e=>({url:F(e.url)?String(e.url):""}),toJSON(e){let t={};return""!==e.url&&(t.url=e.url),t},create:e=>q.fromPartial(null!=e?e:{}),fromPartial(e){var t;let o={url:""};return o.url=null!==(t=e.url)&&void 0!==t?t:"",o}};function Z(){return{host:"",target_domain:""}}let w={encode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O().Writer.create();return""!==e.host&&t.uint32(10).string(e.host),""!==e.target_domain&&t.uint32(18).string(e.target_domain),t},decode(e,t){let o=e instanceof O().Reader?e:O().Reader.create(e),n=void 0===t?o.len:o.pos+t,r=Z();for(;o.pos<n;){let e=o.uint32();switch(e>>>3){case 1:if(10!==e)break;r.host=o.string();continue;case 2:if(18!==e)break;r.target_domain=o.string();continue}if((7&e)==4||0===e)break;o.skipType(7&e)}return r},fromJSON:e=>({host:F(e.host)?String(e.host):"",target_domain:F(e.target_name)?String(e.target_name):""}),toJSON(e){let t={};return""!==e.host&&(t.host=e.host),""!==e.target_domain&&(t.target_name=e.target_domain),t},create:e=>w.fromPartial(null!=e?e:{}),fromPartial(e){var t,o;let n=Z();return n.host=null!==(t=e.host)&&void 0!==t?t:"",n.target_domain=null!==(o=e.target_domain)&&void 0!==o?o:"",n}};function T(){return{host:"",target_domain:""}}let E={encode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O().Writer.create();return""!==e.host&&t.uint32(10).string(e.host),""!==e.target_domain&&t.uint32(18).string(e.target_domain),t},decode(e,t){let o=e instanceof O().Reader?e:O().Reader.create(e),n=void 0===t?o.len:o.pos+t,r=T();for(;o.pos<n;){let e=o.uint32();switch(e>>>3){case 1:if(10!==e)break;r.host=o.string();continue;case 2:if(18!==e)break;r.target_domain=o.string();continue}if((7&e)==4||0===e)break;o.skipType(7&e)}return r},fromJSON:e=>({host:F(e.host)?String(e.host):"",target_domain:F(e.target_name)?String(e.target_name):""}),toJSON(e){let t={};return""!==e.host&&(t.host=e.host),""!==e.target_domain&&(t.target_name=e.target_domain),t},create:e=>E.fromPartial(null!=e?e:{}),fromPartial(e){var t,o;let n=T();return n.host=null!==(t=e.host)&&void 0!==t?t:"",n.target_domain=null!==(o=e.target_domain)&&void 0!==o?o:"",n}};function R(){return{protocol:void 0}}let $={encode(e){var t;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O().Writer.create();switch(null===(t=e.protocol)||void 0===t?void 0:t.$case){case"http":q.encode(e.protocol.http,o.uint32(10).fork()).ldelim();break;case"dns":w.encode(e.protocol.dns,o.uint32(18).fork()).ldelim();break;case"dns_over_quic":E.encode(e.protocol.dns_over_quic,o.uint32(26).fork()).ldelim()}return o},decode(e,t){let o=e instanceof O().Reader?e:O().Reader.create(e),n=void 0===t?o.len:o.pos+t,r=R();for(;o.pos<n;){let e=o.uint32();switch(e>>>3){case 1:if(10!==e)break;r.protocol={$case:"http",http:q.decode(o,o.uint32())};continue;case 2:if(18!==e)break;r.protocol={$case:"dns",dns:w.decode(o,o.uint32())};continue;case 3:if(26!==e)break;r.protocol={$case:"dns_over_quic",dns_over_quic:E.decode(o,o.uint32())};continue}if((7&e)==4||0===e)break;o.skipType(7&e)}return r},fromJSON:e=>({protocol:F(e.http)?{$case:"http",http:q.fromJSON(e.http)}:F(e.dns)?{$case:"dns",dns:w.fromJSON(e.dns)}:F(e.dns_over_quic)?{$case:"dns_over_quic",dns_over_quic:E.fromJSON(e.dns_over_quic)}:void 0}),toJSON(e){var t,o,n;let r={};return(null===(t=e.protocol)||void 0===t?void 0:t.$case)==="http"&&(r.http=q.toJSON(e.protocol.http)),(null===(o=e.protocol)||void 0===o?void 0:o.$case)==="dns"&&(r.dns=w.toJSON(e.protocol.dns)),(null===(n=e.protocol)||void 0===n?void 0:n.$case)==="dns_over_quic"&&(r.dns_over_quic=E.toJSON(e.protocol.dns_over_quic)),r},create:e=>$.fromPartial(null!=e?e:{}),fromPartial(e){var t,o,n,r,i,a,l,s,c;let d=R();return(null===(t=e.protocol)||void 0===t?void 0:t.$case)==="http"&&(null===(o=e.protocol)||void 0===o?void 0:o.http)!==void 0&&(null===(n=e.protocol)||void 0===n?void 0:n.http)!==null&&(d.protocol={$case:"http",http:q.fromPartial(e.protocol.http)}),(null===(r=e.protocol)||void 0===r?void 0:r.$case)==="dns"&&(null===(i=e.protocol)||void 0===i?void 0:i.dns)!==void 0&&(null===(a=e.protocol)||void 0===a?void 0:a.dns)!==null&&(d.protocol={$case:"dns",dns:w.fromPartial(e.protocol.dns)}),(null===(l=e.protocol)||void 0===l?void 0:l.$case)==="dns_over_quic"&&(null===(s=e.protocol)||void 0===s?void 0:s.dns_over_quic)!==void 0&&(null===(c=e.protocol)||void 0===c?void 0:c.dns_over_quic)!==null&&(d.protocol={$case:"dns_over_quic",dns_over_quic:E.fromPartial(e.protocol.dns_over_quic)}),d}};function C(){return{id:"",hash:"",protocol:void 0}}let A={encode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O().Writer.create();return""!==e.id&&t.uint32(26).string(e.id),""!==e.hash&&t.uint32(10).string(e.hash),void 0!==e.protocol&&$.encode(e.protocol,t.uint32(18).fork()).ldelim(),t},decode(e,t){let o=e instanceof O().Reader?e:O().Reader.create(e),n=void 0===t?o.len:o.pos+t,r=C();for(;o.pos<n;){let e=o.uint32();switch(e>>>3){case 3:if(26!==e)break;r.id=o.string();continue;case 1:if(10!==e)break;r.hash=o.string();continue;case 2:if(18!==e)break;r.protocol=$.decode(o,o.uint32());continue}if((7&e)==4||0===e)break;o.skipType(7&e)}return r},fromJSON:e=>({id:F(e.id)?String(e.id):"",hash:F(e.hash)?String(e.hash):"",protocol:F(e.protocol)?$.fromJSON(e.protocol):void 0}),toJSON(e){let t={};return""!==e.id&&(t.id=e.id),""!==e.hash&&(t.hash=e.hash),void 0!==e.protocol&&(t.protocol=$.toJSON(e.protocol)),t},create:e=>A.fromPartial(null!=e?e:{}),fromPartial(e){var t,o;let n=C();return n.id=null!==(t=e.id)&&void 0!==t?t:"",n.hash=null!==(o=e.hash)&&void 0!==o?o:"",n.protocol=void 0!==e.protocol&&null!==e.protocol?$.fromPartial(e.protocol):void 0,n}};function I(){return{requests:[]}}let L={encode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O().Writer.create();for(let o of e.requests)A.encode(o,t.uint32(10).fork()).ldelim();return t},decode(e,t){let o=e instanceof O().Reader?e:O().Reader.create(e),n=void 0===t?o.len:o.pos+t,r=I();for(;o.pos<n;){let e=o.uint32();switch(e>>>3){case 1:if(10!==e)break;r.requests.push(A.decode(o,o.uint32()));continue}if((7&e)==4||0===e)break;o.skipType(7&e)}return r},fromJSON:e=>({requests:Array.isArray(null==e?void 0:e.requests)?e.requests.map(e=>A.fromJSON(e)):[]}),toJSON(e){var t;let o={};return(null===(t=e.requests)||void 0===t?void 0:t.length)&&(o.requests=e.requests.map(e=>A.toJSON(e))),o},create:e=>L.fromPartial(null!=e?e:{}),fromPartial(e){var t;let o=I();return o.requests=(null===(t=e.requests)||void 0===t?void 0:t.map(e=>A.fromPartial(e)))||[],o}};function W(){return{id_latency_map:{}}}let U={encode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O().Writer.create();return Object.entries(e.id_latency_map).forEach(e=>{let[o,n]=e;M.encode({key:o,value:n},t.uint32(10).fork()).ldelim()}),t},decode(e,t){let o=e instanceof O().Reader?e:O().Reader.create(e),n=void 0===t?o.len:o.pos+t,r=W();for(;o.pos<n;){let e=o.uint32();switch(e>>>3){case 1:if(10!==e)break;let t=M.decode(o,o.uint32());void 0!==t.value&&(r.id_latency_map[t.key]=t.value);continue}if((7&e)==4||0===e)break;o.skipType(7&e)}return r},fromJSON:e=>{var t;return{id_latency_map:"object"==typeof(t=e.id_latency_map)&&null!==t?Object.entries(e.id_latency_map).reduce((e,t)=>{let[o,n]=t;return e[o]=P.fromJSON(n),e},{}):{}}},toJSON(e){let t={};if(e.id_latency_map){let o=Object.entries(e.id_latency_map);o.length>0&&(t.id_latency_map={},o.forEach(e=>{let[o,n]=e;t.id_latency_map[o]=P.toJSON(n)}))}return t},create:e=>U.fromPartial(null!=e?e:{}),fromPartial(e){var t;let o=W();return o.id_latency_map=Object.entries(null!==(t=e.id_latency_map)&&void 0!==t?t:{}).reduce((e,t)=>{let[o,n]=t;return void 0!==n&&(e[o]=P.fromPartial(n)),e},{}),o}};function D(){return{key:"",value:void 0}}let M={encode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O().Writer.create();return""!==e.key&&t.uint32(10).string(e.key),void 0!==e.value&&P.encode(e.value,t.uint32(18).fork()).ldelim(),t},decode(e,t){let o=e instanceof O().Reader?e:O().Reader.create(e),n=void 0===t?o.len:o.pos+t,r=D();for(;o.pos<n;){let e=o.uint32();switch(e>>>3){case 1:if(10!==e)break;r.key=o.string();continue;case 2:if(18!==e)break;r.value=P.decode(o,o.uint32());continue}if((7&e)==4||0===e)break;o.skipType(7&e)}return r},fromJSON:e=>({key:F(e.key)?String(e.key):"",value:F(e.value)?P.fromJSON(e.value):void 0}),toJSON(e){let t={};return""!==e.key&&(t.key=e.key),void 0!==e.value&&(t.value=P.toJSON(e.value)),t},create:e=>M.fromPartial(null!=e?e:{}),fromPartial(e){var t;let o=D();return o.key=null!==(t=e.key)&&void 0!==t?t:"",o.value=void 0!==e.value&&null!==e.value?P.fromPartial(e.value):void 0,o}};function F(e){return null!=e}var G=o(780),K=o(7684);let B=1e9,V=60*B,H=60*V;var X=function(){var e;let t=(0,r.useContext)(m.P),[o,y]=(0,r.useState)(""),[S,O]=(0,r.useState)(""),[x,j]=(0,r.useState)({point:"",hash:""}),[P,J]=(0,r.useState)({}),{data:q,error:Z,isLoading:w,mutate:T}=(0,g.ZP)("/nodes",(0,_.hW)(b.BP));if(void 0!==Z)return(0,n.jsx)(k(),{statusCode:Z.code,title:Z.msg});if(w||void 0===q)return(0,n.jsx)(f.Z,{});let E=r.memo(e=>{var t,o;let r=e=>void 0===e?"N/A":e,i=t=>{J(o=>{let n=o[e.hash];return null==n&&(n={tcp:"N/A",udp:"N/A"}),t(n),o[e.hash]=n,{...o}})},a=(t,o)=>{(0,_.Uo)("/latency",{body:L.encode({requests:[{hash:e.hash,id:"latency",protocol:t}]}).finish(),process:async e=>{let t=U.decode(new Uint8Array(await e.arrayBuffer())),o=t.id_latency_map.latency;return void 0!==o&&(0!==o.nanos||0!==o.seconds)?function(e,t){let o=e*B+1*t;return o>=H?"".concat(o/H," h"):o>=V?"".concat(o/V," m"):o>=B?"".concat(o/B," s"):o>=1e6?"".concat(o/1e6," ms"):o>=1e3?"".concat(o/1e3," us"):"".concat(o/1," ns")}(o.seconds,o.nanos):"timeout"}}).then(async e=>{let{data:t,error:n}=e,r="timeout";void 0===n&&void 0!==t&&(r=await t),o(r)})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(h.Z,{className:"rounded-pill bg-light text-dark ms-1 text-uppercase",children:["tcp: ",r(null===(t=e.latency)||void 0===t?void 0:t.tcp)]}),(0,n.jsxs)(h.Z,{className:"rounded-pill bg-light text-dark ms-1 me-1 text-uppercase",children:["udp:",r(null===(o=e.latency)||void 0===o?void 0:o.udp)]}),(0,n.jsx)(()=>{var t,o;return(null===(t=e.latency)||void 0===t?void 0:t.tcpOnLoading)||(null===(o=e.latency)||void 0===o?void 0:o.udpOnLoading)?(0,n.jsx)(p.Z,{animation:"border",size:"sm"}):(0,n.jsx)("a",{href:"#empty",onClick:async()=>{i(e=>{e.tcpOnLoading=!0,e.udpOnLoading=!0}),a({protocol:{$case:"http",http:{url:"https://clients3.google.com/generate_204"}}},e=>{i(async t=>{t.tcpOnLoading=!1,t.tcp=e})}),a({protocol:{$case:"dns_over_quic",dns_over_quic:{host:"dns.nextdns.io:853",target_domain:"www.google.com"}}},e=>{i(async t=>{t.udpOnLoading=!1,t.udp=e})})},children:"Test"})},{})]})}),R=r.memo(e=>{let t=Object.entries(void 0!==e.nodes?e.nodes:{});return 0===t.length?(0,n.jsx)(d.Z.Body,{children:(0,n.jsx)("div",{className:"text-center my-2",style:{opacity:"0.4"},children:"グールプはまだ指定されていません。"})}):(0,n.jsx)(u.Z,{variant:"flush",children:t.sort((e,t)=>e<=t?-1:1).map(e=>{let[t,r]=e;return(0,n.jsxs)(u.Z.Item,{as:"label",style:{border:"0ch",borderBottom:"1px solid #dee2e6"},children:[(0,n.jsx)("input",{className:"form-check-input me-1",type:"radio",name:"select_node",value:r,onChange:e=>{y(e.target.value)},checked:o===r}),(0,n.jsx)("a",{href:"#",onClick:e=>{e.preventDefault();let t=q.nodes[r];j({point:void 0!==t?JSON.stringify(N.xm.toJSON(t),null,"  "):"",hash:r})},children:t}),(0,n.jsx)(E,{hash:r,latency:P[r]})]},r)})})});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.Z,{show:""!==x.point&&""!==x.hash,hash:x.hash,point:x.point,onChangePoint:e=>{j(t=>({...t,point:e}))},editable:!0,onHide:()=>j({point:"",hash:""}),onSave:()=>T()}),(0,n.jsxs)("div",{children:[(0,n.jsx)(i.Z,{children:(0,n.jsx)(a.Z,{className:"mb-4 d-flex",children:(0,n.jsxs)(c.Z,{onSelect:e=>{O(null!=e?e:"")},children:[(0,n.jsx)(c.Z.Toggle,{variant:"light",children:""!==S?S:"GROUP"}),(0,n.jsxs)(c.Z.Menu,{children:[(0,n.jsx)(c.Z.Item,{eventKey:"",children:"Select..."}),Object.keys(q.groupsV2).sort((e,t)=>e<=t?-1:1).map(e=>(0,n.jsx)(c.Z.Item,{eventKey:e,children:e},e))]})]})})}),(0,n.jsxs)(d.Z,{className:"mb-3",children:[(0,n.jsx)(R,{nodes:""!==S?null===(e=q.groupsV2[S])||void 0===e?void 0:e.nodesV2:void 0}),(0,n.jsx)(d.Z.Header,{children:(0,n.jsx)(c.Z,{onSelect:async e=>{(0,_.Uo)("/node",{method:"PUT",body:G.Gy.encode({tcp:"tcp"===e||"tcpudp"===e,udp:"udp"===e||"tcpudp"===e,hash:o}).finish()}).then(async n=>{let{error:r}=n;void 0!==r?t.Error("change node failed, ".concat(r.code,"| ").concat(await r.msg)):t.Info("Change".concat(e," Node To ").concat(o," Successful"))})},children:(0,n.jsxs)(l.Z,{children:[(0,n.jsxs)(l.Z,{children:[(0,n.jsx)(c.Z.Toggle,{variant:"outline-primary",children:"USE"}),(0,n.jsxs)(c.Z.Menu,{children:[(0,n.jsx)(c.Z.Item,{eventKey:"tcpudp",children:"TCP&UDP"}),(0,n.jsx)(c.Z.Item,{eventKey:"tcp",children:"TCP"}),(0,n.jsx)(c.Z.Item,{eventKey:"udp",children:"UDP"})]})]}),(0,n.jsx)(s.Z,{variant:"outline-danger",onClick:()=>{(0,_.Uo)("/node",{method:"DELETE",body:K.Gm.encode({value:o}).finish()}).then(async e=>{let{error:n}=e;void 0!==n?t.Error("Delete Node ".concat(o," Failed ").concat(n.code,"| ").concat(await n.msg)):(t.Info("Delete Node ".concat(o," Successful.")),T())})},children:"DELETE"})]})})})]})]})]})}}},function(e){e.O(0,[359,441,331,895,8,508,946,722,326,337,874,236,168,445,971,596,744],function(){return e(e.s=9989)}),_N_E=e.O()}]);