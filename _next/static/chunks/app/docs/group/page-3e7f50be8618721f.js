(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[962],{9475:function(e,n,t){Promise.resolve().then(t.bind(t,7919))},7919:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return F}});var s=t(7437),o=t(2265),a=t(590),r=t(6459),i=t(2389),l=t(3098),c=t(7374),u=t(7386),d=t(6879),m=t(477),h=t(5914),w=t(5952),p=t(6491),f=t(6756),g=t(1252),y=t(8224),v=t(2283),x=t.n(v),j=t(9865),N=t(4344),J=t(4272),S=t(7866),b=t(5658);class Z extends J.v{constructor(e){super(),this.seconds=b.q.zero,this.nanos=0,S.w.util.initPartial(e,this)}fromJson(e,n){if("string"!=typeof e)throw Error(`cannot decode google.protobuf.Duration from JSON: ${S.w.json.debug(e)}`);let t=e.match(/^(-?[0-9]+)(?:\.([0-9]+))?s/);if(null===t)throw Error(`cannot decode google.protobuf.Duration from JSON: ${S.w.json.debug(e)}`);let s=Number(t[1]);if(s>315576e6||s<-315576e6)throw Error(`cannot decode google.protobuf.Duration from JSON: ${S.w.json.debug(e)}`);if(this.seconds=b.q.parse(s),"string"==typeof t[2]){let e=t[2]+"0".repeat(9-t[2].length);this.nanos=parseInt(e),(s<0||Object.is(s,-0))&&(this.nanos=-this.nanos)}return this}toJson(e){if(Number(this.seconds)>315576e6||-315576e6>Number(this.seconds))throw Error("cannot encode google.protobuf.Duration to JSON: value out of range");let n=this.seconds.toString();if(0!==this.nanos){let e=Math.abs(this.nanos).toString();"000000"===(e="0".repeat(9-e.length)+e).substring(3)?e=e.substring(0,3):"000"===e.substring(6)&&(e=e.substring(0,6)),n+="."+e,this.nanos<0&&0==Number(this.seconds)&&(n="-"+n)}return n+"s"}static fromBinary(e,n){return new Z().fromBinary(e,n)}static fromJson(e,n){return new Z().fromJson(e,n)}static fromJsonString(e,n){return new Z().fromJsonString(e,n)}static equals(e,n){return S.w.util.equals(Z,e,n)}}Z.runtime=S.w,Z.typeName="google.protobuf.Duration",Z.fields=S.w.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);class k extends J.v{static fromBinary(e,n){return new k().fromBinary(e,n)}static fromJson(e,n){return new k().fromJson(e,n)}static fromJsonString(e,n){return new k().fromJsonString(e,n)}static equals(e,n){return S.w.util.equals(k,e,n)}constructor(e){super(),this.url="",S.w.util.initPartial(e,this)}}k.runtime=S.w,k.typeName="yuhaiin.latency.http",k.fields=S.w.util.newFieldList(()=>[{no:1,name:"url",kind:"scalar",T:9}]);class q extends J.v{static fromBinary(e,n){return new q().fromBinary(e,n)}static fromJson(e,n){return new q().fromJson(e,n)}static fromJsonString(e,n){return new q().fromJsonString(e,n)}static equals(e,n){return S.w.util.equals(q,e,n)}constructor(e){super(),this.host="",this.targetDomain="",S.w.util.initPartial(e,this)}}q.runtime=S.w,q.typeName="yuhaiin.latency.dns",q.fields=S.w.util.newFieldList(()=>[{no:1,name:"host",kind:"scalar",T:9},{no:2,name:"target_domain",jsonName:"target_name",kind:"scalar",T:9}]);class B extends J.v{static fromBinary(e,n){return new B().fromBinary(e,n)}static fromJson(e,n){return new B().fromJson(e,n)}static fromJsonString(e,n){return new B().fromJsonString(e,n)}static equals(e,n){return S.w.util.equals(B,e,n)}constructor(e){super(),this.host="",this.targetDomain="",S.w.util.initPartial(e,this)}}B.runtime=S.w,B.typeName="yuhaiin.latency.dns_over_quic",B.fields=S.w.util.newFieldList(()=>[{no:1,name:"host",kind:"scalar",T:9},{no:2,name:"target_domain",jsonName:"target_name",kind:"scalar",T:9}]);class T extends J.v{static fromBinary(e,n){return new T().fromBinary(e,n)}static fromJson(e,n){return new T().fromJson(e,n)}static fromJsonString(e,n){return new T().fromJsonString(e,n)}static equals(e,n){return S.w.util.equals(T,e,n)}constructor(e){super(),this.protocol={case:void 0},S.w.util.initPartial(e,this)}}T.runtime=S.w,T.typeName="yuhaiin.latency.protocol",T.fields=S.w.util.newFieldList(()=>[{no:1,name:"http",kind:"message",T:k,oneof:"protocol"},{no:2,name:"dns",kind:"message",T:q,oneof:"protocol"},{no:3,name:"dns_over_quic",jsonName:"dns_over_quic",kind:"message",T:B,oneof:"protocol"}]);class P extends J.v{static fromBinary(e,n){return new P().fromBinary(e,n)}static fromJson(e,n){return new P().fromJson(e,n)}static fromJsonString(e,n){return new P().fromJsonString(e,n)}static equals(e,n){return S.w.util.equals(P,e,n)}constructor(e){super(),this.id="",this.hash="",this.ipv6=!1,S.w.util.initPartial(e,this)}}P.runtime=S.w,P.typeName="yuhaiin.latency.request",P.fields=S.w.util.newFieldList(()=>[{no:3,name:"id",kind:"scalar",T:9},{no:1,name:"hash",kind:"scalar",T:9},{no:4,name:"ipv6",kind:"scalar",T:8},{no:2,name:"protocol",kind:"message",T:T}]);class _ extends J.v{static fromBinary(e,n){return new _().fromBinary(e,n)}static fromJson(e,n){return new _().fromJson(e,n)}static fromJsonString(e,n){return new _().fromJsonString(e,n)}static equals(e,n){return S.w.util.equals(_,e,n)}constructor(e){super(),this.requests=[],S.w.util.initPartial(e,this)}}_.runtime=S.w,_.typeName="yuhaiin.latency.requests",_.fields=S.w.util.newFieldList(()=>[{no:1,name:"requests",kind:"message",T:P,repeated:!0}]);class D extends J.v{static fromBinary(e,n){return new D().fromBinary(e,n)}static fromJson(e,n){return new D().fromJson(e,n)}static fromJsonString(e,n){return new D().fromJsonString(e,n)}static equals(e,n){return S.w.util.equals(D,e,n)}constructor(e){super(),this.idLatencyMap={},S.w.util.initPartial(e,this)}}D.runtime=S.w,D.typeName="yuhaiin.latency.response",D.fields=S.w.util.newFieldList(()=>[{no:1,name:"id_latency_map",jsonName:"id_latency_map",kind:"map",K:9,V:{kind:"message",T:Z}}]);var L=t(5051),O=t(3525),C=t(5299);let E=o.memo(e=>{var n,t;let h=(0,o.useContext)(f.P),w=n=>{n(e.latency),e.onChangeLatency(e.latency)},p=e=>e.tcp||e.udp?"timeout"===e.tcp&&"timeout"===e.udp?"danger":"success":"secondary",g=(n,t)=>{(0,y.Uo)("/latency",{body:new _({requests:[{hash:e.hash,id:"latency",ipv6:j.YO,protocol:n}]}).toBinary(),process:async e=>{let n=new D().fromBinary(new Uint8Array(await e.arrayBuffer())).idLatencyMap.latency;return n&&(0!==n.nanos||n.seconds!==BigInt(0))?function(e,n){let t=1e9*e+1*n;return t>=36e11?"".concat(t/36e11," h"):t>=6e10?"".concat(t/6e10," m"):t>=1e9?"".concat(t/1e9," s"):t>=1e6?"".concat(t/1e6," ms"):t>=1e3?"".concat(t/1e3," us"):"".concat(t/1," ns")}(Number(n.seconds),n.nanos):"timeout"}}).then(async e=>{let{data:n,error:s}=e,o="timeout";!s&&n&&(o=await n),t(o)})};return(0,s.jsx)(a.Z,{className:"mb-3",children:(0,s.jsxs)(r.Z,{className:"h-100 shadow-sm",children:[(0,s.jsx)(r.Z.Header,{children:e.title}),(0,s.jsx)(r.Z.Body,{children:(0,s.jsxs)(i.Z,{variant:"flush",children:[(0,s.jsx)(i.Z.Item,{children:(0,s.jsxs)("div",{className:"d-sm-flex",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"TCP"}),(0,s.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-download",children:null!==(n=e.latency.tcp)&&void 0!==n?n:"N/A"})]})}),(0,s.jsx)(i.Z.Item,{children:(0,s.jsxs)("div",{className:"d-sm-flex",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"UDP"}),(0,s.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-upload",children:null!==(t=e.latency.udp)&&void 0!==t?t:"N/A"})]})}),(0,s.jsx)(i.Z.Item,{children:(0,s.jsxs)(l.Z,{className:"d-sm-flex",children:[(0,s.jsxs)(c.Z,{onSelect:async n=>{(0,y.Uo)("/node",{method:"PUT",body:new L.Gy({tcp:"tcp"===n||"tcpudp"===n,udp:"udp"===n||"tcpudp"===n,hash:e.hash}).toBinary()}).then(async t=>{let{error:s}=t;void 0!==s?h.Error("change node failed, ".concat(s.code,"| ").concat(await s.msg)):h.Info("Change ".concat(n," Node To ").concat(e.hash," Successful"))})},as:l.Z,variant:"outline-primary",title:"USE",className:"w-100",children:[(0,s.jsx)(u.Z.Item,{eventKey:"tcpudp",children:"TCP&UDP"}),(0,s.jsx)(u.Z.Item,{eventKey:"tcp",children:"TCP"}),(0,s.jsx)(u.Z.Item,{eventKey:"udp",children:"UDP"})]}),(0,s.jsx)(d.Z,{variant:"outline-primary",className:"w-100",onClick:e.onClickEdit,children:"Edit"}),(0,s.jsxs)(d.Z,{variant:"outline-"+p(e.latency),className:"w-100",disabled:e.latency.tcpOnLoading||e.latency.udpOnLoading,onClick:async()=>{w(e=>{e.tcpOnLoading=!0,e.udpOnLoading=!0}),g(new T({protocol:{case:"http",value:new k({url:j.rQ})}}),e=>{w(async n=>{n.tcpOnLoading=!1,n.tcp=e})}),g(new T({protocol:{case:"dnsOverQuic",value:new B({host:j.gU,targetDomain:"www.google.com"})}}),e=>{w(async n=>{n.udpOnLoading=!1,n.udp=e})})},children:[(e.latency.tcpOnLoading||e.latency.udpOnLoading)&&(0,s.jsx)(m.Z,{size:"sm",animation:"border",variant:p(e.latency)}),"Test"]})]})})]})})]})})});class I{constructor(e){var n,t,s;this.point=null!==(n=null==e?void 0:e.point)&&void 0!==n?n:new C.x({}),this.hash=null!==(t=null==e?void 0:e.hash)&&void 0!==t?t:"",this.show=null!==(s=null==e?void 0:e.show)&&void 0!==s&&s,this.onDelete=null==e?void 0:e.onDelete}}var F=function(){let e=(0,o.useContext)(f.P),[n,t]=(0,o.useState)("Select..."),[r,i]=(0,o.useState)(new I),[c,m]=(0,o.useState)({data:!1}),[v,j]=(0,o.useState)({}),{data:J,error:S,isLoading:b,mutate:Z}=(0,g.ZP)("/nodes",(0,y.D4)(new N.BP));return void 0!==S?(0,s.jsx)(x(),{statusCode:S.code,title:S.msg}):b||void 0===J?(0,s.jsx)(p.Z,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(w.Z,{show:r.show,hash:r.hash,point:r.point,onDelete:r.onDelete,onChangePoint:e=>{i(n=>({...n,point:e}))},editable:!0,onHide:()=>i({...r,show:!1}),onSave:()=>Z(),groups:Object.keys(J.groupsV2).sort((e,n)=>e<=n?-1:1)}),(0,s.jsx)(w.b,{show:c.data,onSave:()=>Z(),onHide:()=>m({data:!1})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(h.Z,{children:(0,s.jsxs)(a.Z,{className:"mb-4 d-flex",children:[(0,s.jsxs)(u.Z,{onSelect:e=>{t(null!=e?e:"Select...")},children:[(0,s.jsx)(u.Z.Toggle,{variant:"light",children:null!=n?n:"GROUP"}),(0,s.jsxs)(u.Z.Menu,{children:[(0,s.jsx)(u.Z.Item,{eventKey:"Select...",children:"Select..."}),J.groupsV2&&Object.keys(J.groupsV2).sort((e,n)=>e<=n?-1:1).map(e=>(0,s.jsx)(u.Z.Item,{eventKey:e,children:e},e))]})]}),(0,s.jsxs)(l.Z,{className:"ms-2 d-flex",children:[(0,s.jsx)(d.Z,{variant:"outline-success",className:"w-100",onClick:()=>{i({point:new C.x({group:"template_group",name:"template_name",origin:C.h.manual}),hash:"new node",show:!0,onDelete:void 0})},children:"New"}),(0,s.jsx)(d.Z,{variant:"outline-success",className:"w-100",onClick:()=>{m({data:!0})},children:"Import"})]})]})}),n&&J.groupsV2&&J.groupsV2[n]?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(h.Z,{className:"row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4",children:Object.entries(J.groupsV2[n].nodesV2).sort((e,n)=>e<=n?-1:1).map(n=>{var t;let[o,a]=n;return(0,s.jsx)(E,{hash:a,title:o,latency:null!==(t=v[a])&&void 0!==t?t:{},onChangeLatency:e=>{j(n=>({...n,[a]:e}))},onClickEdit:()=>{J.nodes&&i({point:J.nodes[a],hash:a,show:!0,onDelete:()=>{(0,y.Uo)("/node",{method:"DELETE",body:new O.Gm({value:a}).toBinary()}).then(async n=>{let{error:t}=n;void 0!==t?e.Error("Delete Node ".concat(a," Failed ").concat(t.code,"| ").concat(await t.msg)):(e.Info("Delete Node ".concat(a," Successful.")),Z())})}})}},o)})})}):(0,s.jsx)(s.Fragment,{})]})]})}}},function(e){e.O(0,[453,154,633,728,386,713,116,240,860,178,186,971,69,744],function(){return e(e.s=9475)}),_N_E=e.O()}]);