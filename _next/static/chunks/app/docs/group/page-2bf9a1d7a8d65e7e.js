(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[962],{9475:function(e,n,t){Promise.resolve().then(t.bind(t,5752))},1308:function(e,n,t){"use strict";var o=t(7437),s=t(4860),i=t(1375),a=t.n(i);n.Z=function(e){return(0,o.jsxs)("div",{className:"z-1090 d-flex flex-column justify-content-center align-items-center",style:{height:"100px"},children:[void 0!==e.children&&(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(a(),{className:"p2",statusCode:void 0!==e.code?e.code:500,title:e.children})}),(0,o.jsx)("div",{className:"p2",children:(0,o.jsx)(s.Z,{})})]})}},6347:function(e,n,t){"use strict";t.d(n,{P:function(){return l},t:function(){return d}});var o=t(7437),s=t(2265),i=t(8215),a=t(9023);let l=(0,s.createContext)({Info:e=>{},Error:e=>{}}),d=e=>{let{children:n}=e,[t,d]=(0,s.useState)({value:{},index:0}),c=(e,n)=>{d(t=>(t.value[t.index]={text:e,type:n},t.index++,{...t}))};return(0,o.jsxs)(l.Provider,{value:{Info:e=>{console.log(e),c(e,"success")},Error:e=>{console.error(e),c(e,"danger")}},children:[(0,o.jsx)(a.Z,{className:"p-3",position:"top-center",containerPosition:"fixed",style:{zIndex:1},children:Object.entries(t.value).map(e=>{let[n,s]=e;return(0,o.jsxs)(i.Z,{role:"alert","aria-live":"assertive",show:!0,bg:s.type,onClose:()=>{let e=t.value;delete e[n],d({...t,value:e}),console.log("close: "+n)},"aria-atomic":"true",delay:4e3,autohide:!0,animation:!0,children:[(0,o.jsxs)(i.Z.Header,{children:[(0,o.jsx)("strong",{className:"me-auto",children:"Notification"}),(0,o.jsx)("small",{className:"text-muted",children:"just now"})]}),(0,o.jsx)(i.Z.Body,{className:"text-center",children:s.text})]},"toast"+n)})}),n]})}},5752:function(e,n,t){"use strict";t.r(n);var o=t(7437),s=t(2265),i=t(1329),a=t(4665),l=t(3572),d=t(4297),c=t(8036),r=t(3518),u=t(5503),h=t(6879),v=t(4860),p=t(6168),x=t(1308),m=t(6347),j=t(713),g=t(6934),y=t(1375),f=t.n(y),Z=t(8640);let b=Z.yE.point.point,C=Z.yE.protos.node.service.use_req,N=Z.lk.protobuf.StringValue,S=Z.yE.latency.requests,E=Z.yE.latency.response,P=1e9,O=60*P,k=60*O;n.default=function(){var e;let n=(0,s.useContext)(m.P),[t,y]=(0,s.useState)(""),[w,T]=(0,s.useState)(""),[_,I]=(0,s.useState)({point:"",hash:""}),[U,H]=(0,s.useState)({}),{data:V,error:D,isLoading:F,mutate:L}=(0,j.ZP)("/nodes",(0,g.PJ)(Z.yE.node.manager));if(void 0!==D)return(0,o.jsx)(f(),{statusCode:D.code,title:D.msg});if(F||void 0===V)return(0,o.jsx)(x.Z,{});let B=s.memo(e=>{var n,t;let s=e=>void 0===e?"N/A":e,i=n=>{H(t=>{let o=t[e.hash];return null==o&&(o={tcp:"N/A",udp:"N/A"}),n(o),t[e.hash]=o,{...t}})},a=(n,t)=>{(0,g.Uo)("/latency",{body:S.encode({requests:[{hash:e.hash,id:"latency",protocol:n}]}).finish(),process:async e=>{let n=E.decode(new Uint8Array(await e.arrayBuffer())),t=new Z.lk.protobuf.Duration(n.id_latency_map.latency);return void 0!==t&&(0!==t.nanos||0!==t.seconds)?function(e,n){let t=e*P+1*n;return t>=k?"".concat(t/k," h"):t>=O?"".concat(t/O," m"):t>=P?"".concat(t/P," s"):t>=1e6?"".concat(t/1e6," ms"):t>=1e3?"".concat(t/1e3," us"):"".concat(t/1," ns")}(t.seconds,t.nanos):"timeout"}}).then(async e=>{let{data:n,error:o}=e,s="timeout";void 0===o&&void 0!==n&&(s=await n),t(s)})};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(h.Z,{className:"rounded-pill bg-light text-dark ms-1 text-uppercase",children:["tcp: ",s(null===(n=e.latency)||void 0===n?void 0:n.tcp)]}),(0,o.jsxs)(h.Z,{className:"rounded-pill bg-light text-dark ms-1 me-1 text-uppercase",children:["udp:",s(null===(t=e.latency)||void 0===t?void 0:t.udp)]}),(0,o.jsx)(()=>{var n,t;return(null===(n=e.latency)||void 0===n?void 0:n.tcpOnLoading)||(null===(t=e.latency)||void 0===t?void 0:t.udpOnLoading)?(0,o.jsx)(v.Z,{animation:"border",size:"sm"}):(0,o.jsx)("a",{href:"#empty",onClick:async()=>{i(e=>{e.tcpOnLoading=!0,e.udpOnLoading=!0}),a({http:{url:"https://clients3.google.com/generate_204"}},e=>{i(async n=>{n.tcpOnLoading=!1,n.tcp=e})}),a({dns_over_quic:{host:"dns.nextdns.io:853",target_domain:"www.google.com"}},e=>{i(async n=>{n.udpOnLoading=!1,n.udp=e})})},children:"Test"})},{})]})}),A=s.memo(e=>{let n=Object.entries(void 0!==e.nodes&&null!==e.nodes?e.nodes:{});return 0===n.length?(0,o.jsx)(r.Z.Body,{children:(0,o.jsx)("div",{className:"text-center my-2",style:{opacity:"0.4"},children:"グールプはまだ指定されていません。"})}):(0,o.jsx)(u.Z,{variant:"flush",children:n.sort((e,n)=>e<=n?-1:1).map(e=>{let[n,s]=e;return(0,o.jsxs)(u.Z.Item,{as:"label",style:{border:"0ch",borderBottom:"1px solid #dee2e6"},children:[(0,o.jsx)("input",{className:"form-check-input me-1",type:"radio",name:"select_node",value:s,onChange:e=>{y(e.target.value)},checked:t===s}),(0,o.jsx)("a",{href:"#",onClick:e=>{if(e.preventDefault(),null===V.nodes||void 0===V.nodes)return;let n=V.nodes[s];I({point:void 0!==n?JSON.stringify(b.toObject(b.create(n),g.Ts),null,"  "):"",hash:s})},children:n}),(0,o.jsx)(B,{hash:s,latency:U[s]})]},s)})})});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(p.Z,{show:""!==_.point&&""!==_.hash,hash:_.hash,point:_.point,onChangePoint:e=>{I(n=>({...n,point:e}))},editable:!0,onHide:()=>I({point:"",hash:""}),onSave:()=>L()}),(0,o.jsxs)("div",{children:[(0,o.jsx)(i.Z,{children:(0,o.jsx)(a.Z,{className:"mb-4 d-flex",children:(0,o.jsxs)(c.Z,{onSelect:e=>{T(null!=e?e:"")},children:[(0,o.jsx)(c.Z.Toggle,{variant:"light",children:""!==w?w:"GROUP"}),(0,o.jsxs)(c.Z.Menu,{children:[(0,o.jsx)(c.Z.Item,{eventKey:"",children:"Select..."}),null!==V.groupsV2&&void 0!==V.groupsV2&&Object.keys(V.groupsV2).sort((e,n)=>e<=n?-1:1).map(e=>(0,o.jsx)(c.Z.Item,{eventKey:e,children:e},e))]})]})})}),(0,o.jsxs)(r.Z,{className:"mb-3",children:[(0,o.jsx)(A,{nodes:""!==w&&null!==V.groupsV2&&void 0!==V.groupsV2?null===(e=V.groupsV2[w])||void 0===e?void 0:e.nodesV2:void 0}),(0,o.jsx)(r.Z.Header,{children:(0,o.jsx)(c.Z,{onSelect:async e=>{(0,g.Uo)("/node",{method:"PUT",body:C.encode({tcp:"tcp"===e||"tcpudp"===e,udp:"udp"===e||"tcpudp"===e,hash:t}).finish()}).then(async o=>{let{error:s}=o;void 0!==s?n.Error("change node failed, ".concat(s.code,"| ").concat(await s.msg)):n.Info("Change".concat(e," Node To ").concat(t," Successful"))})},children:(0,o.jsxs)(l.Z,{children:[(0,o.jsxs)(l.Z,{children:[(0,o.jsx)(c.Z.Toggle,{variant:"outline-primary",children:"USE"}),(0,o.jsxs)(c.Z.Menu,{children:[(0,o.jsx)(c.Z.Item,{eventKey:"tcpudp",children:"TCP&UDP"}),(0,o.jsx)(c.Z.Item,{eventKey:"tcp",children:"TCP"}),(0,o.jsx)(c.Z.Item,{eventKey:"udp",children:"UDP"})]})]}),(0,o.jsx)(d.Z,{variant:"outline-danger",onClick:()=>{(0,g.Uo)("/node",{method:"DELETE",body:N.encode({value:t}).finish()}).then(async e=>{let{error:o}=e;void 0!==o?n.Error("Delete Node ".concat(t," Failed ").concat(o.code,"| ").concat(await o.msg)):(n.Info("Delete Node ".concat(t," Successful.")),L())})},children:"DELETE"})]})})})]})]})]})}},6168:function(e,n,t){"use strict";var o=t(7437),s=t(2265),i=t(4297),a=t(1701),l=t(733),d=t(6879),c=t(713),r=t(6934),u=t(1308),h=t(1375),v=t.n(h),p=t(6347),x=t(8640);let m=x.lk.protobuf.StringValue,j=x.yE.point.point;n.Z=function(e){let n=(0,s.useContext)(p.P),{data:t,error:h,isLoading:x,mutate:g}=(0,c.ZP)(void 0===e.point&&""!==e.hash&&void 0!==e.hash?"/node":null,(0,r.Sh)(j,"POST",m.encode({value:e.hash}).finish())),[y,f]=(0,s.useState)({msg:"",code:0});return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(a.Z,{show:e.show,"aria-labelledby":"contained-modal-title-vcenter",size:"xl",onHide:()=>{e.onHide()},centered:!0,children:[(0,o.jsx)(a.Z.Header,{closeButton:!0,children:(0,o.jsx)(a.Z.Title,{id:"contained-modal-title-vcenter",children:e.hash})}),(0,o.jsx)(a.Z.Body,{children:void 0!==h?(0,o.jsx)(v(),{statusCode:h.code,title:h.msg}):x?(0,o.jsx)(u.Z,{}):(0,o.jsx)(l.Z.Control,{as:"textarea",value:void 0!==t?t:e.point,style:{height:"65vh",fontFamily:"monospace"},readOnly:!e.editable,onChange:n=>{void 0!==e.hash&&g(n.target.value,!1),void 0!==e.point&&void 0!==e.onChangePoint&&e.onChangePoint(n.target.value)}})}),(0,o.jsxs)(a.Z.Footer,{children:[""!==y.msg&&(0,o.jsxs)(d.Z,{bg:"danger",children:[y.code," | ",y.msg]}),(0,o.jsx)(i.Z,{variant:"secondary",onClick:()=>{e.onHide()},children:"Close"}),(0,o.jsx)(()=>void 0!==e.editable&&e.editable?(0,o.jsx)(i.Z,{variant:"primary",active:!x&&void 0===h,onClick:()=>{(0,r.Uo)("/node",{method:"PATCH",body:j.encode(j.fromObject(JSON.parse(void 0!==t?t:void 0!==e.point?e.point:"{}"))).finish()}).then(async t=>{let{error:o}=t;if(void 0===o)n.Info("save successful"),void 0!==e.onSave&&e.onSave(),e.onHide();else{let e=await o.msg;n.Error(e),f({msg:e,code:o.code}),setTimeout(()=>{f({msg:"",code:0})},5e3)}})},children:"Save"}):(0,o.jsx)(o.Fragment,{}),{})]})]})})}}},function(e){e.O(0,[359,441,331,895,8,946,722,326,337,419,971,596,744],function(){return e(e.s=9475)}),_N_E=e.O()}]);