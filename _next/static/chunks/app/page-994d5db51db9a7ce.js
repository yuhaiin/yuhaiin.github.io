(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{5717:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(29300),i=s.n(a),n=s(12115),l=s(97390),d=s(95155);let o=n.forwardRef((e,t)=>{let{bsPrefix:s,bg:a="primary",pill:n=!1,text:o,className:r,as:c="span",...m}=e,h=(0,l.oU)(s,"badge");return(0,d.jsx)(c,{ref:t,...m,className:i()(r,h,n&&"rounded-pill",o&&"text-".concat(o),a&&"bg-".concat(a))})});o.displayName="Badge";let r=o},26506:(e,t,s)=>{"use strict";s.d(t,{TH:()=>p,c5:()=>v,gW:()=>x,z3:()=>y});var a=s(95155),i=s(12115),n=s(69056),l=s(5717),d=s(76355),o=s(19169),r=s(98508),c=s(87494),m=s(29940),h=s(70715),u=s(3384);let x=e=>{let{itemKey:t,itemValue:s}=e;return""==s?(0,a.jsx)(a.Fragment,{}):(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(n.A.Item,{children:(0,a.jsxs)("div",{className:"d-sm-flex",children:[(0,a.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-capitalize",children:t}),(0,a.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:s})]})})})},p=e=>{var t,s;let{value:d,startContent:o,endContent:r}=e,[u,p]=(0,i.useState)({show:!1,hash:""}),j=(0,i.useCallback)(e=>{p({show:!0,hash:e})},[p]),y=(0,i.useCallback)(()=>{p(e=>({...e,show:!1}))},[p]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.y,{show:u.show,hash:u.hash,editable:!1,onHide:y}),(0,a.jsxs)(n.A,{variant:"flush",className:"w-100 p-2",children:[o,(0,a.jsx)(x,{itemKey:"Id",itemValue:d.id.toString()}),(0,a.jsx)(x,{itemKey:"Addr",itemValue:d.addr}),(0,a.jsx)(x,{itemKey:"Type",itemValue:h.NW[null==(t=d.type)?void 0:t.connType]}),(0,a.jsx)(x,{itemKey:"UnderlyingType",itemValue:h.NW[null==(s=d.type)?void 0:s.underlyingType]}),(0,a.jsx)(x,{itemKey:"Inbound",itemValue:d.inboundName}),(0,a.jsx)(x,{itemKey:"InboundAddr",itemValue:d.inbound}),(0,a.jsx)(x,{itemKey:"Source",itemValue:d.source}),(0,a.jsx)(x,{itemKey:"Outbound",itemValue:d.outbound}),(0,a.jsx)(x,{itemKey:"LocalAddr",itemValue:d.localAddr}),(0,a.jsx)(x,{itemKey:"Destination",itemValue:d.destionation}),(0,a.jsx)(x,{itemKey:"FakeIP",itemValue:d.fakeIp}),(0,a.jsx)(x,{itemKey:"Hosts",itemValue:d.hosts}),(0,a.jsx)(x,{itemKey:"Domain",itemValue:d.domain}),(0,a.jsx)(x,{itemKey:"IP",itemValue:d.ip}),(0,a.jsx)(x,{itemKey:"Tag",itemValue:d.tag}),(d.nodeName||d.hash)&&(0,a.jsx)(n.A.Item,{children:(0,a.jsxs)("div",{className:"d-sm-flex",children:[(0,a.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-capitalize",children:"Point"}),(0,a.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:(0,a.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),j(d.hash)},children:d.nodeName?d.nodeName:d.hash})})]})}),(0,a.jsx)(x,{itemKey:"Protocol",itemValue:d.protocol}),(0,a.jsx)(x,{itemKey:"Process",itemValue:d.process}),(0,a.jsx)(x,{itemKey:"TlsServerName",itemValue:d.tlsServerName}),(0,a.jsx)(x,{itemKey:"HttpHost",itemValue:d.httpHost}),(0,a.jsx)(x,{itemKey:"Component",itemValue:d.component}),(0,a.jsx)(x,{itemKey:"Mode",itemValue:m.Mq[d.mode]}),(0,a.jsx)(x,{itemKey:"UdpMigrateId",itemValue:d.udpMigrateId?d.udpMigrateId.toString():""}),(0,a.jsx)(x,{itemKey:"Pid",itemValue:d.pid?d.pid.toString():""}),(0,a.jsx)(x,{itemKey:"Uid",itemValue:d.uid?d.uid.toString():""}),d.matchHistory&&d.matchHistory.length>0&&(0,a.jsx)(n.A.Item,{children:(0,a.jsxs)("div",{className:"d-sm-flex",children:[(0,a.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-capitalize",children:"MatchHistory"}),(0,a.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:d.matchHistory.map((e,t)=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,a.jsx)("div",{style:{flex:1,height:"1px",background:"black"}}),(0,a.jsx)("span",{children:(0,a.jsx)("b",{children:e.ruleName})}),(0,a.jsx)("div",{style:{flex:1,height:"1px",background:"black"}})]}),(0,a.jsx)("div",{className:"mt-2 mb-2",children:e.history&&e.history.map((e,t)=>(0,a.jsx)("div",{children:(0,a.jsxs)("div",{children:[e.matched?(0,a.jsx)(l.A,{bg:"success",children:"Hit"}):(0,a.jsx)(l.A,{bg:"danger",children:"Miss"})," ",e.listName]})},"list-"+e.listName+t))})]},"rule-"+e.ruleName+t))})]})}),r]})]})},j={B:"B",KB:"KB",MB:"MB",GB:"GB",TB:"TB",PB:"PB"},y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,{bytes:s,unit:a}=e>=0x4000000000000?{bytes:e/0x4000000000000,unit:j.PB}:e>=0x10000000000?{bytes:e/0x10000000000,unit:j.TB}:e>=0x40000000?{bytes:e/0x40000000,unit:j.GB}:e>=1048576?{bytes:e/1048576,unit:j.MB}:e>=1024?{bytes:e/1024,unit:j.KB}:{bytes:e,unit:j.B};return"".concat(s.toFixed(t)).concat(a)};class g{DownloadString(){let e=y(this.download),t=y(this.download_rate)+"/S";return"(".concat(e,"): ").concat(t)}UploadString(){let e=y(this.upload),t=y(this.upload_rate)+"/S";return"(".concat(e,"): ").concat(t)}constructor(e=0,t=0,s=0,a=0,i={}){this.download=e,this.download_rate=t,this.upload=s,this.upload_rate=a,this.counters=i,this.time=new Date}}let b=e=>{let{lastFlow:t,flow_error:s,end_content:i}=e;return(0,a.jsx)(d.A,{className:"mb-3",children:(0,a.jsxs)(n.A,{variant:"flush",children:[(0,a.jsx)(n.A.Item,{children:(0,a.jsxs)("div",{className:"d-sm-flex",children:[(0,a.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Download"}),(0,a.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-download",children:s?s.msg:t?t.DownloadString():"Loading..."})]})}),(0,a.jsx)(n.A.Item,{children:(0,a.jsxs)("div",{className:"d-sm-flex",children:[(0,a.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Upload"}),(0,a.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-upload",children:s?s.msg:t?t.UploadString():"Loading..."})]})}),i]})})},v=i.memo(e=>{let{onUpdate:t,end_content:s}=e,{data:n,error:l}=(()=>{let[e,t]=(0,i.useState)(new g(0,0,0,0,{}));return(0,o.Ay)((0,r.cY)(u.oQ.method.total),async()=>(0,r.kP)(u.oQ.method.total).then(async s=>{let{data:a,error:i}=s;if(i)throw i;if(a)try{let s=((e,t)=>{let s=(new Date().getTime()-t.time.getTime())/1e3,a=0,i=0;if((0!==t.download||0!==t.upload)&&0!==s){let n=Number(e.download),l=Number(e.upload);a=(n-t.download)/s,i=(l-t.upload)/s}return{download_rate:a,upload_rate:i}})(a,e),i=new g(Number(a.download),s.download_rate,Number(a.upload),s.upload_rate,a.counters);return t(i),i}catch(e){throw{msg:e.toString(),code:500}}}),{refreshInterval:2e3})})();return(0,i.useEffect)(()=>{t&&n&&t(n.counters)},[t,n]),(0,a.jsx)(b,{lastFlow:n,flow_error:l,end_content:s})})},49490:(e,t,s)=>{Promise.resolve().then(s.bind(s,81133))},81133:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(95155),i=s(20960),n=s(12115),l=s(69056),d=s(98508),o=s(26506),r=s(87494),c=s(88580),m=s(8408);let h=function(){let[e,t]=(0,n.useState)({show:!1,point:(0,i.v)(m.Ac,{})}),{data:s,error:h,isLoading:u}=(0,d.mp)(c.rH.method.now);return(0,a.jsxs)("div",{children:[(0,a.jsx)(r.y,{show:e.show,hash:e.point.hash,point:e.point,editable:!1,onHide:()=>t({...e,show:!1})}),(0,a.jsx)(o.c5,{end_content:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.A.Item,{children:(0,a.jsxs)("div",{className:"d-sm-flex",children:[(0,a.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"TCP"}),(0,a.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-download",children:u?"loading...":h?h.msg:(0,a.jsxs)("a",{href:"#",onClick:()=>{t({show:!0,point:s.tcp})},children:[s.tcp.group,"/",s.tcp.name]})})]})}),(0,a.jsx)(l.A.Item,{children:(0,a.jsxs)("div",{className:"d-sm-flex",children:[(0,a.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"UDP"}),(0,a.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-upload",children:u?"loading...":h?h.msg:(0,a.jsxs)("a",{href:"#",onClick:()=>{t({show:!0,point:s.udp})},children:[s.udp.group,"/",s.udp.name]})})]})})]})})]})};function u(){return(0,a.jsx)("div",{children:(0,a.jsx)(h,{})})}},99695:(e,t,s)=>{"use strict";s.d(t,{i:()=>n,w:()=>l});var a=s(9152),i=s(78133);let n=(0,a.w)("Ch9nb29nbGUvcHJvdG9idWYvdGltZXN0YW1wLnByb3RvEg9nb29nbGUucHJvdG9idWYiKwoJVGltZXN0YW1wEg8KB3NlY29uZHMYASABKAMSDQoFbmFub3MYAiABKAVChQEKE2NvbS5nb29nbGUucHJvdG9idWZCDlRpbWVzdGFtcFByb3RvUAFaMmdvb2dsZS5nb2xhbmcub3JnL3Byb3RvYnVmL3R5cGVzL2tub3duL3RpbWVzdGFtcHBi+AEBogIDR1BCqgIeR29vZ2xlLlByb3RvYnVmLldlbGxLbm93blR5cGVzYgZwcm90bzM"),l=(0,i.Z)(n,0)}},e=>{e.O(0,[3528,11,3597,3779,1085,9349,7315,8684,4905,3959,5309,626,7494,3384,8441,5964,7358],()=>e(e.s=49490)),_N_E=e.O()}]);