(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,a,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"warnOnce",{enumerable:!0,get:function(){return t}});let t=e=>{}},5577,e=>{"use strict";var a=e.i(37116);e.s(["FloatingLabel",()=>a.default])},18818,e=>{"use strict";var a=e.i(7670),s=e.i(71645),t=e.i(36333),o=e.i(43476);let l=s.forwardRef(({bsPrefix:e,bg:s="primary",pill:l=!1,text:r,className:i,as:n="span",...c},d)=>{let m=(0,t.useBootstrapPrefix)(e,"badge");return(0,o.jsx)(n,{ref:d,...c,className:(0,a.default)(i,m,l&&"rounded-pill",r&&`text-${r}`,s&&`bg-${s}`)})});l.displayName="Badge",e.s(["Badge",0,l],18818)},98768,e=>{"use strict";var a=e.i(43476),s=e.i(932),t=e.i(91287),o=e.i(30223),l=e.i(95901),r=e.i(78438),i=e.i(71645),n=e.i(18818),c=e.i(45535),d=e.i(7495),m=e.i(46219),u=e.i(48323),h=e.i(5577),p=e.i(78817),b=e.i(42716),g=e.i(19430),x=e.i(5260),f=e.i(36621),j=e.i(6242),S=e.i(2893),C=e.i(39848),v=e.i(31786),w=e.i(41703),y=e.i(81362);function N(e){let o,l,r,n,m,b,g,f,j,S,N,P,_,F,B,k,L,E,T,G,I,M,O,D,R,A,H,$=(0,s.c)(77),{show:U,isEdit:Y,onHide:z,item:W,configName:q,nodes:K,mutatePub:V}=e;$[0]!==W?(o=W?(0,t.create)(y.PublishSchema,W):(0,t.create)(y.PublishSchema,{name:"",path:"",password:"",points:[],address:window.location.host,insecure:"https:"!==window.location.protocol}),$[0]=W,$[1]=o):o=$[1];let[J,Q]=(0,i.useState)(o),[X,Z]=(0,i.useState)(q||"");$[2]!==W?.points?(l=W?.points||[],$[2]=W?.points,$[3]=l):l=$[3];let[ee,ea]=(0,i.useState)(l),es=(0,i.useContext)(v.GlobalToastContext);$[4]===Symbol.for("react.memo_cache_sentinel")?(r=e=>{ea(a=>a.includes(e)?a.filter(a=>a!==e):[...a,e])},$[4]=r):r=$[4];let et=r;$[5]!==X||$[6]!==es||$[7]!==V||$[8]!==J||$[9]!==z||$[10]!==ee?(n=()=>{if(!X||!J.name)return void es.Error("Configuration Name and Subscription Name are required.");let e=(0,t.create)(w.SavePublishRequestSchema,{name:X,publish:(0,t.create)(y.PublishSchema,{...J,points:ee})});(0,C.FetchProtobuf)(w.subscribe.method.save_publish,e).then(e=>{let{error:a}=e;a?es.Error(`Failed to save publish config: ${a.msg}`):(es.Info("Successfully saved publish config."),V(),z())})},$[5]=X,$[6]=es,$[7]=V,$[8]=J,$[9]=z,$[10]=ee,$[11]=n):n=$[11];let eo=n,el=Y?"Edit":"Add";if($[12]!==el?(m=(0,a.jsx)(x.Modal.Header,{closeButton:!0,children:(0,a.jsxs)(x.Modal.Title,{children:[el," Publish Configuration"]})}),$[12]=el,$[13]=m):m=$[13],$[14]===Symbol.for("react.memo_cache_sentinel")?(b=e=>Z(e.target.value),$[14]=b):b=$[14],$[15]!==X||$[16]!==Y?(g=(0,a.jsx)(h.FloatingLabel,{label:"Configuration Name",className:"mb-3",children:(0,a.jsx)(p.Form.Control,{placeholder:"my-awesome-config",value:X,onChange:b,disabled:Y})}),$[15]=X,$[16]=Y,$[17]=g):g=$[17],$[18]!==J?(f=e=>Q((0,t.create)(y.PublishSchema,{...J,name:e.target.value})),$[18]=J,$[19]=f):f=$[19],$[20]!==J.name||$[21]!==f?(j=(0,a.jsx)(h.FloatingLabel,{label:"Subscription Name",className:"mb-3",children:(0,a.jsx)(p.Form.Control,{placeholder:"my-sub",value:J.name,onChange:f})}),$[20]=J.name,$[21]=f,$[22]=j):j=$[22],$[23]!==J?(S=e=>Q((0,t.create)(y.PublishSchema,{...J,path:e.target.value})),$[23]=J,$[24]=S):S=$[24],$[25]!==J.path||$[26]!==S?(N=(0,a.jsx)(h.FloatingLabel,{label:"Subscription Path",className:"mb-3",children:(0,a.jsx)(p.Form.Control,{placeholder:"custom/path",value:J.path,onChange:S})}),$[25]=J.path,$[26]=S,$[27]=N):N=$[27],$[28]!==J?(P=e=>Q((0,t.create)(y.PublishSchema,{...J,password:e.target.value})),$[28]=J,$[29]=P):P=$[29],$[30]!==J.password||$[31]!==P?(_=(0,a.jsx)(h.FloatingLabel,{label:"Password",className:"mb-3",children:(0,a.jsx)(p.Form.Control,{type:"password",placeholder:"password",value:J.password,onChange:P})}),$[30]=J.password,$[31]=P,$[32]=_):_=$[32],$[33]!==J?(F=e=>Q((0,t.create)(y.PublishSchema,{...J,address:e.target.value})),$[33]=J,$[34]=F):F=$[34],$[35]!==J.address||$[36]!==F?(B=(0,a.jsx)(h.FloatingLabel,{label:"Address",className:"mb-3",children:(0,a.jsx)(p.Form.Control,{placeholder:"example.com:443",value:J.address,onChange:F})}),$[35]=J.address,$[36]=F,$[37]=B):B=$[37],$[38]!==J?(k=e=>Q((0,t.create)(y.PublishSchema,{...J,insecure:e.target.checked})),$[38]=J,$[39]=k):k=$[39],$[40]!==J.insecure||$[41]!==k?(L=(0,a.jsx)(p.Form.Check,{type:"switch",label:"Insecure",checked:J.insecure,onChange:k,className:"mb-3"}),$[40]=J.insecure,$[41]=k,$[42]=L):L=$[42],$[43]!==ee.length?(E=(0,a.jsxs)(u.Dropdown.Toggle,{variant:"outline-secondary",className:"w-100",children:["Select Nodes (",ee.length,")"]}),$[43]=ee.length,$[44]=E):E=$[44],$[45]===Symbol.for("react.memo_cache_sentinel")?(T={maxHeight:"200px",overflowY:"auto"},$[45]=T):T=$[45],$[46]!==K.groups||$[47]!==ee){let e;$[49]!==ee?(e=e=>(0,a.jsxs)("div",{children:[(0,a.jsx)(u.Dropdown.Header,{children:e.name}),e.nodes.map(e=>(0,a.jsx)(u.Dropdown.ItemText,{children:(0,a.jsx)(p.Form.Check,{type:"checkbox",label:e.name,checked:ee.includes(e.hash),onChange:()=>et(e.hash)})},e.hash))]},e.name),$[49]=ee,$[50]=e):e=$[50],G=K.groups.map(e),$[46]=K.groups,$[47]=ee,$[48]=G}else G=$[48];return $[51]!==G?(I=(0,a.jsx)(u.Dropdown.Menu,{style:T,children:G}),$[51]=G,$[52]=I):I=$[52],$[53]!==E||$[54]!==I?(M=(0,a.jsxs)(u.Dropdown,{as:d.ButtonGroup,className:"d-block mb-3",children:[E,I]}),$[53]=E,$[54]=I,$[55]=M):M=$[55],$[56]!==N||$[57]!==_||$[58]!==B||$[59]!==L||$[60]!==M||$[61]!==g||$[62]!==j?(O=(0,a.jsxs)(x.Modal.Body,{children:[g,j,N,_,B,L,M]}),$[56]=N,$[57]=_,$[58]=B,$[59]=L,$[60]=M,$[61]=g,$[62]=j,$[63]=O):O=$[63],$[64]!==z?(D=(0,a.jsx)(c.Button,{variant:"secondary",onClick:z,children:"Cancel"}),$[64]=z,$[65]=D):D=$[65],$[66]!==eo?(R=(0,a.jsx)(c.Button,{variant:"primary",onClick:eo,children:"Save"}),$[66]=eo,$[67]=R):R=$[67],$[68]!==D||$[69]!==R?(A=(0,a.jsxs)(x.Modal.Footer,{children:[D,R]}),$[68]=D,$[69]=R,$[70]=A):A=$[70],$[71]!==z||$[72]!==U||$[73]!==O||$[74]!==A||$[75]!==m?(H=(0,a.jsxs)(x.Modal,{show:U,onHide:z,centered:!0,children:[m,O,A]}),$[71]=z,$[72]=U,$[73]=O,$[74]=A,$[75]=m,$[76]=H):H=$[76],H}e.s(["default",0,function(){let e,u,h,x,P,_,F,B,k,L,E,T,G,I,M,O,D=(0,s.c)(47),{data:R,error:A,isLoading:H,mutate:$}=(0,C.useProtoSWR)(w.subscribe.method.list_publish),{data:U,error:Y,isLoading:z}=(0,C.useProtoSWR)(w.node.method.list),[W,q]=(0,i.useState)(!1),[K,V]=(0,i.useState)(!1),[J,Q]=(0,i.useState)(void 0),[X,Z]=(0,i.useState)(void 0);D[0]===Symbol.for("react.memo_cache_sentinel")?(e={show:!1,name:""},D[0]=e):e=D[0];let[ee,ea]=(0,i.useState)(e),es=(0,i.useContext)(v.GlobalToastContext);D[1]!==es?(u={onCopyError:e=>es.Error(e.message),usePromptAsFallback:!0},D[1]=es,D[2]=u):u=D[2];let{copy:et,copied:eo}=(0,f.useClipboard)(u);if(D[3]!==eo||D[4]!==es?(h=()=>{eo&&es.Info("Copied to clipboard!")},x=[eo,es],D[3]=eo,D[4]=es,D[5]=h,D[6]=x):(h=D[5],x=D[6]),(0,i.useEffect)(h,x),A){let e;return D[7]!==A.code||D[8]!==A.msg?(e=(0,a.jsx)(r.default,{statusCode:A.code,title:A.msg}),D[7]=A.code,D[8]=A.msg,D[9]=e):e=D[9],e}if(Y){let e;return D[10]!==Y.code||D[11]!==Y.msg?(e=(0,a.jsx)(r.default,{statusCode:Y.code,title:Y.msg}),D[10]=Y.code,D[11]=Y.msg,D[12]=e):e=D[12],e}if(H||z||!R||!U){let e;return D[13]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(S.default,{}),D[13]=e):e=D[13],e}D[14]!==es||D[15]!==$?(P=e=>{(0,C.FetchProtobuf)(w.subscribe.method.remove_publish,(0,t.create)(l.StringValueSchema,{value:e})).then(e=>{let{error:a}=e;a?es.Error(`Failed to remove publish config: ${a.msg}`):(es.Info("Successfully removed publish config."),$())})},D[14]=es,D[15]=$,D[16]=P):P=D[16];let el=P;D[17]===Symbol.for("react.memo_cache_sentinel")?(_=(e,a,s)=>{V(e),Q(s),Z(a),q(!0)},D[17]=_):_=D[17];let er=_;D[18]===Symbol.for("react.memo_cache_sentinel")?(F=()=>{q(!1),Q(void 0),Z(void 0)},D[18]=F):F=D[18];let ei=F;return D[19]!==ee.name?(B=(0,a.jsxs)("p",{children:["Delete publish configuration ",ee.name,"?"]}),D[19]=ee.name,D[20]=B):B=D[20],D[21]===Symbol.for("react.memo_cache_sentinel")?(k=()=>ea({show:!1,name:""}),D[21]=k):k=D[21],D[22]!==ee.name||D[23]!==el?(L=()=>{el(ee.name),ea({show:!1,name:""})},D[22]=ee.name,D[23]=el,D[24]=L):L=D[24],D[25]!==ee.show||D[26]!==B||D[27]!==L?(E=(0,a.jsx)(j.ConfirmModal,{show:ee.show,content:B,onHide:k,onOk:L}),D[25]=ee.show,D[26]=B,D[27]=L,D[28]=E):E=D[28],D[29]!==eo||D[30]!==et||D[31]!==R.publishes?(T=Object.entries(R.publishes).map(e=>{let[s,l]=e,r=(0,t.create)(y.YuhaiinUrl_RemoteSchema,{publish:(0,t.create)(y.PublishSchema,{...l,points:[]})}),i=(0,t.create)(y.YuhaiinUrlSchema,{name:l.name,url:{value:r,case:"remote"}}),m=`yuhaiin://${btoa(String.fromCharCode(...(0,o.toBinary)(y.YuhaiinUrlSchema,i))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}`;return(0,a.jsxs)(g.ListGroup.Item,{className:"mb-3 d-flex flex-column flex-md-row justify-content-between align-items-md-center",children:[(0,a.jsx)(n.Badge,{bg:"primary",className:"me-2",children:s}),(0,a.jsx)("span",{className:"me-2",children:l.name}),(0,a.jsxs)(b.InputGroup,{size:"sm",className:"me-2",children:[(0,a.jsx)(p.Form.Control,{readOnly:!0,value:m,style:{minWidth:"200px"}}),(0,a.jsx)(c.Button,{variant:"outline-secondary",onClick:()=>et(m),children:eo?"Copied":"Copy"})]}),(0,a.jsxs)(d.ButtonGroup,{children:[(0,a.jsx)(c.Button,{variant:"outline-primary",size:"sm",onClick:()=>er(!0,s,l),children:"Edit"}),(0,a.jsx)(c.Button,{variant:"outline-danger",size:"sm",onClick:()=>ea({show:!0,name:s}),children:"Delete"})]})]},s)}),D[29]=eo,D[30]=et,D[31]=R.publishes,D[32]=T):T=D[32],D[33]===Symbol.for("react.memo_cache_sentinel")?(G=(0,a.jsx)(g.ListGroup.Item,{className:"d-sm-flex",children:(0,a.jsxs)(c.Button,{variant:"outline-success",className:"flex-grow-1",onClick:()=>er(!1),children:[(0,a.jsx)("i",{className:"bi bi-plus-lg"}),"Add New Publish"]})}),D[33]=G):G=D[33],D[34]!==T?(I=(0,a.jsx)(m.Card,{children:(0,a.jsxs)(g.ListGroup,{variant:"flush",children:[T,G]})}),D[34]=T,D[35]=I):I=D[35],D[36]!==X||D[37]!==J||D[38]!==K||D[39]!==$||D[40]!==U||D[41]!==W?(M=W&&(0,a.jsx)(N,{show:W,isEdit:K,onHide:ei,item:J,configName:X,nodes:U,mutatePub:$}),D[36]=X,D[37]=J,D[38]=K,D[39]=$,D[40]=U,D[41]=W,D[42]=M):M=D[42],D[43]!==E||D[44]!==I||D[45]!==M?(O=(0,a.jsxs)(a.Fragment,{children:[E,I,M]}),D[43]=E,D[44]=I,D[45]=M,D[46]=O):O=D[46],O}])}]);