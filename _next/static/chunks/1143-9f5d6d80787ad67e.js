"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1143],{40574:(e,t,a)=>{a.d(t,{A:()=>o});var s=a(2821),i=a(12115),l=a(76837),n=a(95155);let d=i.forwardRef((e,t)=>{let{bsPrefix:a,bg:i="primary",pill:d=!1,text:o,className:r,as:m="span",...c}=e,u=(0,l.oU)(a,"badge");return(0,n.jsx)(m,{ref:t,...c,className:(0,s.A)(r,u,d&&"rounded-pill",o&&"text-".concat(o),i&&"bg-".concat(i))})});d.displayName="Badge";let o=d},41143:(e,t,a)=>{a.d(t,{TH:()=>j,c5:()=>w,gW:()=>h,z3:()=>p});var s=a(95155),i=a(12115),l=a(79039),n=a(40574),d=a(41531),o=a(46512),r=a(46057),m=a(48603),c=a(59115),u=a(48948),x=a(99401);let h=e=>{let{itemKey:t,itemValue:a}=e;return""==a?(0,s.jsx)(s.Fragment,{}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(l.A.Item,{children:(0,s.jsxs)("div",{className:"d-sm-flex",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-capitalize",children:t}),(0,s.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:a})]})})})},j=e=>{var t,a;let{value:d,startContent:o,endContent:r}=e,[x,j]=(0,i.useState)({show:!1,hash:""}),y=(0,i.useCallback)(e=>{j({show:!0,hash:e})},[j]),p=(0,i.useCallback)(()=>{j(e=>({...e,show:!1}))},[j]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.y,{show:x.show,hash:x.hash,editable:!1,onHide:p}),(0,s.jsxs)(l.A,{variant:"flush",className:"w-100 p-2",children:[o,(0,s.jsx)(h,{itemKey:"Id",itemValue:d.id.toString()}),(0,s.jsx)(h,{itemKey:"Addr",itemValue:d.addr}),(0,s.jsx)(h,{itemKey:"Type",itemValue:u.NW[null==(t=d.type)?void 0:t.connType]}),(0,s.jsx)(h,{itemKey:"UnderlyingType",itemValue:u.NW[null==(a=d.type)?void 0:a.underlyingType]}),(0,s.jsx)(h,{itemKey:"Inbound",itemValue:d.inboundName}),(0,s.jsx)(h,{itemKey:"InboundAddr",itemValue:d.inbound}),(0,s.jsx)(h,{itemKey:"Source",itemValue:d.source}),(0,s.jsx)(h,{itemKey:"Outbound",itemValue:d.outbound}),(0,s.jsx)(h,{itemKey:"Interface",itemValue:d.interface}),(0,s.jsx)(h,{itemKey:"LocalAddr",itemValue:d.localAddr}),(0,s.jsx)(h,{itemKey:"Destination",itemValue:d.destionation}),(0,s.jsx)(h,{itemKey:"FakeIP",itemValue:d.fakeIp}),(0,s.jsx)(h,{itemKey:"Hosts",itemValue:d.hosts}),(0,s.jsx)(h,{itemKey:"Domain",itemValue:d.domain}),(0,s.jsx)(h,{itemKey:"IP",itemValue:d.ip}),(0,s.jsx)(h,{itemKey:"Tag",itemValue:d.tag}),(d.nodeName||d.hash)&&(0,s.jsx)(l.A.Item,{children:(0,s.jsxs)("div",{className:"d-sm-flex",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-capitalize",children:"Point"}),(0,s.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:(0,s.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),y(d.hash)},children:d.nodeName?d.nodeName:d.hash})})]})}),(0,s.jsx)(h,{itemKey:"Protocol",itemValue:d.protocol}),(0,s.jsx)(h,{itemKey:"Process",itemValue:d.process}),(0,s.jsx)(h,{itemKey:"TlsServerName",itemValue:d.tlsServerName}),(0,s.jsx)(h,{itemKey:"HttpHost",itemValue:d.httpHost}),(0,s.jsx)(h,{itemKey:"Component",itemValue:d.component}),(0,s.jsx)(h,{itemKey:"Mode",itemValue:c.Mq[d.mode]}),(0,s.jsx)(h,{itemKey:"UdpMigrateId",itemValue:d.udpMigrateId?d.udpMigrateId.toString():""}),(0,s.jsx)(h,{itemKey:"Pid",itemValue:d.pid?d.pid.toString():""}),(0,s.jsx)(h,{itemKey:"Uid",itemValue:d.uid?d.uid.toString():""}),d.matchHistory&&d.matchHistory.length>0&&(0,s.jsx)(l.A.Item,{children:(0,s.jsxs)("div",{className:"d-sm-flex",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate text-capitalize",children:"MatchHistory"}),(0,s.jsx)("div",{className:"notranslate text-break",style:{opacity:.6},children:d.matchHistory.map((e,t)=>(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,s.jsx)("div",{style:{flex:1,height:"1px",background:"black"}}),(0,s.jsx)("span",{children:(0,s.jsx)("b",{children:e.ruleName})}),(0,s.jsx)("div",{style:{flex:1,height:"1px",background:"black"}})]}),(0,s.jsx)("div",{className:"mt-2 mb-2",children:e.history&&e.history.map((e,t)=>(0,s.jsx)("div",{children:(0,s.jsxs)("div",{children:[e.matched?(0,s.jsx)(n.A,{bg:"success",children:"Hit"}):(0,s.jsx)(n.A,{bg:"danger",children:"Miss"})," ",e.listName]})},"list-"+e.listName+t))})]},"rule-"+e.ruleName+t))})]})}),r]})]})},y={B:"B",KB:"KB",MB:"MB",GB:"GB",TB:"TB",PB:"PB"},p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,{bytes:a,unit:s}=e>=0x4000000000000?{bytes:e/0x4000000000000,unit:y.PB}:e>=0x10000000000?{bytes:e/0x10000000000,unit:y.TB}:e>=0x40000000?{bytes:e/0x40000000,unit:y.GB}:e>=1048576?{bytes:e/1048576,unit:y.MB}:e>=1024?{bytes:e/1024,unit:y.KB}:{bytes:e,unit:y.B};return"".concat(a.toFixed(t)).concat(s)};class g{DownloadString(){let e=p(this.download),t=p(this.download_rate)+"/S";return"(".concat(e,"): ").concat(t)}UploadString(){let e=p(this.upload),t=p(this.upload_rate)+"/S";return"(".concat(e,"): ").concat(t)}constructor(e=0,t=0,a=0,s=0,i={}){this.download=e,this.download_rate=t,this.upload=a,this.upload_rate=s,this.counters=i,this.time=new Date}}let N=e=>{let{lastFlow:t,flow_error:a,end_content:i}=e;return(0,s.jsx)(d.A,{className:"mb-3",children:(0,s.jsxs)(l.A,{variant:"flush",children:[(0,s.jsx)(l.A.Item,{children:(0,s.jsxs)("div",{className:"d-sm-flex",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Download"}),(0,s.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-download",children:a?a.msg:t?t.DownloadString():"Loading..."})]})}),(0,s.jsx)(l.A.Item,{children:(0,s.jsxs)("div",{className:"d-sm-flex",children:[(0,s.jsx)("div",{className:"endpoint-name flex-grow-1 notranslate",children:"Upload"}),(0,s.jsx)("div",{className:"notranslate",style:{opacity:.6},id:"statistic-upload",children:a?a.msg:t?t.UploadString():"Loading..."})]})}),i]})})},w=i.memo(e=>{let{onUpdate:t,end_content:a}=e,{data:l,error:n}=(()=>{let[e,t]=(0,i.useState)(new g(0,0,0,0,{}));return(0,o.Ay)((0,r.cY)(x.oQ.method.total),async()=>(0,r.kP)(x.oQ.method.total).then(async a=>{let{data:s,error:i}=a;if(i)throw i;if(s)try{let a=((e,t)=>{let a=(new Date().getTime()-t.time.getTime())/1e3;if((0!==t.download||0!==t.upload)&&0!==a){let s=Number(e.download),i=Number(e.upload);return{download_rate:s>t.download?(s-t.download)/a:0,upload_rate:i>t.upload?(i-t.upload)/a:0}}return{download_rate:0,upload_rate:0}})(s,e),i=new g(Number(s.download),a.download_rate,Number(s.upload),a.upload_rate,s.counters);return t(i),i}catch(e){throw{msg:e.toString(),code:500}}}),{refreshInterval:2e3})})();return(0,i.useEffect)(()=>{t&&l&&t(l.counters)},[t,l]),(0,s.jsx)(N,{lastFlow:l,flow_error:n,end_content:a})})}}]);